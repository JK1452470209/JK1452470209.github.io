<!DOCTYPE html>
<html lang="en">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Mr.JK">
  <meta name="keywords" content="">
  <title>å­¦æˆåœ¨çº¿day20ï¼šé¡¹ç›®éƒ¨ç½²ä¸æŒç»­é›†æˆï¼ˆDevOpsï¼‰ - Mr.JK</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/darcula.min.css" />
  

  


<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->

  
<link rel="stylesheet" href="/css/custom.css">



  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 4.2.1"></head>





<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>ç§äººåšå®¢</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                ä¸»é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äºæˆ‘
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/banner.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2020-08-31 12:00">
      2020-08-31
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7.5k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      82
       åˆ†é’Ÿ
    </span>
  

  
  
    
      <!-- ä¸è’œå­ç»Ÿè®¡æ–‡ç« PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> æ¬¡
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
	
   
	
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div id="tocbot"></div>
</div>

      </div>
    
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <h1 id="ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ"><a href="#ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ" class="headerlink" title="ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ"></a>ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ</h1><blockquote>
<p>ä¸ºäº†æ–¹ä¾¿åç»­å›é¡¾è¯¥é¡¹ç›®æ—¶èƒ½å¤Ÿæ¸…æ™°çš„çŸ¥é“æœ¬ç« èŠ‚è®²äº†å“ªäº›å†…å®¹ï¼Œå¹¶ä¸”èƒ½å¤Ÿä»è¯¥ç« èŠ‚çš„ç¬”è®°ä¸­å¾—åˆ°ä¸€äº›å¸®åŠ©ï¼Œæ‰€ä»¥åœ¨å®Œæˆæœ¬ç« èŠ‚çš„å­¦ä¹ ååœ¨æ­¤å¯¹æœ¬ç« èŠ‚æ‰€æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹è¿›è¡Œæ€»ç»“æ¦‚è¿°ã€‚</p>
</blockquote>
<p>æœ¬ç« èŠ‚ä¸ºã€å­¦æˆåœ¨çº¿ã€‘é¡¹ç›®çš„ <code>day20</code> çš„å†…å®¹ã€‚</p>
<ul>
<li>åŸè®²ä¹‰ä¸­å¯¹è¯¥ç« èŠ‚çš„ <code>gitlab</code> ä¸ <code>jenkins</code> å®‰è£…æ­¥éª¤ä»¥åŠéƒ¨ç½²å®¹å™¨çš„å†…å®¹å’Œæ­¥éª¤æè¿°å¾—ä¸å¤Ÿè¯¦ç»†ï¼Œåœ¨æœ¬æ–‡ä¸­åšå‡ºäº†è¡¥å……ï¼Œè¯¦ç»†çš„æè¿°æ¯ä¸ªæ­¥éª¤ã€‚</li>
<li>æœ¬ç« èŠ‚å»ºè®®è¿˜æ˜¯å°è¯•çœ‹ç¬”è®°æ¥å®Œæˆä¸€æ¬¡æ“ä½œï¼Œç„¶åå†å»çœ‹è§†é¢‘èµ„æ–™ï¼Œè¿™æ ·èƒ½ç†è§£å¾—æ›´æ·±åˆ»ã€‚</li>
</ul>
<h1 id="ä¸€ã€DevOpsä»‹ç»"><a href="#ä¸€ã€DevOpsä»‹ç»" class="headerlink" title="ä¸€ã€DevOpsä»‹ç»"></a>ä¸€ã€DevOpsä»‹ç»</h1><p>DevOps æ˜¯ <code>Development</code> å’Œ <code>Operations</code> ä¸¤ä¸ªè¯çš„ç¼©å†™ï¼Œå¼•ç”¨ç™¾åº¦ç™¾ç§‘çš„å®šä¹‰ï¼š</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image1.png" srcset="/img/loading.gif" alt="image-20200607210842378"></p>
<p><code>DevOps</code> æ˜¯ä¸€ç§æ–¹æ³•æˆ–ç†å¿µï¼Œå®ƒæ¶µç›–å¼€å‘ã€æµ‹è¯•ã€è¿ç»´çš„æ•´ä¸ªè¿‡ç¨‹ã€‚<code>DevOps</code> æ˜¯æé«˜è½¯ä»¶å¼€å‘ã€æµ‹è¯•ã€è¿ç»´ã€è¿è¥ç­‰å„éƒ¨é—¨çš„æ²Ÿé€šä¸åä½œè´¨é‡çš„æ–¹æ³•å’Œè¿‡ç¨‹ï¼Œ<code>DevOps</code> å¼ºè°ƒè½¯ä»¶å¼€å‘äººå‘˜ä¸è½¯ä»¶æµ‹è¯•ã€è½¯ä»¶è¿ç»´ã€è´¨é‡ä¿éšœï¼ˆQAï¼‰éƒ¨é—¨ä¹‹é—´æœ‰æ•ˆçš„æ²Ÿé€šä¸åä½œï¼Œå¼ºè°ƒé€šè¿‡è‡ªåŠ¨åŒ–çš„æ–¹æ³•å»ç®¡ç†è½¯ä»¶å˜æ›´ã€è½¯ä»¶é›†æˆï¼Œä½¿è½¯ä»¶ä»æ„å»ºåˆ°æµ‹è¯•ã€å‘å¸ƒæ›´åŠ å¿«æ·ã€å¯é ï¼Œæœ€ç»ˆæŒ‰æ—¶äº¤ä»˜è½¯ä»¶ã€‚</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image2.png" srcset="/img/loading.gif" alt="image-20200607210903849"></p>
<p><code>DevOps</code> å…´èµ·äº2009å¹´ï¼Œè¿‘å¹´æ¥ç”±äºäº‘è®¡ç®—ã€äº’è”ç½‘çš„å‘å±•ï¼Œä¿ƒè¿›äº†DevOpsçš„åŸºç¡€è®¾æ–½åŠå·¥å…·é“¾çš„å‘å±•ï¼Œæ¶Œç°äº†ä¸€å¤§æ‰¹ä¼˜ç§€çš„å·¥å…·ï¼Œè¿™äº›å·¥å…·åŒ…æ‹¬å¼€å‘ã€æµ‹è¯•ã€è¿ç»´çš„å„å„é¢†åŸŸï¼Œä¾‹å¦‚ï¼šGitHubã€Git/SVNã€Dockerã€Jenkinsã€Hudsonã€Ant/Maven/Gradleã€Seleniumã€QUnitã€JMeter ç­‰ã€‚ä¸‹å›¾æ˜¯DevOpsç›¸å…³çš„å·¥å…·é›†ï¼š</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image3.png" srcset="/img/loading.gif" alt="image-20200607210927381"></p>
<h1 id="äºŒã€ä½¿ç”¨GitLabç®¡ç†é¡¹ç›®"><a href="#äºŒã€ä½¿ç”¨GitLabç®¡ç†é¡¹ç›®" class="headerlink" title="äºŒã€ä½¿ç”¨GitLabç®¡ç†é¡¹ç›®"></a>äºŒã€ä½¿ç”¨GitLabç®¡ç†é¡¹ç›®</h1><h2 id="1-å®‰è£…Gitlab"><a href="#1-å®‰è£…Gitlab" class="headerlink" title="1. å®‰è£…Gitlab"></a>1. å®‰è£…Gitlab</h2><p>GitLab æ˜¯ä¸€ä¸ªç”¨äºä»“åº“ç®¡ç†ç³»ç»Ÿçš„å¼€æºé¡¹ç›®ï¼Œä½¿ç”¨Gitä½œä¸ºä»£ç ç®¡ç†å·¥å…·ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šæ­å»ºèµ·æ¥çš„webæœåŠ¡ã€‚</p>
<p>GitLab ä¸ GitHubçš„åŠŸèƒ½ç›¸ä¼¼ï¼Œé€šå¸¸ä¼ä¸šä½¿ç”¨GitLabåœ¨å±€åŸŸç½‘æ­å»ºè‡ªå·±çš„Gitä»£ç ç®¡ç†ä»“åº“</p>
<p>æ‹‰å–gitlabã€redisã€postgresqlï¼Œ<code>gitlab</code> ä¾èµ– <code>redis</code> å’Œ <code>postgresql</code>ã€‚</p>
<div class="hljs"><pre><code class="hljs shell">sudo docker pull sameersbn/redis
sudo docker pull sameersbn/postgresql
sudo docker pull gitlab/gitlab-ce:latest</code></pre></div>

<p>æ–°å»ºå®¹å™¨çš„ç›®å½•</p>
<div class="hljs"><pre><code class="hljs shell">sudo mkdir /var/docker/postgresql/data -p
sudo mkdir /var/docker/redis/data -p
sudo mkdir /var/docker/gitlab/data -p</code></pre></div>

<p>åˆ›å»º postgresqlã€redis å®¹å™¨ï¼š</p>
<div class="hljs"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> åˆ›å»ºpostgresqlå®¹å™¨</span>
sudo docker run --name postgresql -d --privileged=true -e 'DB_NAME=gitlabhq_production' -e 'DB_USER=gitlab' -e 'DB_PASS=123123' -e 'DB_EXTENSION=pg_trgm' -v /var/docker/postgresql/data:/var/lib/postgresql sameersbn/postgresql

<span class="hljs-meta">#</span><span class="bash"> åˆ›å»ºrediså®¹å™¨</span>
sudo docker run --name redis -d --privileged=true -v  /var/docker/redis/data:/var/lib/redissameersbn/redis</code></pre></div>

<p>åˆ›å»ºgitlabå®¹å™¨ï¼š</p>
<div class="hljs"><pre><code class="hljs shell">sudo docker run --name gitlab -d --link postgresql:postgresql --link redis:redisio \
--hostname 10.1.1.161 -p 10022:22 -p 8910:80 -p 8911:443 -e 'GITLAB_PORT=8899' \
-e 'GITLAB_SSH_PORT=10022' \
-e 'GITLAB_SECRETS_DB_KEY_BASE=long-and-random-alpha-numeric-string' \
-e 'GITLAB_SECRETS_SECRET_KEY_BASE=long-and-random-alpha-numeric-string' \
-e 'GITLAB_SECRETS_OTP_KEY_BASE=long-and-random-alpha-numeric-string' \
-e  'GITLAB_HOST=10.1.1.161' \
-e 'SMTP_AUTHENTICATION=login' \
-v /var/docker/gitlab/data:/home/git/data docker.io/gitlab/gitlab-ce</code></pre></div>

<blockquote>
<ul>
<li>ä½¿ç”¨ \ æ¥æ ‡è¯†shellå‘½ä»¤çš„æ¢è¡Œï¼Œåœ¨shellå‘½ä»¤è¿‡é•¿çš„æƒ…å†µä¸‹ä½¿ç”¨ \ æ¢è¡Œå¯ä»¥ä½¿å†…å®¹æ›´åŠ æ¸…æ™°</li>
<li>â€“linkï¼šå¯ä»¥ç”¨æ¥é“¾æ¥2ä¸ªå®¹å™¨ï¼Œä½¿å¾—æºå®¹å™¨ï¼ˆè¢«é“¾æ¥çš„å®¹å™¨ï¼‰å’Œæ¥æ”¶å®¹å™¨ï¼ˆä¸»åŠ¨å»é“¾æ¥çš„å®¹å™¨ï¼‰ä¹‹é—´å¯ä»¥äº’ç›¸é€šä¿¡ï¼Œå¹¶ä¸”æ¥æ”¶å®¹å™¨å¯ä»¥è·å–æºå®¹å™¨çš„ä¸€äº›æ•°æ®ï¼Œå¦‚æºå®¹å™¨çš„ç¯å¢ƒå˜é‡</li>
</ul>
</blockquote>
<p>æµè§ˆå™¨è®¿é—®ï¼š<a href="http://10.1.1.161:8910/" target="_blank" rel="noopener">http://10.1.1.161:8910</a></p>
<p>åˆæ¬¡è®¿é—®éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚</p>
<p>æŸ¥çœ‹ gitlabçš„å¯åŠ¨æ—¥å¿—</p>
<div class="hljs"><pre><code class="hljs shell">sudo docker logs -f gitlab</code></pre></div>

<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image4.png" srcset="/img/loading.gif" alt="image-20200607182758861"></p>
<p>å¯åŠ¨å®Œæˆåï¼Œé…ç½®åˆå§‹å¯†ç ï¼Œé»˜è®¤ç”¨æˆ·åä¸º <code>root</code></p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image5.png" srcset="/img/loading.gif" alt="image-20200607183035804"></p>
<h2 id="2-åˆ›å»ºé¡¹ç›®"><a href="#2-åˆ›å»ºé¡¹ç›®" class="headerlink" title="2. åˆ›å»ºé¡¹ç›®"></a>2. åˆ›å»ºé¡¹ç›®</h2><p>ç™»å½• gitlab åè®¿é—® <a href="http://10.1.1.161:8910/projects/new" target="_blank" rel="noopener">http://10.1.1.161:8910/projects/new</a></p>
<p>å¡«å†™é¡¹ç›®çš„åŸºæœ¬ä¿¡æ¯</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image6.png" srcset="/img/loading.gif" alt="image-20200608183302202"></p>
<p>é¡¹ç›®æ„å»ºæˆåŠŸåï¼Œå¾—åˆ°ä¸€ä¸ªé¡¹ç›®çš„é“¾æ¥ <a href="http://10.1.1.161:8910/root/xc-services-project" target="_blank" rel="noopener">http://10.1.1.161:8910/root/xc-services-project</a></p>
<p><img src="https://qnoss.codeyee.com/20200704_5b6u5pyN5YqhW+WtpuaIkOWcqOe6v10gZGF5MjAtMe+8mkRldk9wcyDpobnnm67pg6jnvbLkuI7mjIHnu63pm4bmiJA=/image7.png" srcset="/img/loading.gif" alt="image-20200608175145298"></p>
<h2 id="3-å°†é¡¹ç›®æ¨é€è‡³gitlab"><a href="#3-å°†é¡¹ç›®æ¨é€è‡³gitlab" class="headerlink" title="3. å°†é¡¹ç›®æ¨é€è‡³gitlab"></a>3. å°†é¡¹ç›®æ¨é€è‡³gitlab</h2><p>æ‰“å¼€ cmdï¼Œè¿›å…¥åˆ°é¡¹ç›®çš„ç›®å½•ä¸‹</p>
<p>1ã€è¿è¡Œ <code>git init</code> åˆå§‹åŒ–é¡¹ç›®çš„gité…ç½®</p>
<p>2ã€åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º <code>.gitignore</code> æ–‡ä»¶ï¼Œå°†ä¸€äº›ç¼–è¯‘åç”Ÿæˆçš„æ–‡ä»¶æ’é™¤åœ¨å¤– ä¸ä¸Šä¼ è‡³gitä»“åº“ï¼Œå†…å®¹å¦‚ä¸‹</p>
<div class="hljs"><pre><code class="hljs shell">.idea
*/target/*.*
*/target/**/*.*
*.class
*.iml
<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#ignore this file##</span></span>
.classpath
.project
.settings     
<span class="hljs-meta"> #</span><span class="bash"><span class="hljs-comment">#filter databfileã€sln file##</span></span>
*.mdb  
*.ldb  
*.sln   
<span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#class file##</span></span>
*.com  
*.class  
*.dll  
*.exe  
*.o  
*.so 
<span class="hljs-meta">#</span><span class="bash"> compression file</span>
*.7z  
*.dmg  
*.gz  
*.iso  
*.jar  
*.rar  
*.tar  
*.zip  
*.via
*.tmp
*.err
<span class="hljs-meta">#</span><span class="bash"> OS generated files <span class="hljs-comment">#  </span></span>
.DS_Store  
.DS_Store?  
._*  
.Spotlight-V100  
.Trashes  
Icon?  
ehthumbs.db  
Thumbs.db</code></pre></div>

<p>3ã€æ‰§è¡Œ <code>git add .</code> å‘½ä»¤ï¼Œæš‚å­˜å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•ä»¥åŠæ–‡ä»¶åˆ°gitè®°å½•</p>
<p>4ã€æ‰§è¡Œ <code>git commit -m &quot;ç¬¬ä¸€æ¬¡æäº¤&quot;</code> å°†æš‚å­˜çš„è®°å½•æ­£å¼æäº¤åˆ° <code>git</code> è®°å½•å†…ï¼Œ-m å‚æ•°çš„å†…å®¹ä¸ºæè¿°ä¿¡æ¯</p>
<p>5ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè®¾ç½®è¿œç¨‹ä»“åº“çš„åœ°å€</p>
<div class="hljs"><pre><code class="hljs shell">git remote add origin "http://10.1.1.161:8910/root/xc-services-project.git"</code></pre></div>

<p>6ã€æ‰§è¡Œ <code>git push origin master</code> æ¨é€ä»£ç åˆ°è¿œç¨‹ä»“åº“</p>
<p><img src="https://qnoss.codeyee.com/20200704_5b6u5pyN5YqhW+WtpuaIkOWcqOe6v10gZGF5MjAtMe+8mkRldk9wcyDpobnnm67pg6jnvbLkuI7mjIHnu63pm4bmiJA=/image8.png" srcset="/img/loading.gif" alt="image-20200608184308041"></p>
<p>æ¨é€æˆåŠŸï¼ŒæŸ¥çœ‹è¿œç¨‹ä»“åº“</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image9.png" srcset="/img/loading.gif" alt="image-20200608194951105"></p>
<h1 id="ä¸‰ã€éƒ¨ç½²å¾®æœåŠ¡åˆ°Docker"><a href="#ä¸‰ã€éƒ¨ç½²å¾®æœåŠ¡åˆ°Docker" class="headerlink" title="ä¸‰ã€éƒ¨ç½²å¾®æœåŠ¡åˆ°Docker"></a>ä¸‰ã€éƒ¨ç½²å¾®æœåŠ¡åˆ°Docker</h1><h2 id="1-Dockerç®€ä»‹"><a href="#1-Dockerç®€ä»‹" class="headerlink" title="1. Dockerç®€ä»‹"></a>1. Dockerç®€ä»‹</h2><p>æœåŠ¡å™¨è™šæ‹ŸåŒ–ä¸»è¦æœ‰ä¸¤ç§æŠ€æœ¯ï¼š</p>
<p><strong>1ã€Hypervisorä¹Ÿå«VMMï¼ˆvirtual machine monitorï¼‰å³è™šæ‹Ÿæœºç›‘è§†å™¨</strong></p>
<p><code>Hypervisor</code> æ˜¯ä¸€ç§å°†æ“ä½œç³»ç»Ÿä¸ç¡¬ä»¶æŠ½è±¡åˆ†ç¦»çš„æ–¹æ³•ï¼Œå®ç°åœ¨å®¿ä¸»æœºï¼ˆhost machineï¼‰ä¸Šèƒ½åŒæ—¶è¿è¡Œå¤šä¸ªå®¢æˆ·æœºï¼ˆguest machineï¼‰ï¼Œæ¯ä¸ªå®¢æˆ·æœºå°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œè¿™äº›è™šæ‹Ÿæœºé«˜æ•ˆåœ°åˆ†äº«å®¿ä¸»æœºçš„ç¡¬ä»¶èµ„æºã€‚</p>
<p>å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image10.png" srcset="/img/loading.gif" alt="image-20200608135503026"></p>
<p>åœ¨æœåŠ¡å™¨ï¼ˆå®¿ä¸»æœºï¼‰ä¸Šå®‰è£…æ“ä½œç³»ç»Ÿï¼Œå¹¶å®‰è£…hypervisorè™šæ‹Ÿæœºç®¡ç†è½¯ä»¶ï¼Œå¦‚VMwareã€VirtualBoxç­‰ï¼Œç”±<br>hypervisorç®¡ç†å¤šä¸ªè™šæ‹Ÿæœºï¼Œæ¯ä¸ªè™šæ‹Ÿæœºä¸Šéœ€è¦å®‰è£…å®¢æˆ·æ“ä½œç³»ç»Ÿã€ä¾èµ–åº“ã€åº”ç”¨è½¯ä»¶ã€‚</p>
<p><strong>2ã€Containerså®¹å™¨åŒ–æŠ€æœ¯</strong></p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image11.png" srcset="/img/loading.gif" alt="image-20200608135556836"></p>
<p>å®¹å™¨æŠ€æœ¯ä¸­ <code>docker</code> å¼•æ“å–ä»£äº† <code>hypervisor</code>ï¼Œdockerå¼•æ“æ˜¯è¿è¡Œåœ¨ä½å®¿æ“ä½œç³»ç»Ÿä¸Šçš„ä¸€ä¸ªè¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹ç®¡ç†äº†å¤šä¸ªdockerå®¹å™¨ï¼Œæ¯ä¸ªdockerå®¹å™¨é›†æˆäº†åº”ç”¨è½¯ä»¶ã€ä¾èµ–åº“ï¼Œå®¹å™¨ä¹‹é—´ç›¸äº’éš”ç¦»ã€‚</p>
<p><strong>3ã€æŠ€æœ¯å¯¹æ¯”</strong></p>
<p>èµ„æºå ç”¨ï¼š</p>
<p>è™šæ‹Ÿæœºç”±äºæ˜¯ç‹¬ç«‹çš„æ“ä½œç³»ç»Ÿï¼Œå ç”¨èµ„æºæ¯”dockerå¤šã€‚</p>
<p>å¯åŠ¨é€Ÿåº¦:</p>
<p>è™šæ‹ŸæœºåŒ…æ‹¬æ“ä½œç³»ç»Ÿï¼Œå¯åŠ¨è™šæ‹Ÿæœºç›¸å½“äºå¯åŠ¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œå®¹å™¨åˆ™ä¸ä¸€æ ·ï¼Œå®¹å™¨ä¸­åªåŒ…æ‹¬æ“ä½œç³»ç»Ÿçš„å†…æ ¸ï¼Œå¯åŠ¨<br>ä¸€ä¸ªå®¹å™¨å®ä¾‹ç›¸å½“äºå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œå®¹å™¨çš„å¯åŠ¨é€Ÿåº¦æ¯”è™šæ‹Ÿæœºå¿«ã€‚</p>
<p>ä½“ç§¯ï¼š</p>
<p>å®¹å™¨åŒ…æ‹¬æ“ä½œç³»ç»Ÿå†…æ ¸ã€è½¯ä»¶åŠä¾èµ–åº“ï¼Œè™šæ‹Ÿæœºä¸ä»…åŒ…æ‹¬è½¯ä»¶å’Œä¾èµ–åº“è¿˜å°†å®Œæ•´çš„æ“ä½œç³»ç»Ÿæ‰“åŒ…è¿›å»ï¼Œè™šæ‹Ÿæœºçš„ä½“<br>ç§¯æ¯”å®¹å™¨å¤§çš„å¤šã€‚</p>
<p><strong>4ã€Docker å®¹å™¨æ¶æ„</strong></p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image12.png" srcset="/img/loading.gif" alt="image-20200608135730960"></p>
<ul>
<li><p><strong>Docker daemon</strong>ï¼ˆDockerå®ˆæŠ¤è¿›ç¨‹ï¼‰</p>
<p>Dockerå®ˆæŠ¤è¿›ç¨‹æ˜¯éƒ¨ç½²åœ¨æ“ä½œç³»ç»Ÿä¸Šï¼Œè´Ÿè´£æ”¯æ’‘ <code>Docker Container</code> çš„è¿è¡Œä»¥åŠæœ¬åœ° <code>Image</code> çš„ç®¡ç†ã€‚</p>
</li>
<li><p><strong>Docker client</strong></p>
<p>ç”¨æˆ·ä¸ç›´æ¥æ“ä½œDocker daemonï¼Œç”¨æˆ·é€šè¿‡ <code>Docker client</code> è®¿é—® <code>Docker</code>ï¼Œ<code>Docker client</code> æä¾›<br>pullã€run ç­‰æ“ä½œå‘½ä»¤å®ç°å¯¹dockerçš„æ“ä½œã€‚</p>
</li>
<li><p><strong>Docker Image</strong></p>
<p>Docker é•œåƒå°±æ˜¯ä¸€ä¸ªåªè¯»çš„æ¨¡æ¿ã€‚ ä¾‹å¦‚ï¼šä¸€ä¸ªé•œåƒå¯ä»¥åŒ…å«ä¸€ä¸ªå®Œæ•´çš„ ubuntu æ“ä½œç³»ç»Ÿç¯å¢ƒï¼Œé‡Œé¢ä»…å®‰è£…äº† Tomcatæˆ–ç”¨æˆ·éœ€è¦çš„å…¶å®ƒåº”ç”¨ç¨‹åºã€‚ é•œåƒå¯ä»¥ç”¨æ¥åˆ›å»º Docker å®¹å™¨ã€‚ Docker æä¾›äº†ä¸€ä¸ªå¾ˆç®€å•çš„æœºåˆ¶æ¥åˆ›å»ºé•œåƒæˆ–è€…æ›´æ–°ç°æœ‰çš„é•œåƒï¼Œç”¨æˆ·ç”šè‡³å¯ä»¥ç›´æ¥ä»å…¶ä»–äººé‚£é‡Œä¸‹è½½ä¸€ä¸ªå·²ç»åšå¥½çš„é•œåƒæ¥ç›´æ¥ä½¿ç”¨ã€‚</p>
</li>
<li><p><strong>Docker Container</strong></p>
<p>Docker åˆ©ç”¨å®¹å™¨æ¥è¿è¡Œåº”ç”¨ã€‚å®¹å™¨æ˜¯ä»é•œåƒåˆ›å»ºçš„è¿è¡Œå®ä¾‹ã€‚å®ƒå¯ä»¥è¢«å¯åŠ¨ã€å¼€å§‹ã€åœ<br>æ­¢ã€åˆ é™¤ã€‚æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç›¸äº’éš”ç¦»çš„ã€ä¿è¯å®‰å…¨çš„å¹³å°ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œé•œåƒç›¸å½“äºç±»ï¼Œå®¹å™¨ç›¸å½“äºå¯¹è±¡ã€‚</p>
</li>
<li><p><strong>Docker Registry</strong></p>
<p>Docker ä»“åº“åˆ†ä¸ºå…¬å¼€ä»“åº“ï¼ˆPublicï¼‰å’Œç§æœ‰ä»“åº“ï¼ˆPrivateï¼‰ä¸¤ç§å½¢å¼ æœ€å¤§çš„å…¬å¼€ä»“åº“æ˜¯<br>Docker Hubï¼Œå­˜æ”¾äº†æ•°é‡åºå¤§çš„é•œåƒä¾›ç”¨æˆ·ä¸‹è½½ã€‚ ç”¨æˆ·ä¹Ÿå¯ä»¥åœ¨æœ¬åœ°ç½‘ç»œå†…åˆ›å»ºä¸€ä¸ªç§æœ‰ä»“åº“ã€‚ å½“ç”¨æˆ·åˆ›å»ºè‡ªå·±çš„é•œåƒä¹‹åå°±å¯ä»¥ä½¿ç”¨ push å‘½ä»¤å°†å®ƒä¸Šä¼ åˆ°å…¬æœ‰æˆ–è€…ç§æœ‰ä»“åº“ï¼Œè¿™æ ·ä¸‹æ¬¡åœ¨å¦å¤–ä¸€å°æœºå™¨ä¸Šä½¿ç”¨è¿™ä¸ªé•œåƒæ—¶å€™ï¼Œåªéœ€è¦ä»ä»“åº“ä¸Š pull ä¸‹æ¥å°±å¯ä»¥äº†ã€‚</p>
</li>
</ul>
<h2 id="2-å®‰è£…docker"><a href="#2-å®‰è£…docker" class="headerlink" title="2. å®‰è£…docker"></a>2. å®‰è£…docker</h2><p>Docker å¯ä»¥è¿è¡Œåœ¨ MACã€Windowsã€Centosã€DEBIANã€UBUNTU ç­‰æ“ä½œç³»ç»Ÿä¸Šï¼Œæä¾›ç¤¾åŒºç‰ˆå’Œä¼ä¸šç‰ˆï¼Œæœ¬æ•™ç¨‹åŸºäºCentoså®‰è£…Dockerã€‚<code>Centos6</code> å¯¹ docker æ”¯æŒçš„ä¸å¥½ï¼Œä½¿ç”¨ <code>docker</code> æ—¶å»ºè®®å‡çº§åˆ° <code>centos7</code>ã€‚</p>
<p>1ã€åœ¨ Centos7 ä¸Šå®‰è£…Docker</p>
<p>ç›´æ¥é€šè¿‡yumå®‰è£…å³å¯ï¼š</p>
<div class="hljs"><pre><code class="hljs powershell">yum install <span class="hljs-literal">-y</span> docker</code></pre></div>

<p>å¯åŠ¨dockerï¼š<code>service docker start</code></p>
<p>æŸ¥è¯¢dockerç‰ˆæœ¬: <code>docker version</code></p>
<p>å…³äºçš„ <code>docker</code> çš„ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤å’Œæ“ä½œï¼Œå‚è€ƒ <a href="https://www.runoob.com/docker/docker-tutorial.html" target="_blank" rel="noopener">https://www.runoob.com/docker/docker-tutorial.html</a></p>
<h2 id="3-éƒ¨ç½²æµç¨‹"><a href="#3-éƒ¨ç½²æµç¨‹" class="headerlink" title="3. éƒ¨ç½²æµç¨‹"></a>3. éƒ¨ç½²æµç¨‹</h2><p>æœ¬é¡¹ç›®å¾®æœåŠ¡é‡‡ç”¨ <code>SpringBoot</code> å¼€å‘ï¼Œå°†æ¯ä¸ªå¾®æœåŠ¡å·¥ç¨‹æ‰“æˆ<code>Jar</code> åŒ…ï¼Œæœ€ç»ˆåœ¨ <code>Docker</code> å®¹å™¨ä¸­è¿è¡Œ <code>jar</code>ï¼Œéƒ¨ç½²æµç¨‹å¦‚ä¸‹ï¼š</p>
<p>1ã€SpringBoot å·¥ç¨‹æœ€ç»ˆæ‰“æˆ <code>Jar</code> åŒ…</p>
<p>2ã€åˆ›å»ºDockeré•œåƒ</p>
<p>3ã€åˆ›å»ºå®¹å™¨</p>
<p>4ã€å¯åŠ¨å®¹å™¨</p>
<h2 id="4-æ‰“åŒ…"><a href="#4-æ‰“åŒ…" class="headerlink" title="4. æ‰“åŒ…"></a>4. æ‰“åŒ…</h2><p>1ã€ä½¿ç”¨ maven çš„æ‰“åŒ…æ’ä»¶ï¼š</p>
<p>å°†ä¸‹è¾¹çš„æ’ä»¶ä¾èµ–æ‹·è´åˆ°å¾®æœåŠ¡å·¥ç¨‹ä¸­ï¼Œæœ¬ä¾‹å­å°†å­¦æˆåœ¨çº¿çš„ <code>Eureka</code> å·¥ç¨‹æ‰“åŒ…ï¼š</p>
<div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">finalName</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span></code></pre></div>

<p>å®Œæ•´çš„ <code>Eureka</code> å·¥ç¨‹ <code>pom.xml</code> æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<div class="hljs"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span>
<span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span>
<span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0</span></span>
<span class="hljs-tag"><span class="hljs-string">                             http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xc-framework-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>&gt;</span>../xc-framework-parent/pom.xml<span class="hljs-tag">&lt;/<span class="hljs-name">relativePath</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xc-govern-center<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- å¯¼å…¥EurekaæœåŠ¡çš„ä¾èµ– --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">finalName</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span></code></pre></div>

<p>2ã€mavenæ‰“åŒ…</p>
<p>åœ¨å·¥ç¨‹ç›®å½•è¿è¡Œï¼š<code>mvn clear package</code></p>
<p>æˆ–é€šè¿‡IDEAæ‰§è¡Œ <code>clear package</code> æ‰“åŒ…å‘½ä»¤ã€‚</p>
<p>æ‰“åŒ…æˆåŠŸï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://qnoss.codeyee.com/20200704_5b6u5pyN5YqhW+WtpuaIkOWcqOe6v10gZGF5MjAtMe+8mkRldk9wcyDpobnnm67pg6jnvbLkuI7mjIHnu63pm4bmiJA=/image13.png" srcset="/img/loading.gif" alt="image-20200608151714281"></p>
<p>æ‰“åŒ…æˆåŠŸååœ¨ <code>target</code> ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª jaråŒ…</p>
<h2 id="5-åˆ›å»ºé•œåƒ"><a href="#5-åˆ›å»ºé•œåƒ" class="headerlink" title="5. åˆ›å»ºé•œåƒ"></a>5. åˆ›å»ºé•œåƒ</h2><p>å°†ä¸Šä¸€æ­¥æ‰“åŒ…å¥½çš„ <code>jar</code> åŒ…æ‹·è´åˆ°æˆ‘ä»¬è¦éƒ¨ç½²å¾®æœåŠ¡çš„LinuxæœåŠ¡å™¨ï¼Œå‡†å¤‡åˆ›å»ºé•œåƒã€‚</p>
<p>å®‰è£…jdkç¯å¢ƒ</p>
<div class="hljs"><pre><code class="hljs routeros">sudo apt-<span class="hljs-builtin-name">get</span> install openjdk-8-jdk</code></pre></div>

<p>æµ‹è¯• jar åŒ…æ˜¯å¦å¯ä»¥è¿è¡Œï¼Œæ‰§è¡Œï¼š<code>java -jar xc-govern-center-1.0-SNAPSHOT.jar</code></p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image14.png" srcset="/img/loading.gif" alt="image-20200608153244826"></p>
<p>è®¿é—®æœåŠ¡å™¨åœ°å€ <a href="http://10.1.1.162:50101/" target="_blank" rel="noopener">http://10.1.1.162:50101/</a></p>
<blockquote>
<p>æ³¨æ„æˆ‘è¿™é‡Œçš„è™šæ‹ŸæœºIPåœ°å€ä¸º 10.1.1.162 ï¼Œæµ‹è¯•çš„æ—¶å€™è¦æ›´æ¢ä½ è™šæ‹Ÿæœºçš„åœ°å€</p>
</blockquote>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image15.png" srcset="/img/loading.gif" alt="image-20200608160630154"></p>
<p>åœ¨ <code>jar</code> åŒ…çš„ç›®å½•ä¸‹ç¼–å†™ <code>Dockerfile</code> æ–‡ä»¶ï¼Œæ‰§è¡Œ <code>vim Dockerfile</code></p>
<div class="hljs"><pre><code class="hljs shell">FROM java:8
ENV ARTIFACTID xc-govern-center
ENV ARTIFACTVERSION 1.0-SNAPSHOT
ENV HOME_PATH /home
WORKDIR $HOME_PATH
ADD $ARTIFACTID-$ARTIFACTVERSION.jar $HOME_PATH/$ARTIFACTID.jar
ENTRYPOINT ["java", "-jar", "xc-govern-center.jar"]</code></pre></div>

<blockquote>
<p>dockerfileè¯´æ˜æ–‡æ¡£ï¼š <a href="https://www.runoob.com/docker/docker-dockerfile.html" target="_blank" rel="noopener">https://www.runoob.com/docker/docker-dockerfile.html</a></p>
</blockquote>
<p>åœ¨ Dockerfile æ–‡ä»¶æ‰€åœ¨ç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
<div class="hljs"><pre><code class="hljs shell">docker build -t xc-govern-center:1.0-SNAPSHOT .</code></pre></div>

<p>é•œåƒåˆ›å»ºæˆåŠŸï¼ŒæŸ¥è¯¢é•œåƒ</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image16.png" srcset="/img/loading.gif" alt="img"></p>
<h2 id="6-åˆ›å»ºå®¹å™¨"><a href="#6-åˆ›å»ºå®¹å™¨" class="headerlink" title="6. åˆ›å»ºå®¹å™¨"></a>6. åˆ›å»ºå®¹å™¨</h2><p>åŸºäºå‰é¢æˆ‘ä»¬ç”Ÿæˆçš„<code>xc-govern-center:1.0-SNAPSHOT</code> é•œåƒåˆ›å»ºå®¹å™¨ï¼Œå®¹å™¨åç§°ä¸º xc-govern-center-test</p>
<div class="hljs"><pre><code class="hljs sql">docker <span class="hljs-keyword">create</span> <span class="hljs-comment">--name xc-govern-center-test -t -p 50101:50101 -e PORT=50101 \</span>
-e EUREKA_SERVER=<span class="hljs-keyword">http</span>://<span class="hljs-number">10.1</span><span class="hljs-number">.1</span><span class="hljs-number">.162</span>:<span class="hljs-number">50101</span>/eureka/,<span class="hljs-keyword">http</span>://<span class="hljs-number">10.1</span><span class="hljs-number">.1</span><span class="hljs-number">.162</span>:<span class="hljs-number">50102</span>/eureka/ xc-govern-center:<span class="hljs-number">1.0</span>-<span class="hljs-keyword">SNAPSHOT</span></code></pre></div>

<blockquote>
<p>docker create è¯­æ³• ä¸ run ç›¸åŒï¼Œcreateè¡¨ç¤ºåªåˆ›å»ºä¸è¿è¡Œï¼Œè€Œrunæ˜¯åˆ›å»ºå®¹å™¨åå¹¶é©¬ä¸Šè¿è¡Œã€‚</p>
<p>runå‘½ä»¤è¯´æ˜æ–‡æ¡£ <a href="https://www.runoob.com/docker/docker-run-command.html" target="_blank" rel="noopener">https://www.runoob.com/docker/docker-run-command.html</a></p>
</blockquote>
<p>EUREKA_SERVER ä¸ºä¸€ä¸ªå˜é‡ï¼Œç”¨äºæœåŠ¡å¯åŠ¨æ—¶æŒ‡å®šçš„ <code>eureka</code> è´Ÿè½½å‡è¡¡åˆ°å“ªäº› <code>eureka</code> æœåŠ¡ä¸Šï¼Œè·Ÿæˆ‘ä»¬åœ¨ <code>idea</code> çš„é…ç½®æ˜¯ä¸€ä¸ªé“ç†ï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image17.png" srcset="/img/loading.gif" alt="image-20200608165054580"></p>
<p>å®¹å™¨åˆ›å»ºæˆåŠŸåä¼šå›æ˜¾ä¸€ä¸ªå®¹å™¨çš„idï¼Œå¯é€šè¿‡ <code>docker ps -a</code> å‘½ä»¤çœ‹åˆ°è¯¥å®¹å™¨çš„ä¿¡æ¯</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image18.png" srcset="/img/loading.gif" alt="image-20200608165256155"></p>
<h2 id="7-å¯åŠ¨å®¹å™¨"><a href="#7-å¯åŠ¨å®¹å™¨" class="headerlink" title="7. å¯åŠ¨å®¹å™¨"></a>7. å¯åŠ¨å®¹å™¨</h2><p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¯åŠ¨å®¹å™¨</p>
<div class="hljs"><pre><code class="hljs sql">docker <span class="hljs-keyword">start</span> xc-govern-center-<span class="hljs-keyword">test</span></code></pre></div>

<p>å®¹å™¨å¯åŠ¨å®Œæˆå¯ä»¥é€šè¿‡ <code>docker ps</code> æŸ¥è¯¢æ­£åœ¨è¿è¡Œä¸­çš„å®¹å™¨ã€‚</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image19.png" srcset="/img/loading.gif" alt="image-20200608173443990"></p>
<p>æµ‹è¯•è®¿é—®</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image20.png" srcset="/img/loading.gif" alt="image-20200608174322226"></p>
<p>ä½¿ç”¨ <code>docker logs -f xc-govern-center-test</code> å¯ä»¥æŸ¥çœ‹å®¹å™¨çš„è¿è¡Œæ—¥å¿—</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image21.png" srcset="/img/loading.gif" alt="image-20200608174430566"></p>
<blockquote>
<p>è¿™é‡ŒæŠ¥é”™æ˜¯å› ä¸ºæˆ‘ä»¬åšäº†è´Ÿè½½å‡è¡¡ï¼Œä¸¤ä¸ª eureka éœ€è¦ç›¸äº’æ³¨å†Œï¼Œä½†è¿™é‡Œæˆ‘ä»¬åªå¯åŠ¨äº†ä¸€ä¸ª eureka æœåŠ¡ï¼Œä½†ä¸å½±å“æ­£å¸¸ä½¿ç”¨ã€‚</p>
</blockquote>
<h2 id="8-åœæ­¢ä¸åˆ é™¤"><a href="#8-åœæ­¢ä¸åˆ é™¤" class="headerlink" title="8. åœæ­¢ä¸åˆ é™¤"></a>8. åœæ­¢ä¸åˆ é™¤</h2><p>è¦åˆ é™¤çš„ä¸€ä¸ªé•œåƒé‡æ–°åˆ›å»ºï¼Œéœ€è¦é€šè¿‡å¦‚ä¸‹æ­¥éª¤ï¼š</p>
<p>1ã€åœæ­¢æ­£åœ¨è¿è¡Œçš„å®¹å™¨</p>
<p>docker stop å®¹å™¨å</p>
<p>ä¾‹å¦‚ï¼š<code>docker stop xc-govern-center-test</code></p>
<p>2ã€åˆ é™¤å®¹å™¨</p>
<p>docker rm å®¹å™¨å</p>
<p>ä¾‹å¦‚ï¼š<code>docker rm xc-govern-center-test</code></p>
<p>3ã€åˆ é™¤é•œåƒ</p>
<p>docker rmi é•œåƒåæˆ–é•œåƒId</p>
<p>ä¾‹å¦‚ï¼š<code>docker rmi xc-govern-center:1.0-SNAPSHOT</code></p>
<h2 id="9-mavenæ„å»ºé•œåƒ"><a href="#9-mavenæ„å»ºé•œåƒ" class="headerlink" title="9. mavenæ„å»ºé•œåƒ"></a>9. mavenæ„å»ºé•œåƒ</h2><p>ä¸Šè¾¹æ„å»ºçš„è¿‡ç¨‹æ˜¯é€šè¿‡æ‰‹å·¥ä¸€æ­¥ä¸€æ­¥å®Œæˆï¼Œ<code>maven</code> æä¾› <code>docker-maven-plugin</code> æ’ä»¶å¯å®Œæˆä»æ‰“åŒ…åˆ°æ„å»ºé•œåƒã€æ„å»ºå®¹å™¨ç­‰è¿‡ç¨‹ã€‚</p>
<p>1ã€å°†æœåŠ¡å·¥ç¨‹çš„ <code>pom.xml</code> å¤åˆ¶ä¸€ä»½ï¼Œå‘½åä¸º <code>pom_docker.xml</code> å¹¶å°† <code>build</code> æ ‡ç­¾çš„å†…å®¹æ›¿æ¢ä¸‹é¢çš„å†…å®¹</p>
<div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">finalName</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.spotify<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>docker-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-comment">&lt;!--dockeré•œåƒç›¸å…³çš„é…ç½®ä¿¡æ¯--&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
                <span class="hljs-comment">&lt;!--é•œåƒåï¼Œè¿™é‡Œç”¨å·¥ç¨‹å--&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">imageName</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">imageName</span>&gt;</span>
                <span class="hljs-comment">&lt;!--Dockerfileæ–‡ä»¶æ‰€åœ¨ç›®å½•--&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">dockerDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">dockerDirectory</span>&gt;</span>
                <span class="hljs-comment">&lt;!--TAG,è¿™é‡Œç”¨å·¥ç¨‹ç‰ˆæœ¬å·--&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">imageTags</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">imageTag</span>&gt;</span>$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">imageTag</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">imageTags</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">imageName</span>&gt;</span>$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">imageName</span>&gt;</span>
                <span class="hljs-comment">&lt;!--æ„å»ºé•œåƒçš„é…ç½®ä¿¡æ¯--&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">targetPath</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">targetPath</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;.jar<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span></code></pre></div>

<p>2ã€å°† Dockerfile æ–‡ä»¶æ‹·è´åˆ° <code>src/main/resources</code> ä¸‹</p>
<p>3ã€å°†æ›´æ–°çš„å†…å®¹æäº¤åˆ°gitlabï¼Œå¹¶åœ¨æœåŠ¡å™¨å†…æ‹‰å–é¡¹ç›®ä»£ç åˆ°æœ¬åœ°</p>
<p>æäº¤å¹¶æ¨é€æ–°å¢çš„é…ç½®åˆ°è¿œç¨‹ä»“åº“</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image22.png" srcset="/img/loading.gif" alt="image-20200608200850974"></p>
<p>åœ¨æœåŠ¡å™¨å†…æ‹‰å–é¡¹ç›®ä»£ç åˆ°æœ¬åœ°</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image23.png" srcset="/img/loading.gif" alt="image-20200608201008309"></p>
<p>4ã€åˆ é™¤ä¹‹å‰åˆ›å»ºçš„ <code>xc-govern-center</code> é•œåƒ</p>
<div class="hljs"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> åœæ­¢å®¹å™¨</span>
sudo docker stop xc-govern-center-test
<span class="hljs-meta">#</span><span class="bash"> åˆ é™¤å®¹å™¨</span>
sudo docker rm xc-govern-center-test
<span class="hljs-meta">#</span><span class="bash"> åˆ é™¤é•œåƒ</span>
sudo docker rmi xc-govern-center:1.0-SNAPSHOT</code></pre></div>

<p>5ã€è¿›å…¥å·¥ç¨‹æ ¹ç›®å½•ï¼ˆ <code>pom_docker.xml</code> æ‰€åœ¨ç›®å½•ï¼‰æ‰§è¡Œ</p>
<p>å®‰è£… maven ç¯å¢ƒ</p>
<div class="hljs"><pre><code class="hljs shell">sudo apt install maven</code></pre></div>

<p>æ·»åŠ  maven ä»“åº“å›½å†…æºä»¥åŠé…ç½® <code>pluginGroup</code>ï¼Œç¼–è¾‘ <code>/usr/share/maven/conf/settings.xml</code> æ–‡ä»¶</p>
<p>åœ¨ <code>mirrors</code> æ ‡ç­¾ä¸‹æ·»åŠ å¦‚ä¸‹å†…å®¹</p>
<div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mirror</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>aliyun-public<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mirrorOf</span>&gt;</span>*<span class="hljs-tag">&lt;/<span class="hljs-name">mirrorOf</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>aliyun public<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://maven.aliyun.com/repository/public<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mirror</span>&gt;</span></code></pre></div>

<p>åœ¨ <code>pluginGroups</code> æ ‡ç­¾ä¸‹åŠ å…¥ä»¥ä¸‹å†…å®¹</p>
<div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">pluginGroup</span>&gt;</span>com.spotify<span class="hljs-tag">&lt;/<span class="hljs-name">pluginGroup</span>&gt;</span></code></pre></div>

<p>å¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src="https://qnoss.codeyee.com/20200704_5b6u5pyN5YqhW+WtpuaIkOWcqOe6v10gZGF5MjAtMe+8mkRldk9wcyDpobnnm67pg6jnvbLkuI7mjIHnu63pm4bmiJA=/image24.png" srcset="/img/loading.gif" alt="image-20200608202134759"></p>
<p>ç»™é¡¹ç›®çš„ç›®å½•è®¾ç½®æƒé™ï¼Œå¦åˆ™æ‰“åŒ…çš„æ—¶å€™ä¼šæŠ¥é”™</p>
<div class="hljs"><pre><code class="hljs powershell">sudo chown <span class="hljs-literal">-R</span> <span class="hljs-number">1000</span>:<span class="hljs-number">1000</span> ~/xc<span class="hljs-literal">-services</span>/</code></pre></div>

<p>è¿›å…¥åˆ° eureka å·¥ç¨‹ä¸‹ï¼Œæ‰§è¡Œæ‰“åŒ…å‘½ä»¤</p>
<div class="hljs"><pre><code class="hljs shell">mvn -f pom_docker.xml clean package -DskipTests docker:build</code></pre></div>

<p>ç­‰å¾…ä¾èµ–ä¸‹è½½å®Œæˆåå¼€å§‹æ„å»ºé•œåƒï¼Œåˆ›å»ºé•œåƒæˆåŠŸï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image25.png" srcset="/img/loading.gif" alt="image-20200608205339883"></p>
<p>ä½¿ç”¨è¯¥é•œåƒåˆ›å»ºå®¹å™¨</p>
<div class="hljs"><pre><code class="hljs shell">docker create --name xc-govern-center-test -t -p 50101:50101 -e PORT=50101 \
-e EUREKA_SERVER=http://10.1.1.162:50101/eureka/,http://10.1.1.162:50102/eureka/ xc-govern-center:1.0-SNAPSHOT</code></pre></div>

<p>å®¹å™¨åˆ›å»ºæˆåŠŸ</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image26.png" srcset="/img/loading.gif" alt="image-20200608205458488"></p>
<h1 id="å››ã€æŒç»­é›†æˆ"><a href="#å››ã€æŒç»­é›†æˆ" class="headerlink" title="å››ã€æŒç»­é›†æˆ"></a>å››ã€æŒç»­é›†æˆ</h1><h2 id="1-æŒç»­é›†æˆä»‹ç»"><a href="#1-æŒç»­é›†æˆä»‹ç»" class="headerlink" title="1. æŒç»­é›†æˆä»‹ç»"></a>1. æŒç»­é›†æˆä»‹ç»</h2><h3 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h3><p>ä¼ ç»Ÿçš„è½¯ä»¶å¼€å‘æµç¨‹å¦‚ä¸‹ï¼š</p>
<p>1ã€é¡¹ç›®ç»ç†åˆ†é…æ¨¡å—ç»™å¼€å‘äººå‘˜</p>
<p>2ã€æ¯ä¸ªæ¨¡å—çš„å¼€å‘äººå‘˜å¹¶è¡Œå¼€å‘ï¼Œå¹¶è¿›è¡Œå•å…ƒæµ‹è¯•</p>
<p>3ã€å¼€å‘å®Œæ¯•ï¼Œå°†ä»£ç é›†æˆéƒ¨ç½²åˆ°æµ‹è¯•æœåŠ¡å™¨ï¼Œæµ‹è¯•äººå‘˜è¿›è¡Œæµ‹è¯•ã€‚</p>
<p>4ã€æµ‹è¯•äººå‘˜å‘ç°bugï¼Œæäº¤bugã€å¼€å‘äººå‘˜ä¿®æ”¹bug</p>
<p>5ã€bugä¿®æ”¹å®Œæ¯•å†æ¬¡é›†æˆã€æµ‹è¯•ã€‚</p>
<p><strong>æœ‰å“ªäº›é—®é¢˜ï¼Ÿ</strong></p>
<p>1ã€æ¨¡å—ä¹‹é—´ä¾èµ–å…³ç³»å¤æ‚ï¼Œåœ¨é›†æˆæ—¶å‘ç°å¤§é‡bug</p>
<p>2ã€æµ‹è¯•äººå‘˜ç­‰å¾…æµ‹è¯•æ—¶é—´è¿‡é•¿</p>
<p>3ã€è½¯ä»¶äº¤ä»˜æ— æ³•ä¿éšœ</p>
<p><strong>è§£å†³ä¸Šè¿°é—®é¢˜çš„æ€è€ƒï¼š</strong></p>
<p>1ã€èƒ½å¦æŠŠé›†æˆæµ‹è¯•æ—¶é—´æå‰ï¼Ÿ</p>
<p>2ã€èƒ½å¦ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·ä»£æ›¿äººå·¥é›†æˆéƒ¨ç½²çš„è¿‡ç¨‹ï¼Ÿ</p>
<h3 id="ä»€ä¹ˆæ˜¯æŒç»­é›†æˆï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æŒç»­é›†æˆï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æŒç»­é›†æˆï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æŒç»­é›†æˆï¼Ÿ</h3><p>æŒç»­é›†æˆï¼ˆContinuous integrationï¼‰ç®€ç§° <code>CI</code>ï¼ŒæŒç»­é›†æˆçš„æ€æƒ³æ˜¯æ¯å¤©è¦å¤šæ¬¡å°†ä»£ç åˆå¹¶åˆ°ä¸»å¹²ï¼Œå¹¶è¿›è¡Œé›†æˆã€æµ‹è¯•ï¼Œè¿™æ ·å°±å¯ä»¥ææ—©å‘ç°é”™è¯¯ï¼Œè¿›è¡Œä¿®æ­£ã€‚æŒä¹…é›†æˆä¹Ÿå±äº <code>DevOps</code></p>
<p>æŒç»­é›†æˆçš„å¥½å¤„ï¼š</p>
<p>1ã€è‡ªåŠ¨åŒ–é›†æˆéƒ¨ç½²ï¼Œæé«˜äº†é›†æˆæ•ˆç‡ã€‚</p>
<p>2ã€æ›´å¿«çš„ä¿®å¤é—®é¢˜ã€‚</p>
<p>3ã€æ›´å¿«çš„è¿›è¡Œäº¤ä»˜ã€‚</p>
<p>4ã€æé«˜äº†äº§å“è´¨é‡ã€‚</p>
<h3 id="æœ¬é¡¹ç›®æŒç»­é›†æˆæµç¨‹"><a href="#æœ¬é¡¹ç›®æŒç»­é›†æˆæµç¨‹" class="headerlink" title="æœ¬é¡¹ç›®æŒç»­é›†æˆæµç¨‹"></a>æœ¬é¡¹ç›®æŒç»­é›†æˆæµç¨‹</h3><p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image27.png" srcset="/img/loading.gif" alt="image-20200608210048479"></p>
<h2 id="2-æ­å»ºç¯å¢ƒ"><a href="#2-æ­å»ºç¯å¢ƒ" class="headerlink" title="2. æ­å»ºç¯å¢ƒ"></a>2. æ­å»ºç¯å¢ƒ</h2><h3 id="å®‰è£…Jenkins"><a href="#å®‰è£…Jenkins" class="headerlink" title="å®‰è£…Jenkins"></a>å®‰è£…Jenkins</h3><p>Jenkinsæ˜¯ä¸€ä¸ªé¢†å…ˆçš„å¼€æºè‡ªåŠ¨åŒ–æœåŠ¡å™¨ï¼Œå¯ç”¨äºè‡ªåŠ¨åŒ–æ„å»ºï¼Œæµ‹è¯•ï¼Œéƒ¨ç½²è½¯ä»¶ç­‰ç›¸å…³ä»»åŠ¡ã€‚</p>
<p>å®˜ç½‘åœ°å€ï¼š<a href="https://jenkins.io/" target="_blank" rel="noopener">https://jenkins.io</a></p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image28.png" srcset="/img/loading.gif" alt="image-20200608210213712"></p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image29.png" srcset="/img/loading.gif" alt="image-20200608210914373"></p>
<h4 id="1ã€ä½¿ç”¨Dockerå®‰è£…Jenkins"><a href="#1ã€ä½¿ç”¨Dockerå®‰è£…Jenkins" class="headerlink" title="1ã€ä½¿ç”¨Dockerå®‰è£…Jenkins"></a>1ã€ä½¿ç”¨Dockerå®‰è£…Jenkins</h4><p>æœ¬æ•™ç¨‹åœ¨ <code>docker</code> ä¸‹å®‰è£… <code>Jenkins</code>ï¼š</p>
<p>æ‹‰å–é•œåƒ</p>
<div class="hljs"><pre><code class="hljs shell">docker pull jenkinsci/blueocean</code></pre></div>

<p>åˆ›å»ºå®¹å™¨æŒ‚è½½ç›®å½•ï¼Œå¹¶ä¸”èµ‹äºˆæƒé™</p>
<div class="hljs"><pre><code class="hljs shell">mkdir /var/docker/jenkins -p
sudo chown -R 1000:1000 /var/docker/jenkins  # è¿™é‡Œéœ€è¦ä¸ºjenkinsçš„ç›®å½•èµ‹äºˆ1000æƒé™</code></pre></div>

<blockquote>
<p>æ³¨æ„ï¼šåœ¨å®‰è£…jenkinsæ—¶å€™ï¼ŒæŒ‚åœ¨æ–‡ä»¶å¤¹<code>/var/docker/jenkins</code> çš„å½’å±ç”¨æˆ·idå¿…é¡»æ˜¯1000ï¼Œå¦åˆ™ä¼šæŠ›å‡ºæ— æ“ä½œæƒé™å¼‚å¸¸ã€‚</p>
</blockquote>
<p>åˆ›å»ºå®¹å™¨ï¼š</p>
<div class="hljs"><pre><code class="hljs shell">docker run -itd --name jenkins -u root -p 8900:8080 --privileged=true \
-v /var/docker/jenkins:/var/jenkins_home \
-v /var/run/docker.sock:/var/run/docker.sock \
-v /home/jenkins:/home docker.io/jenkinsci/blueocean</code></pre></div>

<blockquote>
<ul>
<li>docker run åˆ›å»ºå®¹å™¨å¹¶ä¸”è¿è¡Œ</li>
<li>docker create åªåˆ›å»ºè€Œä¸è¿è¡Œ</li>
</ul>
</blockquote>
<p>è®¿é—®ä½ è™šæ‹Ÿæœºçš„ <code>8900</code> ç«¯å£ï¼Œæˆ‘è¿™é‡Œçš„åœ°å€ä¸º <a href="http://10.1.1.161:8900/" target="_blank" rel="noopener">http://10.1.1.161:8900</a></p>
<p>åˆæ¬¡è¿è¡Œ <code>Jenkins</code> ä¼šç»è¿‡ä¸€ä¸ªå®‰è£…è¿‡ç¨‹ï¼Œä¸€èˆ¬æƒ…å†µä½¿ç”¨é»˜è®¤é…ç½®ï¼Œä¸‹ä¸€æ­¥å®‰è£…å³å¯ï¼Œå…¶ä¸­ä¸€æ­¥éœ€è¦è¾“å…¥å¯†ç ï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="https://qnoss.codeyee.com/20200704_5b6u5pyN5YqhW+WtpuaIkOWcqOe6v10gZGF5MjAtMe+8mkRldk9wcyDpobnnm67pg6jnvbLkuI7mjIHnu63pm4bmiJA=/image30.png" srcset="/img/loading.gif" alt="image-20200606140413863"></p>
<p>å‡ºç°ä¸Šè¾¹çš„ç”»é¢éœ€è¦è¾“å…¥ jenkins çš„åˆå§‹å¯†ç ï¼ŒæŸ¥çœ‹å®¹å™¨çš„è¿è¡Œæ—¥å¿—ï¼Œä»æ—¥å¿—ä¸­æ‰¾åˆ°åˆå§‹é‡Œé¢</p>
<div class="hljs"><pre><code class="hljs ebnf"><span class="hljs-attribute">sudo docker logs -f jenkins</span></code></pre></div>

<p>æ—¥å¿—å¦‚ä¸‹å›¾</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image31.png" srcset="/img/loading.gif" alt="image-20200607111618576"></p>
<p>æ—¥å¿—ä¸­æ²¡æœ‰æ‰¾åˆ°åˆå§‹å¯†ç ï¼Ÿæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è¯¥å®¹å™¨æŒ‚è½½åˆ°æœ¬åœ°ç›®å½•çš„æ–‡ä»¶ä¸‹æŸ¥çœ‹ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬åœ¨åˆ›å»ºå®¹å™¨æ—¶æŒ‡å®šäº† <code>-v /var/docker/jenkins:/var/jenkins_home</code> ï¼Œè¡¨ç¤ºå°† <code>/var/docker/jenkins</code> ç›®å½•æ˜ å°„åˆ° <code>jenkins</code> å®¹å™¨ä¸Šçš„ <code>/var/jenkins_home</code> ç›®å½•ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æœ¬åœ°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹ <code>jenkins</code> çš„åˆå§‹å¯†ç </p>
<div class="hljs"><pre><code class="hljs shell">cat /var/docker/jenkins/secrets/initialAdminPassword</code></pre></div>

<p>åˆå§‹å¯†ç å¦‚ä¸‹</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image32.png" srcset="/img/loading.gif" alt="image-20200607101707269"></p>
<p>è¾“å…¥åˆå§‹å¯†ç åˆ° jenkins é¡µé¢åï¼Œç»§ç»­å®Œæˆåç»­çš„åˆå§‹åŒ–æ­¥éª¤ã€‚</p>
<p>å¦‚æœå‡ºç°ä¸€ç›´åœç•™åœ¨åœ¨ <code>ready</code> é¡µé¢ï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image33.png" srcset="/img/loading.gif" alt="image-20200607111259258"></p>
<p>ä¿®æ”¹ jenkins çš„é…ç½®æ–‡ä»¶ <code>hudson.model.UpdateCenter.xml</code> å°† url ä¿®æ”¹ä¸ºå›½å†…çš„ <code>jenkins</code> æº</p>
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</a></p>
<p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¹¶æ›¿æ¢urlæ ‡ç­¾å†…å€¼ä¸ºä¸Šè¿°åœ°å€</p>
<div class="hljs"><pre><code class="hljs awk">vim <span class="hljs-regexp">/var/</span>docker<span class="hljs-regexp">/jenkins/</span>hudson.model.UpdateCenter.xml</code></pre></div>

<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image34.png" srcset="/img/loading.gif" alt="image-20200607111740728"></p>
<p>è¾“å…¥å¯†ç åè¿›å…¥åˆ°æ’ä»¶å®‰è£…é¡µé¢</p>
<p><img src="https://qnoss.codeyee.com/20200704_5b6u5pyN5YqhW+WtpuaIkOWcqOe6v10gZGF5MjAtMe+8mkRldk9wcyDpobnnm67pg6jnvbLkuI7mjIHnu63pm4bmiJA=/image35.png" srcset="/img/loading.gif" alt="image-20200607112006171"></p>
<p>å¦‚æœæ„¿æ„ç­‰çš„è¯ï¼Œå¯ä»¥é€‰æ‹©ç¬¬ä¸€ä¸ªå®‰è£…æ‰€æœ‰é»˜è®¤æ¨èçš„æ’ä»¶ï¼Œä½†æ˜¯å¤§æ¦‚éœ€è¦1å°æ—¶å·¦å³æ‰èƒ½å®‰è£…å®Œæˆã€‚</p>
<p>ä¸ºäº†èŠ‚çœæ—¶é—´æˆ‘ä»¬å¯ä»¥é€‰æ‹©ç¬¬äºŒä¸ªï¼Œå–æ¶ˆé»˜è®¤é€‰æ‹©çš„æ’ä»¶ï¼Œç„¶åç»§ç»­ä¸‹ä¸€æ­¥æ“ä½œã€‚</p>
<p>å¦‚æœé€‰æ‹©äº†å®‰è£…æ¨èï¼Œåˆ™éœ€è¦ç­‰å¾…æ’ä»¶å®‰è£…å®Œæˆï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image36.png" srcset="/img/loading.gif" alt="image-20200607112232774"></p>
<p>æ’ä»¶å®‰è£…å®Œæˆåï¼Œè®¾ç½®ç®¡ç†å‘˜ä¿¡æ¯</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image37.png" srcset="/img/loading.gif" alt="image-20200607161327005"></p>
<p>æœ¬é¡¹ç›®ä½¿ç”¨ <code>Jenkins</code> éœ€è¦é…ç½®Jdk1.8ã€Gitã€mavenã€‚</p>
<p><strong>1ï¼‰Maven å®‰è£…ï¼š</strong></p>
<p>åˆ°å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆçš„maven <a href="http://maven.apache.org/download.cgi" target="_blank" rel="noopener">http://maven.apache.org/download.cgi</a></p>
<p>è§£å‹ <code>maven</code> å‹ç¼©åŒ…åˆ°å®¹å™¨çš„æŒ‚è½½ç›®å½•ä¸‹</p>
<div class="hljs"><pre><code class="hljs crystal">tar zxvf apache-maven-<span class="hljs-number">3.6</span>.<span class="hljs-number">3</span>-bin.tar.gz -C /var/docker/jenkins/<span class="hljs-class"><span class="hljs-keyword">lib</span>/</span></code></pre></div>

<p>åœ¨æ§åˆ¶å° <code>Global Tool Configuration</code> é…ç½®mavenè·¯å¾„ä¸ºå®¹å™¨å†…çš„ç›®å½• <code>/var/jenkins_home/lib/apache-maven-3.6.3/</code></p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image38.png" srcset="/img/loading.gif" alt="image-20200607171140658"></p>
<p><strong>2ï¼‰Jdkå®‰è£…é…ç½®</strong></p>
<blockquote>
<p>å¦‚æœjenkinsé•œåƒé‡Œé¢æœ‰è¯¥ç¯å¢ƒåˆ™ä¸éœ€è¦å†å®‰è£…</p>
</blockquote>
<p>å®¿ä¸»æœºå®‰è£…java</p>
<div class="hljs"><pre><code class="hljs shell">sudo apt-get install openjdk-8-jdk</code></pre></div>

<p>æ‹·è´æœ¬åœ° <code>JDK</code> ç¯å¢ƒåˆ° <code>jenkins</code> å®¹å™¨çš„æŒ‚è½½ç›®å½•çš„ lib ç›®å½•ä¸‹</p>
<div class="hljs"><pre><code class="hljs shell">mkdir -p /var/docker/jenkins/lib/java-1.8.0-openjdk-amd64 &amp;&amp; cp -r /usr/lib/jvm/java-1.8.0-openjdk-amd64/* /var/docker/jenkins/lib/java-1.8.0-openjdk-amd64</code></pre></div>

<p>åœ¨ jenkins è®¾ç½® jdkçš„è·¯å¾„ä¸º <code>/var/jenkins_home/lib/java-1.8.0-openjdk-amd64</code>ï¼Œè¯¥è·¯å¾„ä¸ºå®¹å™¨é‡Œé¢çš„è·¯å¾„</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image39.png" srcset="/img/loading.gif" alt="image-20200606140553273"></p>
<p><strong>3ï¼‰Gitå®‰è£…æ–¹æ³•åŒä¸Š</strong></p>
<blockquote>
<p>å¦‚æœjenkinsé•œåƒé‡Œé¢æœ‰è¯¥ç¯å¢ƒåˆ™ä¸éœ€è¦å†å®‰è£…</p>
</blockquote>
<p>å®¿ä¸»æœºå®‰è£…git</p>
<div class="hljs"><pre><code class="hljs powershell">apt<span class="hljs-literal">-get</span> install git</code></pre></div>

<p>å¤åˆ¶gitåˆ°å®¹å™¨æŒ‚è½½çš„ç›®å½•ä¸‹</p>
<div class="hljs"><pre><code class="hljs shell">mkdir /var/docker/jenkins/lib/git &amp;&amp; cp -r /usr/lib/git-core/* /var/docker/jenkins/lib/git</code></pre></div>

<p>åœ¨ <code>jenkins</code>æ§åˆ¶å°ä¸Šé…ç½®å®¹å™¨ä¸­çš„ git æ–‡ä»¶çš„è·¯å¾„ <code>/var/jenkins_home/lib/git/git</code></p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image40.png" srcset="/img/loading.gif" alt="image-20200607175332443"></p>
<h4 id="2ã€é…ç½®-SSH-Remote-Hosts"><a href="#2ã€é…ç½®-SSH-Remote-Hosts" class="headerlink" title="2ã€é…ç½® SSH Remote Hosts"></a>2ã€é…ç½® SSH Remote Hosts</h4><p>SSH remote hosts æ˜¯ <code>Jenkins</code> æä¾›çš„ä¸€ç§è¿œç¨‹è®¿é—® <code>ssh</code> æœåŠ¡å™¨çš„æ–¹æ³•ï¼Œé€šè¿‡å¦‚ä¸‹æ­¥éª¤æµ‹è¯•æ­¤åŠŸèƒ½ï¼š</p>
<p><strong>1ï¼‰å®‰è£…æ’ä»¶SSH plugin</strong></p>
<p>è®¿é—®è™šæ‹Ÿæœºçš„åœ°å€ <a href="http://10.1.1.161:8900/pluginManager/" target="_blank" rel="noopener">http://10.1.1.161:8900/pluginManager/</a></p>
<p>ä»å¯é€‰æ’ä»¶ä¸­é€‰æ‹©SSH Pluginè¿›è¡Œå®‰è£…</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image41.png" srcset="/img/loading.gif" alt="image-20200607171628455"></p>
<p>å®‰è£…æˆåŠŸå¯åœ¨å·²å®‰è£…æ’ä»¶ä¸­æŸ¥è¯¢ï¼š</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image42.png" srcset="/img/loading.gif" alt="image-20200607171720075"></p>
<p><strong>2ï¼‰é…ç½®å‡­è¯</strong></p>
<p>è®¿é—®è™šæ‹Ÿæœº <a href="http://10.1.1.161:8900/credentials/store/system/domain/_/newCredentials" target="_blank" rel="noopener">http://10.1.1.161:8900/credentials/store/system/domain/_/newCredentials</a></p>
<p>é…ç½®éƒ¨ç½²æœåŠ¡çš„è™šæ‹Ÿæœºçš„ <code>SSH</code> ç™»å½•è´¦å·å’Œå¯†ç ï¼š</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image43.png" srcset="/img/loading.gif" alt="image-20200606140717614"></p>
<p><strong>3ï¼‰é…ç½®SSH sites</strong></p>
<p>è®¿é—® <a href="http://10.1.1.161:8900/configure" target="_blank" rel="noopener">http://10.1.1.161:8900/configure</a></p>
<p>æ‰¾åˆ° ssh sites çš„é…ç½®ï¼Œè¾“å…¥ä½ è¦è¿œç¨‹é…ç½®çš„æœåŠ¡å™¨ <code>IP</code> å’Œ <code>ç«¯å£</code> ç­‰ä¿¡æ¯ï¼Œå¹¶é€‰æ‹©ä½ åˆšæ‰æ·»åŠ çš„å‡­è¯ä¿¡æ¯ã€‚</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image44.png" srcset="/img/loading.gif" alt="image-20200607172721808"></p>
<p><strong>4ï¼‰åœ¨ä»»åŠ¡æ„å»ºä¸­ç¼–å†™è„šæœ¬</strong></p>
<p>ä¸‹æ‹‰åˆ° â€œæ„å»ºâ€ çš„é€‰é¡¹ï¼Œé€‰æ‹© <code>Execute shell</code> çš„é€‰é¡¹</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image45.png" srcset="/img/loading.gif" alt="image-20200607174116753"></p>
<p>é€‰æ‹©åˆšæ‰æ·»åŠ çš„ ssh sitesï¼Œ å¡«å†™ä½ è¦æ‰§è¡Œçš„shellå‘½ä»¤ï¼Œç„¶åä¿å­˜</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image46.png" srcset="/img/loading.gif" alt="image-20200607174305189"></p>
<p>ç‚¹å‡»ä¿å­˜åï¼Œç‚¹å‡»å·¦è¾¹çš„ç«‹å³æ„å»ºï¼Œæµ‹è¯•æ˜¯å¦èƒ½å¤Ÿæ‰§è¡Œ shell å‘½ä»¤åˆ°æŒ‡å®šçš„æœåŠ¡å™¨ä¸Šã€‚</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image47.png" srcset="/img/loading.gif" alt="image-20200607174350348"></p>
<p>è¿œç¨‹å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œæ‰§è¡Œäº† <code>echo</code> å‘½ä»¤å†™å…¥å†…å®¹åˆ°æ–‡ä»¶ä¸Šï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image48.png" srcset="/img/loading.gif" alt="image-20200607174407110"></p>
<h3 id="æ­å»ºDockerç§æœ‰ä»“åº“"><a href="#æ­å»ºDockerç§æœ‰ä»“åº“" class="headerlink" title="æ­å»ºDockerç§æœ‰ä»“åº“"></a>æ­å»ºDockerç§æœ‰ä»“åº“</h3><p>å¾®æœåŠ¡çš„é•œåƒä¼šä¸Šä¼ åˆ° <code>Docker</code> ä»“åº“ä¿å­˜ï¼Œå¸¸ç”¨çš„å…¬ç½‘ <code>Docker</code> ä»“åº“æœ‰é˜¿é‡Œäº‘ï¼Œç½‘æ˜“äº‘ç­‰ï¼Œåœ¨ä¼ä¸šå±€åŸŸç½‘ä¹Ÿå¯ä»¥æ­å»ºè‡ªå·±çš„ <code>Docker</code> ç§æœ‰ä»“åº“ï¼Œæœ¬æ•™ç¨‹ä½¿ç”¨ Docker æä¾›çš„ç§æœ‰ä»“åº“ <code>registry</code>ã€‚</p>
<p>è¿›å…¥ Docker ç§æœ‰ä»“åº“æ‰€åœ¨æœåŠ¡å™¨æ‰§è¡Œï¼š</p>
<p>1ã€å®‰è£… Docker</p>
<p>2ã€åˆ›å»ºç§æœ‰ä»“åº“å®¹å™¨</p>
<div class="hljs"><pre><code class="hljs shell">sudo docker run --name docker-registry -d -p 5000:5000 registry</code></pre></div>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image49.png" srcset="/img/loading.gif" alt="image-20200607180928284"></p>
<p>ä¸Šè¾¹æ˜¾ç¤º <code>registry</code> é•œåƒå·²ç»åˆ›å»ºï¼Œå¹¶ä¸” <code>docker-registry</code> å®¹å™¨å·²ç»å¯åŠ¨æˆåŠŸã€‚</p>
<p>è®¿é—®ï¼š<a href="http://10.1.1.161:5000/v2/_catalog" target="_blank" rel="noopener">http://10.1.1.161:5000/v2/_catalog</a></p>
<p>å“åº”ç»“æœå¦‚ä¸‹ï¼š</p>
<div class="hljs"><pre><code class="hljs json">&#123;<span class="hljs-attr">"repositories"</span>:[]&#125;</code></pre></div>

<p>ä¸Šè¾¹çš„å“åº”ç»“æœè¯´æ˜åœ¨ <code>docker</code> ç§æœ‰ä»“åº“ä¸­è¿˜æ²¡æœ‰é•œåƒã€‚</p>
<p>é»˜è®¤ docker-registry åªå…è®¸ https æäº¤é•œåƒï¼Œå¦‚ä¸‹é…ç½®ä½¿ <code>docker-registry</code> æ”¯æŒ <code>http</code></p>
<p>åœ¨å®¿ä¸»æœº <code>/etc/docker</code> ä¸‹ï¼Œåˆ›å»º <code>daemon.json</code> æ–‡ä»¶ï¼Œå†™å…¥ï¼š</p>
<div class="hljs"><pre><code class="hljs json">&#123;
    <span class="hljs-attr">"insecure-registries"</span>:[<span class="hljs-string">"10.1.1.161:5000"</span>]
&#125;</code></pre></div>

<p>é‡å¯ dockerï¼š</p>
<div class="hljs"><pre><code class="hljs shell">systemctl restart docker.service</code></pre></div>

<p>å¯åŠ¨ docker-registry</p>
<div class="hljs"><pre><code class="hljs shell">sudo docker start docker-registry</code></pre></div>

<h3 id="å®‰è£…Gitlab"><a href="#å®‰è£…Gitlab" class="headerlink" title="å®‰è£…Gitlab"></a>å®‰è£…Gitlab</h3><p>ç”±äºå‰é¢çš„å†…å®¹å°±å·²ç»éœ€è¦ç”¨åˆ° <code>gitlab</code>ï¼Œæ‰€ä»¥åœ¨æœ¬æ–‡å¼€å§‹çš„å†…å®¹ä¸­å·²ç»ä»‹ç»äº†æ•´ä¸ª <code>gitlab</code> å®‰è£…éƒ¨ç½²æµç¨‹</p>
<h3 id="ç¼–å†™pom"><a href="#ç¼–å†™pom" class="headerlink" title="ç¼–å†™pom"></a>ç¼–å†™pom</h3><p>æœ¬ä¾‹å­å°† <code>xc-govern-center</code> å·¥ç¨‹ä½¿ç”¨ <code>Jenkins</code> è¿›è¡Œæ„å»ºã€‚</p>
<p>åœ¨ xc-govern-center å·¥ç¨‹æ ¹ç›®å½•ç¼–å†™ <code>pom_docker_registry.xml</code></p>
<p>æ­¤æ–‡ä»¶ç›¸æ¯”å·¥ç¨‹åŸæœ‰ <code>pom_docker.xml</code> å¢åŠ äº†<code>docker-maven-plugin</code> æ’ä»¶ï¼Œå…¶ä½œç”¨æ˜¯æ„å»ºdockeré•œåƒå¹¶å°†é•œåƒæ¨é€åˆ° <code>Docker</code> ç§æœ‰ä»“åº“ï¼Œæˆ‘çš„dockerä»“åº“åœ°å€æ˜¯ 10.1.1.161:5000</p>
<div class="hljs"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span>
<span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span>
<span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0</span></span>
<span class="hljs-tag"><span class="hljs-string">                             http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xc-framework-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>&gt;</span>../xc-framework-parent/pom.xml<span class="hljs-tag">&lt;/<span class="hljs-name">relativePath</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>
 
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xc-govern-center<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 
    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">finalName</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.spotify<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>docker-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-comment">&lt;!--dockeré•œåƒç›¸å…³çš„é…ç½®ä¿¡æ¯--&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
                    <span class="hljs-comment">&lt;!--é•œåƒåï¼Œè¿™é‡Œç”¨å·¥ç¨‹å--&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">imageName</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">imageName</span>&gt;</span>
                    <span class="hljs-comment">&lt;!--Dockerfileæ–‡ä»¶æ‰€åœ¨ç›®å½•--&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">dockerDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">dockerDirectory</span>&gt;</span>
                    <span class="hljs-comment">&lt;!--TAG,è¿™é‡Œç”¨å·¥ç¨‹ç‰ˆæœ¬å·--&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">imageTags</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">imageTag</span>&gt;</span>$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">imageTag</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">imageTags</span>&gt;</span>
                    <span class="hljs-comment">&lt;!--ç§æœ‰dockerä»“åº“åœ°å€--&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">registryUrl</span>&gt;</span>10.1.1.161:5000<span class="hljs-tag">&lt;/<span class="hljs-name">registryUrl</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">pushImage</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">pushImage</span>&gt;</span>
                    <span class="hljs-comment">&lt;!--æ„å»ºåçš„é•œåƒåç§°--&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">imageName</span>&gt;</span>10.1.1.161:5000/$&#123;project.artifactId&#125;:$&#123;project.version&#125;
                    <span class="hljs-tag">&lt;/<span class="hljs-name">imageName</span>&gt;</span>
                    <span class="hljs-comment">&lt;!--æ„å»ºé•œåƒçš„é…ç½®ä¿¡æ¯--&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">targetPath</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">targetPath</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;.jar<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span></code></pre></div>

<p>ç¨åæˆ‘ä»¬ç»“åˆ <code>jenkins</code> æ¥è¿›è¡Œè‡ªåŠ¨æ„å»ºã€‚</p>
<h2 id="3-åˆ›å»ºæŒç»­é›†æˆä»»åŠ¡"><a href="#3-åˆ›å»ºæŒç»­é›†æˆä»»åŠ¡" class="headerlink" title="3. åˆ›å»ºæŒç»­é›†æˆä»»åŠ¡"></a>3. åˆ›å»ºæŒç»­é›†æˆä»»åŠ¡</h2><h3 id="åˆ›å»ºjenkinsçš„æ„å»ºä»»åŠ¡"><a href="#åˆ›å»ºjenkinsçš„æ„å»ºä»»åŠ¡" class="headerlink" title="åˆ›å»ºjenkinsçš„æ„å»ºä»»åŠ¡"></a>åˆ›å»ºjenkinsçš„æ„å»ºä»»åŠ¡</h3><p>æ–°å»ºä¸€ä¸ªä»»åŠ¡ xc-eduï¼Œé€‰æ‹© â€œæ„å»ºä¸€ä¸ªè‡ªç”±é£æ ¼çš„è½¯ä»¶é¡¹ç›®â€ ï¼Œç‚¹å‡»ç¡®å®š</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image50.png" srcset="/img/loading.gif" alt="image-20200609173403898"></p>
<h3 id="é…ç½®gitä»“åº“"><a href="#é…ç½®gitä»“åº“" class="headerlink" title="é…ç½®gitä»“åº“"></a>é…ç½®gitä»“åº“</h3><p>1ã€é…ç½®gitå‡­è¯</p>
<p>æ­¤å‡­è¯ç”¨äºè¿œç¨‹ä» <code>git</code> ä»“åº“å…‹éš†å·¥ç¨‹æºä»£ç </p>
<p>è¾“å…¥ <code>git</code> ä»“åº“çš„è´¦å·å’Œå¯†ç ï¼Œè¿™é‡Œå¦‚æœä½¿ç”¨ç äº‘ï¼Œä¸‹è¾¹éœ€è¦é…ç½®ç äº‘çš„è´¦å·å’Œå¯†ç ã€‚</p>
<p>è®¿é—® <a href="http://10.1.1.161:8900/credentials/store/system/domain/_/newCredentials" target="_blank" rel="noopener">http://10.1.1.161:8900/credentials/store/system/domain/_/newCredentials</a></p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image51.png" srcset="/img/loading.gif" alt="image-20200610155838201"></p>
<p>2ã€åœ¨åˆšæ‰æˆ‘ä»¬æ–°å»ºçš„ <code>xc-edu</code> ä»»åŠ¡ä¸‹é…ç½® <code>git</code> ä»“åº“åœ°å€ï¼Œæ­¤åœ°å€å³ <code>xc-edu</code> é¡¹ç›®çš„åœ°å€</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image52.png" srcset="/img/loading.gif" alt="image-20200609170051196"></p>
<h3 id="é…ç½®è‡ªåŠ¨æ„å»ºæµç¨‹"><a href="#é…ç½®è‡ªåŠ¨æ„å»ºæµç¨‹" class="headerlink" title="é…ç½®è‡ªåŠ¨æ„å»ºæµç¨‹"></a>é…ç½®è‡ªåŠ¨æ„å»ºæµç¨‹</h3><p>å®ç°ç›®æ ‡ï¼š</p>
<p>ä½¿ç”¨ <code>jenkins</code> é‡å¤æ„å»ºä¸è¦äº§ç”Ÿé‡å¤é•œåƒ</p>
<p>ä½¿ç”¨ <code>jenkins</code> åœæ­¢å®¹å™¨ã€åˆ é™¤å®¹å™¨ã€åˆ é™¤é•œåƒä¹‹é—´è¿›è¡Œåˆ¤æ–­</p>
<p><strong>æ„å»ºè¿‡ç¨‹åˆ†ä¸ºä¸‰æ­¥ï¼š</strong></p>
<p>æœ¬ä¾‹å­ä»¥æ„å»º <code>xc-govern-center</code> å·¥ç¨‹ä¸ºä¾‹ï¼Œå…¶å®ƒå·¥ç¨‹æ„å»ºæ–¹å¼ç±»ä¼¼ã€‚</p>
<h4 id="1ã€åœæ­¢å®¹å™¨ã€åˆ é™¤å®¹å™¨ã€åˆ é™¤é•œåƒ"><a href="#1ã€åœæ­¢å®¹å™¨ã€åˆ é™¤å®¹å™¨ã€åˆ é™¤é•œåƒ" class="headerlink" title="1ã€åœæ­¢å®¹å™¨ã€åˆ é™¤å®¹å™¨ã€åˆ é™¤é•œåƒ"></a><strong>1ã€åœæ­¢å®¹å™¨ã€åˆ é™¤å®¹å™¨ã€åˆ é™¤é•œåƒ</strong></h4><p>shellè„šæœ¬å¦‚ä¸‹ï¼š</p>
<div class="hljs"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span>
result=$(docker ps | grep "192.168.101.64:5000/xc-govern-center")
if [[ "$result" != "" ]]
then
echo "stop xc-govern-center"
sudo docker stop xc-govern-center
fi
result1=$(docker ps -a | grep "192.168.101.64:5000/xc-govern-center")
if [[ "$result1" != "" ]]
then
echo "rm xc-govern-center"
sudo docker rm xc-govern-center
fi
result2=$(docker images | grep "192.168.101.64:5000/xc-govern-center")
if [[ "$result2" != "" ]]
then
echo "192.168.101.64:5000/xc-govern-center:1.0-SNAPSHOT"
sudo docker rmi 192.168.101.64:5000/xc-govern-center:1.0-SNAPSHOT
fi</code></pre></div>

<blockquote>
<ol>
<li>æ£€æŸ¥æŒ‡å®šé•œåƒæ˜¯å¦æœ‰å®¹å™¨åœ¨è¿è¡Œï¼Œæœ‰åˆ™åœæ­¢å®¹å™¨</li>
<li>æ£€æŸ¥æŒ‡å®šé•œåƒæ˜¯å¦åˆ›å»ºäº†å®¹å™¨ï¼Œæœ‰åˆ™åˆ é™¤å®¹å™¨</li>
<li>æ£€æŸ¥æ˜¯å¦å­˜åœ¨æŒ‡å®šé•œåƒï¼Œå­˜åœ¨åˆ™åˆ é™¤è¯¥é•œåƒ</li>
</ol>
</blockquote>
<p>æ·»åŠ ä¸€ä¸ªæ„å»ºæ­¥éª¤</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image53.png" srcset="/img/loading.gif" alt="image-20200609175013408"></p>
<p>é€‰æ‹©æˆ‘ä»¬çš„æœåŠ¡å™¨åœ°å€ï¼Œå°†è„šæœ¬å†…å®¹å¤åˆ¶ <code>command</code> ä¸­ï¼Œä½œä¸ºç¬¬ä¸€æ­¥éœ€è¦æ‰§è¡Œçš„å†…å®¹</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image54.png" srcset="/img/loading.gif" alt="img"></p>
<p>æ³¨æ„ï¼Œå¦‚æœåœ¨jenkinsè¿œç¨‹æ‰§è¡Œçš„ <code>SSHå‡­è¯</code> é <code>root</code> ç”¨æˆ·ï¼Œéœ€è¦åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†å½“å‰ç”¨æˆ·åŠ å…¥åˆ° <code>docker</code> ç»„å†…</p>
<div class="hljs"><pre><code class="hljs shell">sudo usermod -aG docker $USER</code></pre></div>

<h4 id="2ã€é…ç½®mavenæ­¥éª¤"><a href="#2ã€é…ç½®mavenæ­¥éª¤" class="headerlink" title="2ã€é…ç½®mavenæ­¥éª¤"></a>2ã€é…ç½®mavenæ­¥éª¤</h4><p>æ·»åŠ ä¸€ä¸ªæ„å»ºæ­¥éª¤ï¼Œé€‰æ‹© è°ƒç”¨é¡¶å±‚mavenç›®æ ‡ï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image55.png" srcset="/img/loading.gif" alt="image-20200609175128767"></p>
<p>é…ç½®ç¬¬äºŒæ­¥ï¼Œæ‰§è¡Œå¦‚ä¸‹mavenæŒ‡ä»¤</p>
<div class="hljs"><pre><code class="hljs shell">clean package -f xc-govern-center/pom_docker_registry.xml -DskipTests docker:build</code></pre></div>

<p>å¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image56.png" srcset="/img/loading.gif" alt="image-20200609175242308"></p>
<h4 id="3ã€é…ç½®dockeræ­¥éª¤"><a href="#3ã€é…ç½®dockeræ­¥éª¤" class="headerlink" title="3ã€é…ç½®dockeræ­¥éª¤"></a>3ã€é…ç½®dockeræ­¥éª¤</h4><p>ç»§ç»­æ·»åŠ ä¸€ä¸ªæ‰§è¡Œ <code>shell</code> çš„æ„å»ºæ­¥éª¤</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image57.png" srcset="/img/loading.gif" alt="image-20200609175314254"></p>
<p>é…ç½®ç¬¬ä¸‰æ­¥ï¼Œä» <code>docker</code> ç§æœ‰ä»“åº“æ‹‰å–é•œåƒå¹¶åˆ›å»ºå®¹å™¨ï¼Œå¯åŠ¨å®¹å™¨</p>
<div class="hljs"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å¦‚æœæŒ‡å®šå®¹å™¨å®¹å™¨ä¸å­˜åœ¨åˆ™æ‹‰å–åå†è¿›è¡Œåˆ›å»ºï¼Œå¹¶ä¸”åˆ›å»ºåè‡ªåŠ¨æ‰§è¡Œ</span>
docker run --name xc-govern-center -p 50101:50101 -idt 10.1.1.161:5000/xc-govern-center:1.0-SNAPSHOT
docker logs xc-govern-center</code></pre></div>

<blockquote>
<p>æ³¨æ„ä½¿ç”¨logè¾“å‡ºå®¹å™¨å¯åŠ¨çŠ¶æ€æ—¶ä¸è¦åŠ -få‚æ•°ï¼Œå¦åˆ™ä¼šä¸€ç›´è¾“å‡ºå®¹å™¨æ—¥å¿—ï¼Œå¯¼è‡´ä»»åŠ¡ä¸€ç›´å¤„äºæ„å»ºä¸­ã€‚c</p>
</blockquote>
<p>å¦‚ä¸‹å›¾</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image58.png" srcset="/img/loading.gif" alt="image-20200611152804801"></p>
<p>æ·»åŠ å®Œç¬¬ä¸‰æ­¥åï¼Œç‚¹å‡»ä¿å­˜</p>
<h3 id="æ‰§è¡Œä»»åŠ¡"><a href="#æ‰§è¡Œä»»åŠ¡" class="headerlink" title="æ‰§è¡Œä»»åŠ¡"></a>æ‰§è¡Œä»»åŠ¡</h3><p>1ã€è¿›å…¥ä»»åŠ¡é¡µé¢ï¼Œç‚¹å‡» â€œç«‹å³æ„å»ºâ€</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image59.png" srcset="/img/loading.gif" alt="image-20200609171946626"></p>
<p>2ã€å¼€å§‹æ„å»ºï¼ŒæŸ¥çœ‹æ—¥å¿—</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image60.png" srcset="/img/loading.gif" alt="image-20200610165006790"></p>
<p>æ„å»ºæˆåŠŸï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚</p>
<h3 id="ä½¿ç”¨Gitlabé€šçŸ¥Jenkinsè¿›è¡Œè‡ªåŠ¨éƒ¨ç½²"><a href="#ä½¿ç”¨Gitlabé€šçŸ¥Jenkinsè¿›è¡Œè‡ªåŠ¨éƒ¨ç½²" class="headerlink" title="ä½¿ç”¨Gitlabé€šçŸ¥Jenkinsè¿›è¡Œè‡ªåŠ¨éƒ¨ç½²"></a>ä½¿ç”¨Gitlabé€šçŸ¥Jenkinsè¿›è¡Œè‡ªåŠ¨éƒ¨ç½²</h3><h4 id="1ã€å®‰è£…gitlab-hookæ’ä»¶"><a href="#1ã€å®‰è£…gitlab-hookæ’ä»¶" class="headerlink" title="1ã€å®‰è£…gitlab hookæ’ä»¶"></a>1ã€å®‰è£…gitlab hookæ’ä»¶</h4><p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image61.png" srcset="/img/loading.gif" alt="image-20200610173808935"></p>
<h4 id="2ã€é…ç½®webhook"><a href="#2ã€é…ç½®webhook" class="headerlink" title="2ã€é…ç½®webhook"></a>2ã€é…ç½®webhook</h4><p>GitLab ä¸­ä½¿ç”¨ <code>webhook</code> å‘ <code>jenkins</code> é€šçŸ¥ï¼Œå½“æœ‰ä»£ç  push åå°†é€šçŸ¥ <code>jenkins</code> è¿›è¡Œæ„å»ºã€‚</p>
<p>1ã€æ–°å»ºä¸€ä¸ªä»»åŠ¡ â€œxc-eduâ€ï¼Œåœ¨ Jenkins ä¸­æ‰¾åˆ°é€šçŸ¥åœ°å€</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image62.png" srcset="/img/loading.gif" alt="image-20200607103230924"></p>
<p>2ã€è¿›å…¥Jenkinsè®¾ç½®å…è®¸åŒ¿åè®¿é—®jenkinsï¼Œè¿™æ · <code>GitLab</code> æ‰èƒ½è®¿é—®é€šçŸ¥åœ°å€å»é€šçŸ¥ <code>Jenkins</code> è¿›è¡Œå·¥ä½œ</p>
<p>è¿›å…¥åˆ°é…ç½®é¡µé¢ <a href="http://10.1.1.161:8900/configure" target="_blank" rel="noopener">http://10.1.1.161:8900/configure</a> ï¼Œå–æ¶ˆè®¤è¯çš„å‹¾é€‰ï¼Œè®¤è¯é»˜è®¤æ˜¯å¼€å¯çš„ã€‚</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image63.png" srcset="/img/loading.gif" alt="image-20200610174958486"></p>
<p>3ã€ä½¿ç”¨ç®¡ç†å‘˜å¸å· root ç™»å½• <code>Gitlab</code>ï¼Œå¯†ç å°±æ˜¯ä½  <code>gitlab</code> æ­å»ºå¥½ä¹‹åç¬¬ä¸€æ¬¡è¾“å…¥çš„å¯†ç ,è®¾ç½®å…è®¸è¯·æ±‚æœ¬åœ°ç½‘ç»œæœåŠ¡</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image64.png" srcset="/img/loading.gif" alt="image-20200607103253653"></p>
<p>4ã€è®¾ç½®é’©å­åœ°å€ï¼Œå³ <code>jenkins</code> ä¸­çš„é¡¹ç›®åœ°å€</p>
<p>è®¿é—®é¡¹ç›®çš„é…ç½®åœ°å€ <a href="http://10.1.1.161:8910/root/xc-services-project/-/settings/integrations" target="_blank" rel="noopener">http://10.1.1.161:8910/root/xc-services-project/-/settings/integrations</a></p>
<p>ç‚¹å‡»å¼€å¯webhooks</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image65.png" srcset="/img/loading.gif" alt="image-20200610175240440"></p>
<p>å°† <code>jenkins</code> çš„è§¦å‘åœ°å€è®¾ç½®åˆ° <code>gitlab</code> çš„ <code>webhooks</code> åœ°å€ä¸­ ï¼Œç‚¹å‡»æœ€ä¸‹é¢çš„æ·»åŠ å³å¯ã€‚</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image66.png" srcset="/img/loading.gif" alt="image-20200610175458275"></p>
<p>å¦‚æœå‡ºç°æ·»åŠ å¤±è´¥ï¼Œå¹¶ä¸”æ˜¾ç¤ºå¦‚ä¸‹é”™è¯¯</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image67.png" srcset="/img/loading.gif" alt="image-20200610175721074"></p>
<p>å‚è€ƒ <a href="https://blog.csdn.net/anqixiang/article/details/104968469" target="_blank" rel="noopener">https://blog.csdn.net/anqixiang/article/details/104968469</a> å³å¯è§£å†³ï¼Œå¹¶æ·»åŠ webhooksçš„ç™½åå•</p>
<blockquote>
<p>ç”±äºwebhooksçš„é’©å­æ˜¯å…è®¸åŒ¿åè®¿é—®çš„ï¼Œå»ºè®®è¿˜æ˜¯è®¾ç½®ç™½åå•æ¥æé«˜å®‰å…¨æ€§</p>
</blockquote>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image68.png" srcset="/img/loading.gif" alt="image-20200610175956666"></p>
<p>é…ç½®å®Œæˆåå†å›åˆ°ä¹‹å‰çš„æ“ä½œï¼Œæ·»åŠ webhooksçš„é’©å­åœ°å€å³å¯ï¼Œæ·»åŠ æˆåŠŸçš„æ•ˆæœå¦‚ä¸‹</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image69.png" srcset="/img/loading.gif" alt="image-20200610180136855"></p>
<h4 id="3ã€æµ‹è¯•"><a href="#3ã€æµ‹è¯•" class="headerlink" title="3ã€æµ‹è¯•"></a>3ã€æµ‹è¯•</h4><p>å°è¯•æäº¤ä¸€ä¸ªä»£ç æ›´æ–°ï¼Œè§‚å¯Ÿjenkinsæ˜¯å¦èƒ½å¤Ÿæ”¶åˆ°é€šçŸ¥å¹¶ä¸”æ‰§è¡Œæ„å»ºä»»åŠ¡</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image70.png" srcset="/img/loading.gif" alt="image-20200611151650255"></p>
<p>jenkinså¼€å§‹è‡ªåŠ¨æ„å»º</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image71.png" srcset="/img/loading.gif" alt="image-20200611151643554"></p>
<p>æ„å»ºæˆåŠŸï¼Œå¹¶è‡ªåŠ¨å¯åŠ¨å®¹å™¨</p>
<p><img src="/2020/08/31/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday20/image72.png" srcset="/img/loading.gif" alt="image-20200611152118926"></p>
<h2 id="4-æ€è€ƒä¸€äº›é—®é¢˜"><a href="#4-æ€è€ƒä¸€äº›é—®é¢˜" class="headerlink" title="4. æ€è€ƒä¸€äº›é—®é¢˜"></a>4. æ€è€ƒä¸€äº›é—®é¢˜</h2><h3 id="1ã€å¦‚ä½•å®ç°è‡ªåŠ¨æ„å»ºæŒ‡å®šçš„æœåŠ¡å·¥ç¨‹ï¼Ÿ"><a href="#1ã€å¦‚ä½•å®ç°è‡ªåŠ¨æ„å»ºæŒ‡å®šçš„æœåŠ¡å·¥ç¨‹ï¼Ÿ" class="headerlink" title="1ã€å¦‚ä½•å®ç°è‡ªåŠ¨æ„å»ºæŒ‡å®šçš„æœåŠ¡å·¥ç¨‹ï¼Ÿ"></a>1ã€å¦‚ä½•å®ç°è‡ªåŠ¨æ„å»ºæŒ‡å®šçš„æœåŠ¡å·¥ç¨‹ï¼Ÿ</h3><h4 id="éœ€æ±‚åˆ†æ-1"><a href="#éœ€æ±‚åˆ†æ-1" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h4><p>ä¾‹å¦‚æˆ‘ä»¬åœ¨æ•´ä¸ªå¾®æœåŠ¡é¡¹ç›®å½“ä¸­æœ‰Aã€Bã€Cä¸‰ä¸ªæœåŠ¡ï¼Œåœ¨ä»£ç æ›´æ–°æ—¶åªæ›´æ–°äº† <code>æœåŠ¡A</code> ç›¸å…³çš„ä»£ç ï¼Œè€Œ <code>jenkins</code> è¿›è¡Œè‡ªåŠ¨éƒ¨ç½²çš„æ—¶å€™ï¼Œåªéœ€è¦éƒ¨ç½² <code>æœåŠ¡A</code> çš„ä»£ç å³å¯ã€‚</p>
<h4 id="å®ç°æ€è·¯"><a href="#å®ç°æ€è·¯" class="headerlink" title="å®ç°æ€è·¯"></a>å®ç°æ€è·¯</h4><ul>
<li><code>Comment (regex) for triggering a build</code> ä¸å¯ç”¨ï¼Œè¯¥é€‰é¡¹åªåŒ¹é… <code>merge request</code> çš„ commit</li>
<li>Gitlab åœ¨åŒä¸€ä¸ªé¡¹ç›®é‡Œé¢æ˜¯å¦èƒ½å¤Ÿæ·»åŠ å¤šä¸ªjenkinsä»»åŠ¡é’©å­ï¼Ÿå¦‚ä½•åœ¨gitlabä¸Šå®ç°æŒ‰éœ€é€šçŸ¥</li>
</ul>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BF/">å­¦æˆåœ¨çº¿</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Docker/">Docker</a>
                    
                      <a class="hover-with-bg" href="/tags/DevOps/">DevOps</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/08/29/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday19/">
                        <span class="hidden-mobile">å­¦æˆåœ¨çº¿day19ï¼šåˆ†å¸ƒå¼äº‹åŠ¡</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
  </div>
</div>
<!--

ä»£ç å—js ç”¨ä¸åˆ°ï¼Œfulidè‡ªå¸¦æœ‰ï¼Œæ·»åŠ cssæ ·å¼å³å¯å®ç°
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>
<script type="text/javascript" src="/libs/codeBlock/clipboard.min.js"></script>

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script> 

<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>

-->




<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®å­—</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
	<div>
  <span id="timeDate">è½½å…¥å¤©æ•°...</span>
  <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>
  <script>
  var now = new Date();
  function createtime(){
      var grt= new Date("06/20/2020 00:00:00");//æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´
      now.setTime(now.getTime()+250);
      days = (now - grt ) / 1000 / 60 / 60 / 24;
      dnum = Math.floor(days);
      hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
      hnum = Math.floor(hours);
      if(String(hnum).length ==1 ){
          hnum = "0" + hnum;
      }
      minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
      mnum = Math.floor(minutes);
      if(String(mnum).length ==1 ){
                mnum = "0" + mnum;
      }
      seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
      snum = Math.round(seconds);
      if(String(snum).length ==1 ){
                snum = "0" + snum;
      }
      document.getElementById("timeDate").innerHTML = "æœ¬ç«™å‹‰å¼ºè¿è¡Œ&nbsp"+dnum+"&nbspå¤©";
      document.getElementById("times").innerHTML = hnum + "&nbspå°æ—¶&nbsp" + mnum + "&nbspåˆ†&nbsp" + snum + "&nbspç§’";
  }
  setInterval("createtime()",250);
  </script>
</div>
    
  <div class="statistics">
    
    

    
      
        <!-- ä¸è’œå­ç»Ÿè®¡PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            æ€»è®¿é—®é‡ 
            <span id="busuanzi_value_site_pv"></span>
             æ¬¡
          </span>
      
      
        <!-- ä¸è’œå­ç»Ÿè®¡UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            æ€»è®¿å®¢æ•° 
            <span id="busuanzi_value_site_uv"></span>
             äºº
          </span>
      
    
  </div>


    
  <!-- å¤‡æ¡ˆä¿¡æ¯ -->
  <div class="beian">
    <a href="http://beian.miit.gov.cn/" target="_blank"
       rel="nofollow noopener">äº¬ICPè¯20000725å·</a>
    
      <a
        href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=20000725"
        rel="nofollow noopener"
        class="beian-police"
        target="_blank"
      >
        <span class="beian-police-sep">&nbsp;|&nbsp;</span>
        
          <img src="/img/police_beian.png" srcset="/img/loading.gif" alt="police-icon" />
        
        <span>äº¬å…¬ç½‘å®‰å¤‡20000725å·</span>
      </a>
     
  </div>


    
	
  </div>
  

</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>



  
<script src="/js/custom.js"></script>




  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "å­¦æˆåœ¨çº¿day20ï¼šé¡¹ç›®éƒ¨ç½²ä¸æŒç»­é›†æˆï¼ˆDevOpsï¼‰&nbsp;",
      ],
      cursorChar: "|",
      typeSpeed: 65,
      loop: true,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
      icon: "<"
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>







  
  
    <script>
      !function (e, t, a) {
        function r() {
          for (var e = 0; e < s.length; e++) s[e].alpha <= 0 ? (t.body.removeChild(s[e].el), s.splice(e, 1)) : (s[e].y--, s[e].scale += .004, s[e].alpha -= .013, s[e].el.style.cssText = "left:" + s[e].x + "px;top:" + s[e].y + "px;opacity:" + s[e].alpha + ";transform:scale(" + s[e].scale + "," + s[e].scale + ") rotate(45deg);background:" + s[e].color + ";z-index:99999");
          requestAnimationFrame(r)
        }

        function n() {
          var t = "function" == typeof e.onclick && e.onclick;
          e.onclick = function (e) {
            t && t(), o(e)
          }
        }

        function o(e) {
          var a = t.createElement("div");
          a.className = "heart", s.push({
            el: a,
            x: e.clientX - 5,
            y: e.clientY - 5,
            scale: 1,
            alpha: 1,
            color: c()
          }), t.body.appendChild(a)
        }

        function i(e) {
          var a = t.createElement("style");
          a.type = "text/css";
          try {
            a.appendChild(t.createTextNode(e))
          } catch (t) {
            a.styleSheet.cssText = e
          }
          t.getElementsByTagName("head")[0].appendChild(a)
        }

        function c() {
          return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")"
        }

        var s = [];
        e.requestAnimationFrame = e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || function (e) {
          setTimeout(e, 1e3 / 60)
        }, i(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"), n(), r()
      }(window, document);
    </script>
  
















<script type="text/javascript"
color="107,160,220" opacity='0.7' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
