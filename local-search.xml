<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>å­¦æˆåœ¨çº¿day03</title>
    <link href="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/"/>
    <url>/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ"><a href="#ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ" class="headerlink" title="ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ"></a>ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ</h1><blockquote><p>ä¸ºäº†æ–¹ä¾¿åç»­å›é¡¾è¯¥é¡¹ç›®æ—¶èƒ½å¤Ÿæ¸…æ™°çš„çŸ¥é“æœ¬ç« èŠ‚è®²äº†å“ªäº›å†…å®¹ï¼Œå¹¶ä¸”èƒ½å¤Ÿä»è¯¥ç« èŠ‚çš„ç¬”è®°ä¸­å¾—åˆ°ä¸€äº›å¸®åŠ©ï¼Œæ‰€ä»¥åœ¨å®Œæˆæœ¬ç« èŠ‚çš„å­¦ä¹ ååœ¨æ­¤å¯¹æœ¬ç« èŠ‚æ‰€æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹è¿›è¡Œæ€»ç»“æ¦‚è¿°ã€‚</p></blockquote><p>æœ¬ç« èŠ‚ä¸ºã€å­¦æˆåœ¨çº¿ã€‘é¡¹ç›®çš„ <code>day03</code> çš„å†…å®¹</p><ul><li>ä½¿ç”¨ <code>Spring data</code> æä¾›çš„ <code>PageRequest</code> æ¨¡å—è¿›è¡Œåˆ†é¡µæŸ¥è¯¢çš„åº”ç”¨</li><li>ä½¿ç”¨ <code>Spring data</code> æä¾› <code>MongoDB</code> çš„daoæ¥å£è¿›è¡Œå‰åç«¯è”è°ƒçš„ CRUD æ“ä½œ</li><li>åŸºäº <code>VUE.JS</code> çš„å‰ç«¯æ¨¡å—åŒ–å¼€å‘</li><li>ä½¿ç”¨ç»Ÿä¸€çš„å“åº”æ¨¡å‹ã€çŠ¶æ€ç è¿›è¡Œ <code>RESTful</code> é£æ ¼çš„APIå¼€å‘</li><li>ç†Ÿæ‚‰ä½¿ç”¨ <code>Swagger</code> è¿›è¡Œæ¥å£æ–‡æ¡£çš„ç”Ÿæˆä¸æµ‹è¯•</li><li>å¼‚å¸¸å¤„ç†ä»¥åŠå¦‚ä½•è‡ªå®šä¹‰å¼‚å¸¸ï¼Œæ ¹æ®ä¸åŒçš„å¼‚å¸¸è‡ªå®šä¹‰è¿”å›çš„æ¶ˆæ¯æ ¼å¼ã€‚</li></ul><h1 id="ä¸€ã€è‡ªå®šä¹‰æ¡ä»¶æŸ¥è¯¢"><a href="#ä¸€ã€è‡ªå®šä¹‰æ¡ä»¶æŸ¥è¯¢" class="headerlink" title="ä¸€ã€è‡ªå®šä¹‰æ¡ä»¶æŸ¥è¯¢"></a>ä¸€ã€è‡ªå®šä¹‰æ¡ä»¶æŸ¥è¯¢</h1><h2 id="1-éœ€æ±‚åˆ†æ"><a href="#1-éœ€æ±‚åˆ†æ" class="headerlink" title="1. éœ€æ±‚åˆ†æ"></a>1. éœ€æ±‚åˆ†æ</h2><p>åœ¨é¡µé¢è¾“å…¥æŸ¥è¯¢æ¡ä»¶ï¼ŒæŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„é¡µé¢ä¿¡æ¯ã€‚</p><p>æŸ¥è¯¢æ¡ä»¶å¦‚ä¸‹ï¼š</p><p>ç«™ç‚¹Idï¼šç²¾ç¡®åŒ¹é…</p><p>æ¨¡æ¿Idï¼šç²¾ç¡®åŒ¹é…</p><p>é¡µé¢åˆ«åï¼šæ¨¡ç³ŠåŒ¹é…</p><h2 id="2-æœåŠ¡ç«¯"><a href="#2-æœåŠ¡ç«¯" class="headerlink" title="2.æœåŠ¡ç«¯"></a>2.æœåŠ¡ç«¯</h2><h3 id="Daoå±‚"><a href="#Daoå±‚" class="headerlink" title="Daoå±‚"></a>Daoå±‚</h3><p>ä½¿ç”¨ <code>CmsPageRepository</code> ä¸­çš„ <code>findAll(Example&lt;S&gt; var1, Pageable var2)</code> æ–¹æ³•å®ç°ï¼Œæ— éœ€å®šä¹‰ã€‚</p><h3 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h3><p>ä¸‹è¾¹æµ‹è¯•findAllæ–¹æ³•å®ç°è‡ªå®šä¹‰æ¡ä»¶æŸ¥è¯¢ï¼š</p><p>1ã€æŒ‡å®šç«™ç‚¹idã€æ¨¡æ¿idä½œä¸ºæŸ¥è¯¢æ¡ä»¶</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//è‡ªå®šä¹‰æ¡ä»¶æŸ¥è¯¢</span><span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDiyFindAll</span><span class="hljs-params">()</span></span>&#123;    <span class="hljs-comment">//ç²¾ç¡®åŒ¹é…æ¡ä»¶å€¼</span>    CmsPage cmsPage = <span class="hljs-keyword">new</span> CmsPage();    cmsPage.setSiteId(<span class="hljs-string">"5a751fab6abb5044e0d19ea1"</span>);    cmsPage.setTemplateId(<span class="hljs-string">"5a925be7b00ffc4b3c1578b5"</span>);    <span class="hljs-comment">//æ¡ä»¶åŒ¹é…å™¨,ç”¨äºæ¨¡ç³ŠåŒ¹é…</span>    ExampleMatcher matching = ExampleMatcher.matching();    <span class="hljs-comment">//æ¡ä»¶æŸ¥è¯¢å®ä¾‹</span>    Example&lt;CmsPage&gt; example = Example.of(cmsPage, matching);    <span class="hljs-comment">//åˆ†é¡µå‚æ•°</span>    <span class="hljs-keyword">int</span> page = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> size = <span class="hljs-number">20</span>;    Pageable pageable = PageRequest.of(page,size);    <span class="hljs-comment">//è°ƒç”¨dao</span>    Page&lt;CmsPage&gt; all = cmsPageRepository.findAll(example, pageable);    List&lt;CmsPage&gt; content = all.getContent();    System.out.println(content);&#125;</code></pre></div><p>æŸ¥è¯¢ç»“æœ</p><p><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image1.png" srcset="/img/loading.gif" alt></p><p>åœ¨ä¸Šé¢çš„ä»£ç åŸºç¡€ä¸Šï¼Œå¢åŠ  <code>ExampleMatcher</code> å®ä¾‹çš„ä¸€äº›å±æ€§ä½œä¸ºæ¨¡ç³ŠæŸ¥è¯¢çš„å‚æ•°ï¼Œå¢åŠ çš„ä»£ç å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs java">cmsPage.setPageAliase(<span class="hljs-string">"è¯¦ç»†"</span>);<span class="hljs-comment">//æ¡ä»¶åŒ¹é…å™¨,ç”¨äºæ¨¡ç³ŠåŒ¹é…</span>ExampleMatcher matching = ExampleMatcher.matching()       .withMatcher(<span class="hljs-string">"pageAliase"</span>,ExampleMatcher.GenericPropertyMatchers.contains());</code></pre></div><p><code>.withMatcher</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºè¦å°†å“ªä¸ªå­—æ®µè¿›è¡ŒåŒ¹é…ï¼Œç¬¬äºŒä¸ªåˆ™æ˜¯è¦ä½¿ç”¨çš„åŒ¹é…å™¨ï¼›</p><p><code>ExampleMatcher.GenericPropertyMatchers</code> æœ‰å¤šä¸ªåŒ¹é…å™¨ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ <code>.contains()</code> è¿›è¡Œæ¨¡ç³ŠåŒ¹é…</p><p><a href="https://qnoss.codeyee.com/20200704_3/image2" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image2.png" srcset="/img/loading.gif" alt="img"></a></p><h3 id="Serviceå±‚"><a href="#Serviceå±‚" class="headerlink" title="Serviceå±‚"></a>Serviceå±‚</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span>CmsPageRepository cmsPageRepository;<span class="hljs-comment">/**</span><span class="hljs-comment"> * åˆ†é¡µæŸ¥è¯¢</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> page é¡µå·</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> size æ¯é¡µå¤§å°</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> queryPageRequest æŸ¥è¯¢æ¡ä»¶</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">public</span> QueryResponseResult <span class="hljs-title">findList</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page,<span class="hljs-keyword">int</span> size,QueryPageRequest queryPageRequest)</span> </span>&#123;    <span class="hljs-comment">//åˆ¤æ–­æ¡ä»¶å¯¹è±¡æ˜¯å¦ä¸ºç©º</span>    <span class="hljs-keyword">if</span>(queryPageRequest == <span class="hljs-keyword">null</span>)&#123;        queryPageRequest = <span class="hljs-keyword">new</span> QueryPageRequest();    &#125;    <span class="hljs-comment">//åŒ¹é…æ¡ä»¶å€¼</span>    CmsPage cmsPage = <span class="hljs-keyword">new</span> CmsPage();    <span class="hljs-comment">//è®¾ç½®æ¡ä»¶å€¼</span>    <span class="hljs-comment">//ç«™ç‚¹ID</span>    <span class="hljs-keyword">if</span>(!StringUtil.isNullOrEmpty(queryPageRequest.getSiteId()))&#123;        cmsPage.setSiteId(queryPageRequest.getSiteId());    &#125;    <span class="hljs-comment">//æ¨¡æ¿ID</span>    <span class="hljs-keyword">if</span>(!StringUtil.isNullOrEmpty(queryPageRequest.getTemplateId()))&#123;        cmsPage.setTemplateId(queryPageRequest.getTemplateId());    &#125;    <span class="hljs-comment">//ç«™ç‚¹åˆ«å</span>    <span class="hljs-keyword">if</span>(!StringUtil.isNullOrEmpty(queryPageRequest.getPageAliase()))&#123;        cmsPage.setPageAliase(queryPageRequest.getPageAliase());    &#125;    <span class="hljs-comment">//æ¡ä»¶åŒ¹é…å™¨ï¼Œç”¨äºæ¨¡ç³ŠæŸ¥è¯¢</span>    ExampleMatcher exampleMatcher = ExampleMatcher.matching()            .withMatcher(<span class="hljs-string">"pageAliase"</span>, ExampleMatcher.GenericPropertyMatchers.contains());    <span class="hljs-comment">//æ¡ä»¶æŸ¥è¯¢å®ä¾‹</span>    Example&lt;CmsPage&gt; example = Example.of(cmsPage, exampleMatcher);    <span class="hljs-comment">//è¿‡æ»¤æ¡ä»¶</span>    <span class="hljs-keyword">if</span>(page &lt;= <span class="hljs-number">0</span>)&#123;        page = <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">if</span>(size &lt;= <span class="hljs-number">0</span>)&#123;        size = <span class="hljs-number">10</span>;    &#125;    page = page - <span class="hljs-number">1</span>;    <span class="hljs-comment">//åˆ›å»ºåˆ†é¡µæŸ¥è¯¢å‚æ•°</span>    PageRequest pageable = PageRequest.of(page, size);    <span class="hljs-comment">//åˆ†é¡µæŸ¥è¯¢æ•°æ®</span>    Page&lt;CmsPage&gt; all = cmsPageRepository.findAll(example, pageable);    <span class="hljs-comment">//æ•´ç†æŸ¥è¯¢åˆ°çš„æ•°æ®</span>    QueryResult queryResult = <span class="hljs-keyword">new</span> QueryResult();    queryResult.setList(all.getContent());    queryResult.setTotal(all.getTotalElements());    <span class="hljs-comment">//è¿”å›ç»“æœ</span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QueryResponseResult(CommonCode.SUCCESS,queryResult);&#125;</code></pre></div><p>Controllerå±‚æ— éœ€ä¿®æ”¹</p><h3 id="ä½¿ç”¨SwaggerUIæµ‹è¯•"><a href="#ä½¿ç”¨SwaggerUIæµ‹è¯•" class="headerlink" title="ä½¿ç”¨SwaggerUIæµ‹è¯•"></a>ä½¿ç”¨SwaggerUIæµ‹è¯•</h3><p>å‚æ•°</p><p><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image3.png" srcset="/img/loading.gif" alt="img"></p><p>æŸ¥è¯¢ç»“æœ</p><p><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image4.png" srcset="/img/loading.gif" alt="img"></p><p>ä»æŸ¥è¯¢ç»“æœä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ ¹æ®æˆ‘ä»¬è¾“å…¥çš„æ¡ä»¶ï¼ŒæŸ¥è¯¢åˆ°äº†æŒ‡å®š <code>sizeId</code> å¹¶ä¸” <code>pageAliase</code> åŒ…å«é¢„è§ˆçš„ä¿¡æ¯ã€‚</p><h2 id="3-å‰ç«¯"><a href="#3-å‰ç«¯" class="headerlink" title="3. å‰ç«¯"></a>3. å‰ç«¯</h2><h3 id="é¡µé¢"><a href="#é¡µé¢" class="headerlink" title="é¡µé¢"></a>é¡µé¢</h3><p>1ã€å¢åŠ æŸ¥è¯¢è¡¨å•</p><blockquote><p>åœ¨el-tableä¸Šæ–¹æ·»åŠ è¯¥è¡¨å•</p></blockquote><div class="hljs"><pre><code class="hljs vue">&lt;!--æŸ¥è¯¢è¡¨å•--&gt;&lt;el-form :model&#x3D;&quot;params&quot;&gt;  &lt;el-select v-model&#x3D;&quot;params.siteId&quot; placeholder&#x3D;&quot;è¯·é€‰æ‹©ç«™ç‚¹&quot;&gt;    &lt;el-option    v-for&#x3D;&quot;item in siteList&quot;    :key&#x3D;&quot;item.siteId&quot;    :label&#x3D;&quot;item.siteName&quot;    :value&#x3D;&quot;item.siteId&quot;&gt;    &lt;&#x2F;el-option&gt;  &lt;&#x2F;el-select&gt;  é¡µé¢åˆ«å: &lt;el-input v-model&#x3D;&quot;params.pageAliase&quot; style&#x3D;&quot;width: 100px&quot;&gt;&lt;&#x2F;el-input&gt;&lt;el-button type&#x3D;&quot;primary&quot; v-on:click&#x3D;&quot;query&quot; size&#x3D;&quot;small&quot;&gt;æŸ¥è¯¢&lt;&#x2F;el-button&gt;&lt;&#x2F;el-form&gt;</code></pre></div><p>2ã€æ–°å¢æ•°æ®æ¨¡å‹å¯¹è±¡</p><div class="hljs"><pre><code class="hljs js">data() &#123;  <span class="hljs-keyword">return</span> &#123;    siteList:[],<span class="hljs-comment">//ç«™ç‚¹åˆ—è¡¨</span>    list:[],    total:<span class="hljs-number">0</span>,    params:&#123;      siteId:<span class="hljs-string">''</span>,      pageAliase:<span class="hljs-string">''</span>,      page:<span class="hljs-number">1</span>,<span class="hljs-comment">//é¡µç </span>      size:<span class="hljs-number">10</span><span class="hljs-comment">//æ¯é¡µæ˜¾ç¤ºä¸ªæ•°</span>    &#125;  &#125;&#125;,</code></pre></div><p>3ã€åœ¨é’©å­æ–¹æ³•ä¸­ è·å– <code>siteList</code> ç«™ç‚¹åˆ—è¡¨ï¼ˆè¿™é‡Œæš‚æ—¶ç”¨é™æ€æ•°æ®ä»£æ›¿ï¼‰</p><div class="hljs"><pre><code class="hljs js">mounted() &#123;  <span class="hljs-comment">//é»˜è®¤æŸ¥è¯¢é¡µé¢</span>  <span class="hljs-keyword">this</span>.query()  <span class="hljs-comment">//åˆå§‹åŒ–ç«™ç‚¹åˆ—è¡¨</span>  <span class="hljs-keyword">this</span>.siteList = [    &#123;      siteId:<span class="hljs-string">'5a751fab6abb5044e0d19ea1'</span>,      siteName:<span class="hljs-string">'é—¨æˆ·ä¸»ç«™'</span>    &#125;,    &#123;      siteId:<span class="hljs-string">'102'</span>,      siteName:<span class="hljs-string">'æµ‹è¯•ç«™'</span>    &#125;  ]&#125;,</code></pre></div><h3 id="APIè°ƒç”¨"><a href="#APIè°ƒç”¨" class="headerlink" title="APIè°ƒç”¨"></a>APIè°ƒç”¨</h3><p>1ã€å‘æœåŠ¡ç«¯ä¼ é€’æŸ¥è¯¢æ¡ä»¶ï¼Œä¿®æ”¹ cms.jsï¼Œå¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//publicæ˜¯å¯¹axiosçš„å·¥å…·ç±»å°è£…ï¼Œå®šä¹‰äº†httpè¯·æ±‚æ–¹æ³•</span><span class="hljs-keyword">import</span> http from <span class="hljs-string">'./../../../base/api/public'</span>  <span class="hljs-comment">//ES6 å¯¼å…¥</span><span class="hljs-keyword">import</span> querystring from <span class="hljs-string">"querystring"</span>let sysConfig = require(<span class="hljs-string">'@/../config/sysConfig'</span>)let apiUrl = sysConfig.xcApiUrlPre<span class="hljs-comment">//é¡µé¢æŸ¥è¯¢</span>export <span class="hljs-keyword">const</span> page_list = (page,size,params) =&gt; &#123;  <span class="hljs-comment">//å°†jsonå¯¹è±¡è½¬æˆkey/valueå¯¹</span>  let queryString = querystring.stringify(params);  <span class="hljs-comment">//å®šä¹‰æ–¹æ³•ï¼Œè¯·æ±‚æœåŠ¡ç«¯æŸ¥è¯¢æ¥å£</span>  <span class="hljs-keyword">return</span> http.requestQuickGet(apiUrl + <span class="hljs-string">'/cms/page/list/'</span>+page+<span class="hljs-string">'/'</span>+ size +<span class="hljs-string">'?'</span> + queryString)&#125;</code></pre></div><p>2ã€é¡µé¢è°ƒç”¨apiæ–¹æ³•</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//æŸ¥è¯¢</span>query:function () &#123;  <span class="hljs-comment">//è°ƒç”¨æœåŠ¡ç«¯æ¥å£</span>  cmsApi.page_list(<span class="hljs-keyword">this</span>.params.page, <span class="hljs-keyword">this</span>.params.size, <span class="hljs-keyword">this</span>.params).then((res) =&gt;&#123;    console.log(res)    <span class="hljs-comment">//å°†resç»“æœæ•°æ®èµ‹å€¼ç»™æ•°æ®æ¨¡å‹å¯¹è±¡</span>    <span class="hljs-keyword">this</span>.list = res.queryResult.list    <span class="hljs-keyword">this</span>.total = res.queryResult.total  &#125;)&#125;</code></pre></div><p>3ã€æµ‹è¯•</p><p><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image5.png" srcset="/img/loading.gif" alt="img"></p><h1 id="äºŒã€æ–°å¢é¡µé¢"><a href="#äºŒã€æ–°å¢é¡µé¢" class="headerlink" title="äºŒã€æ–°å¢é¡µé¢"></a>äºŒã€æ–°å¢é¡µé¢</h1><h2 id="1-å‡†å¤‡å·¥ä½œï¼Œé¡µé¢ç®¡ç†API"><a href="#1-å‡†å¤‡å·¥ä½œï¼Œé¡µé¢ç®¡ç†API" class="headerlink" title="1.å‡†å¤‡å·¥ä½œï¼Œé¡µé¢ç®¡ç†API"></a>1.å‡†å¤‡å·¥ä½œï¼Œé¡µé¢ç®¡ç†API</h2><p>åœ¨é…ç½®æ–°å¢é¡µé¢çš„åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆé…ç½®ä¸€ä¸ªæ¥å£ï¼Œç”¨äºè·å–é¡µé¢çš„ä¿¡æ¯</p><h3 id="Daoå±‚-1"><a href="#Daoå±‚-1" class="headerlink" title="Daoå±‚"></a>Daoå±‚</h3><p>CmsPageRepository</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * ç»§æ‰¿MongoDBè‡ªå¸¦çš„Repository</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.JK</span><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-08-06  22:36</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CmsPageRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MongoRepository</span>&lt;<span class="hljs-title">CmsPage</span>,<span class="hljs-title">String</span>&gt; </span>&#123;&#125;</code></pre></div><h3 id="å®šä¹‰æŸ¥è¯¢æ¨¡å‹"><a href="#å®šä¹‰æŸ¥è¯¢æ¨¡å‹" class="headerlink" title="å®šä¹‰æŸ¥è¯¢æ¨¡å‹"></a>å®šä¹‰æŸ¥è¯¢æ¨¡å‹</h3><p>QueryPageRequest</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.framework.domain.cms.request;<span class="hljs-keyword">import</span> io.swagger.annotations.ApiModelProperty;<span class="hljs-keyword">import</span> lombok.Data;<span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.JK</span><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-08-06  21:13</span><span class="hljs-comment"> */</span><span class="hljs-meta">@Data</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QueryPageRequest</span> </span>&#123;    <span class="hljs-comment">//æ¥æ”¶é¡µé¢æŸ¥è¯¢çš„æŸ¥è¯¢æ¡ä»¶</span>    <span class="hljs-comment">//ç«™ç‚¹id</span>    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"ç«™ç‚¹id"</span>)    <span class="hljs-keyword">private</span> String siteId;    <span class="hljs-comment">//é¡µé¢id</span>    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"é¡µé¢id"</span>)    <span class="hljs-keyword">private</span> String pageId;    <span class="hljs-comment">//é¡µé¢åç§°</span>    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"é¡µé¢åç§°"</span>)    <span class="hljs-keyword">private</span> String pageName;    <span class="hljs-comment">//åˆ«å</span>    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"åˆ«å"</span>)    <span class="hljs-keyword">private</span> String pageAliase;    <span class="hljs-comment">//æ¨¡æ¿id</span>    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"æ¨¡æ¿id"</span>)    <span class="hljs-keyword">private</span> String templateId;    <span class="hljs-comment">//...</span>&#125;</code></pre></div><h3 id="å®šä¹‰å“åº”æ¨¡å‹"><a href="#å®šä¹‰å“åº”æ¨¡å‹" class="headerlink" title="å®šä¹‰å“åº”æ¨¡å‹"></a>å®šä¹‰å“åº”æ¨¡å‹</h3><p>CmsPageResult</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CmsPageResult</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ResponseResult</span> </span>&#123;    CmsPage cmsPage;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CmsPageResult</span><span class="hljs-params">(ResultCode resultCode,CmsPage cmsPage)</span> </span>&#123;        <span class="hljs-keyword">super</span>(resultCode);        <span class="hljs-keyword">this</span>.cmsPage = cmsPage;    &#125;&#125;</code></pre></div><h3 id="Serviceå±‚-1"><a href="#Serviceå±‚-1" class="headerlink" title="Serviceå±‚"></a>Serviceå±‚</h3><p>PageService</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PageService</span> </span>&#123;    <span class="hljs-meta">@Autowired</span>    CmsPageRepository cmsPageRepository;    &#125;</code></pre></div><h3 id="Controllerå±‚"><a href="#Controllerå±‚" class="headerlink" title="Controllerå±‚"></a>Controllerå±‚</h3><p>å®šä¹‰é¡µé¢ç›¸å…³æ“ä½œçš„api</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.JK</span><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-08-06  21:16</span><span class="hljs-comment"> */</span><span class="hljs-meta">@Api</span>(value = <span class="hljs-string">"cmsé¡µé¢ç®¡ç†æ¥å£"</span>,description = <span class="hljs-string">"cmsé¡µé¢ç®¡ç†æ¥å£ï¼Œæä¾›é¡µé¢çš„å¢ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥"</span>)<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CmsPageControllerApi</span> </span>&#123;    <span class="hljs-comment">//é¡µé¢æŸ¥è¯¢</span>    <span class="hljs-meta">@ApiOperation</span>(<span class="hljs-string">"åˆ†é¡µæŸ¥è¯¢é¡µé¢åˆ—è¡¨"</span>)    <span class="hljs-meta">@ApiImplicitParams</span>(&#123;            <span class="hljs-meta">@ApiImplicitParam</span>(name = <span class="hljs-string">"page"</span>,value = <span class="hljs-string">"é¡µç "</span>,required = <span class="hljs-keyword">true</span>,paramType = <span class="hljs-string">"path"</span>,dataType = <span class="hljs-string">"int"</span>),            <span class="hljs-meta">@ApiImplicitParam</span>(name = <span class="hljs-string">"size"</span>,value = <span class="hljs-string">"æ¯é¡µè®°å½•æ•°"</span>,required = <span class="hljs-keyword">true</span>,paramType = <span class="hljs-string">"path"</span>,dataType = <span class="hljs-string">"int"</span>)    &#125;)    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResponseResult <span class="hljs-title">findList</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size, QueryPageRequest queryPageRequest)</span></span>; &#125;</code></pre></div><p>CmsPageController</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.manage_cms.controller;<span class="hljs-keyword">import</span> com.xuecheng.api.cms.CmsPageControllerApi;<span class="hljs-keyword">import</span> com.xuecheng.framework.domain.cms.CmsPage;<span class="hljs-keyword">import</span> com.xuecheng.framework.domain.cms.request.QueryPageRequest;<span class="hljs-keyword">import</span> com.xuecheng.framework.domain.cms.response.CmsPageResult;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.QueryResponseResult;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.ResponseResult;<span class="hljs-keyword">import</span> com.xuecheng.manage_cms.service.PageService;<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;<span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.JK</span><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-08-06  22:04</span><span class="hljs-comment"> */</span><span class="hljs-meta">@RestController</span><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">"/cms/page"</span>)<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CmsPageController</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CmsPageControllerApi</span> </span>&#123;    <span class="hljs-meta">@Autowired</span>    PageService pageService;        <span class="hljs-meta">@Override</span>    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/list/&#123;page&#125;/&#123;size&#125;"</span>)    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResponseResult <span class="hljs-title">findList</span><span class="hljs-params">(@PathVariable(<span class="hljs-string">"page"</span>)</span> <span class="hljs-keyword">int</span> page, </span><span class="hljs-function">               @<span class="hljs-title">PathVariable</span><span class="hljs-params">(<span class="hljs-string">"size"</span>)</span> <span class="hljs-keyword">int</span> size, QueryPageRequest queryPageRequest) </span>&#123;                   QueryResponseResult responseResult = pageService.findList(page, size, queryPageRequest);        <span class="hljs-keyword">return</span> responseResult;    &#125;</code></pre></div><p>æµ‹è¯•</p><p><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image6.png" srcset="/img/loading.gif" alt="img"></p><p><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image7.png" srcset="/img/loading.gif" alt="img"></p><h2 id="2-åç«¯æ¥å£å®šä¹‰"><a href="#2-åç«¯æ¥å£å®šä¹‰" class="headerlink" title="2.åç«¯æ¥å£å®šä¹‰"></a>2.åç«¯æ¥å£å®šä¹‰</h2><h3 id="1ã€å®šä¹‰å“åº”æ¨¡å‹"><a href="#1ã€å®šä¹‰å“åº”æ¨¡å‹" class="headerlink" title="1ã€å®šä¹‰å“åº”æ¨¡å‹"></a>1ã€å®šä¹‰å“åº”æ¨¡å‹</h3><blockquote><p>ç”¨äºæ¥å£çš„å“åº”è§„èŒƒï¼Œç»§æ‰¿äºé¡¹ç›®ä¸­çš„ResponseResult</p></blockquote><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CmsPageResult</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ResponseResult</span> </span>&#123;    CmsPage cmsPage;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CmsPageResult</span><span class="hljs-params">(ResultCode resultCode,CmsPage cmsPage)</span> </span>&#123;        <span class="hljs-keyword">super</span>(resultCode);        <span class="hljs-keyword">this</span>.cmsPage = cmsPage;&#125;&#125;</code></pre></div><h3 id="2ã€å®šä¹‰æ·»åŠ Api"><a href="#2ã€å®šä¹‰æ·»åŠ Api" class="headerlink" title="2ã€å®šä¹‰æ·»åŠ Api"></a>2ã€å®šä¹‰æ·»åŠ Api</h3><p>åœ¨ <code>CmsPageControllerApi</code> ä¸­æ–°å¢ <code>addCmsPage</code> æ¥å£</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * æ·»åŠ é¡µé¢æ•°æ®</span><span class="hljs-comment"> */</span><span class="hljs-meta">@ApiOperation</span>(<span class="hljs-string">"æ·»åŠ é¡µé¢æ•°æ®"</span>)<span class="hljs-meta">@ApiImplicitParams</span>(&#123;        <span class="hljs-meta">@ApiImplicitParam</span>(name=<span class="hljs-string">"cmsPage"</span>,value = <span class="hljs-string">"è¯·æäº¤jsonå½¢å¼çš„é¡µé¢æ•°æ®"</span>,required=<span class="hljs-keyword">true</span>,paramType=<span class="hljs-string">"CmsPage"</span>,dataType=<span class="hljs-string">"CmsPage"</span>),&#125;)<span class="hljs-function"><span class="hljs-keyword">public</span> CmsPageResult <span class="hljs-title">addCmsPage</span><span class="hljs-params">(CmsPage cmsPage)</span></span>;</code></pre></div><h2 id="3-æœåŠ¡ç«¯å¼€å‘"><a href="#3-æœåŠ¡ç«¯å¼€å‘" class="headerlink" title="3. æœåŠ¡ç«¯å¼€å‘"></a>3. æœåŠ¡ç«¯å¼€å‘</h2><h3 id="1ã€é¡µé¢å”¯ä¸€å€¼ç´¢å¼•"><a href="#1ã€é¡µé¢å”¯ä¸€å€¼ç´¢å¼•" class="headerlink" title="1ã€é¡µé¢å”¯ä¸€å€¼ç´¢å¼•"></a>1ã€é¡µé¢å”¯ä¸€å€¼ç´¢å¼•</h3><blockquote><p>ä¸ºäº†ä¿è¯ç«™ç‚¹çš„å”¯ä¸€æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ ¹æ® sizeIdã€pageNameã€pageWebPath è¿™ä¸‰ä¸ªå­—æ®µæ¥å†³å®šç«™ç‚¹çš„æ•°æ®æ˜¯å¦å”¯ä¸€ã€‚</p></blockquote><p>å³é”® <code>cms_page</code> é›†åˆï¼Œé€‰æ‹© <code>Add Index</code> æ·»åŠ ä¸€ä¸ªç´¢å¼•</p><p><a href="https://qnoss.codeyee.com/20200704_3/image8" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image8.png" srcset="/img/loading.gif" alt="img"></a></p><p>æ ¹æ®ä¸‹å›¾æ‰€ç¤ºï¼Œç‚¹å‡» <code>Add Field</code> æŒ‰é’®ï¼Œé€‰æ‹© sizeIdã€pageNameã€pageWebPath è¿™ä¸‰ä¸ªå­—æ®µï¼Œç„¶åç‚¹å‡»æ·»åŠ ï¼Œé€‰æ‹©ç¬¬ä¸‰æ­¥æ‰€ç¤ºçš„ <code>Unique</code>ï¼Œæœ€åç‚¹å‡»å³è¾¹çš„ <code>Create Index</code> åˆ›å»ºç´¢å¼•ã€‚</p><p><a href="https://qnoss.codeyee.com/20200704_3/image9" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image9.png" srcset="/img/loading.gif" alt="img"></a></p><p>åˆ›å»ºæˆåŠŸå</p><p><a href="https://qnoss.codeyee.com/20200704_3/image10" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image10.png" srcset="/img/loading.gif" alt="img"></a></p><h3 id="2ã€Daoå±‚"><a href="#2ã€Daoå±‚" class="headerlink" title="2ã€Daoå±‚"></a>2ã€Daoå±‚</h3><p>1ã€æ·»åŠ æ ¹æ®é¡µé¢åç§°ã€ç«™ç‚¹Idã€é¡µé¢webpathæŸ¥è¯¢é¡µé¢æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ç”¨äºæ ¡éªŒé¡µé¢æ˜¯å¦å­˜åœ¨</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * æ ¹æ®ç«™ç‚¹idã€ç«™ç‚¹åç§°ã€ç«™ç‚¹è·¯å¾„æ¥æŸ¥è¯¢ç«™ç‚¹ä¿¡æ¯</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> siteId</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> pageName</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> pageWebPath</span><span class="hljs-comment"> */</span><span class="hljs-function">CmsPage <span class="hljs-title">findBySiteIdAndPageNameAndPageWebPath</span><span class="hljs-params">(String siteId, String pageName, String pageWebPath)</span></span>;</code></pre></div><p>2ã€ä½¿ç”¨ CmsPageRepositoryæä¾›çš„saveæ–¹æ³• ã€‚</p><h3 id="3ã€Serviceå±‚"><a href="#3ã€Serviceå±‚" class="headerlink" title="3ã€Serviceå±‚"></a>3ã€Serviceå±‚</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * æ·»åŠ é¡µé¢æ•°æ®</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">public</span> CmsPageResult <span class="hljs-title">addCmsPage</span><span class="hljs-params">(CmsPage cmsPage)</span></span>&#123;    <span class="hljs-comment">//éªŒè¯æ•°æ®å”¯ä¸€æ€§ï¼šsizeIdã€pageNameã€pageWebPath</span>    CmsPage cmsPage1 = cmsPageRepository.findBySiteIdAndPageNameAndPageWebPath(cmsPage.getSiteId(), cmsPage.getPageName(), cmsPage.getPageWebPath());    <span class="hljs-keyword">if</span>(cmsPage1 == <span class="hljs-keyword">null</span>)&#123;        <span class="hljs-comment">//ç«™ç‚¹idç”±mongoDBè‡ªåŠ¨ç”Ÿæˆï¼Œé˜²æ­¢å‰ç«¯ä¼ å€¼</span>        cmsPage.setPageId(<span class="hljs-keyword">null</span>);        CmsPage save = cmsPageRepository.save(cmsPage);        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CmsPageResult(CommonCode.SUCCESS,save);    &#125;    <span class="hljs-comment">//æ·»åŠ å¤±è´¥</span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CmsPageResult(CommonCode.FAIL,cmsPage);&#125;</code></pre></div><h3 id="4ã€Controllerå±‚"><a href="#4ã€Controllerå±‚" class="headerlink" title="4ã€Controllerå±‚"></a>4ã€Controllerå±‚</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><span class="hljs-meta">@PostMapping</span>(<span class="hljs-string">"/add"</span>)<span class="hljs-function"><span class="hljs-keyword">public</span> CmsPageResult <span class="hljs-title">addCmsPage</span><span class="hljs-params">(@RequestBody CmsPage cmsPage)</span> </span>&#123;    <span class="hljs-keyword">return</span> pageService.addCmsPage(cmsPage);&#125;</code></pre></div><h3 id="5ã€æ¥å£æµ‹è¯•"><a href="#5ã€æ¥å£æµ‹è¯•" class="headerlink" title="5ã€æ¥å£æµ‹è¯•"></a>5ã€æ¥å£æµ‹è¯•</h3><p>æˆ‘ä»¬åœ¨ <code>swagger</code> è‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£æ¥å£ä¸­è¿›è¡Œæµ‹è¯•</p><p><a href="https://qnoss.codeyee.com/20200704_3/image11" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image11.png" srcset="/img/loading.gif" alt="img"></a></p><p>ç¬¬ä¸€æ¬¡æ·»åŠ ï¼Œæ·»åŠ æˆåŠŸ</p><p><a href="https://qnoss.codeyee.com/20200704_3/image12" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image12.png" srcset="/img/loading.gif" alt="img"></a></p><p>ç¬¬äºŒæ¬¡æ·»åŠ é‡å¤çš„å†…å®¹ï¼Œç”±äºå”¯ä¸€æ€§çš„æ•ˆéªŒï¼Œè¿”å›æ·»åŠ å¤±è´¥</p><p><a href="https://qnoss.codeyee.com/20200704_3/image13" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image13.png" srcset="/img/loading.gif" alt="img"></a></p><h2 id="4-å‰ç«¯å¼€å‘"><a href="#4-å‰ç«¯å¼€å‘" class="headerlink" title="4. å‰ç«¯å¼€å‘"></a>4. å‰ç«¯å¼€å‘</h2><h3 id="æ„å»ºæ–°å¢é¡µé¢"><a href="#æ„å»ºæ–°å¢é¡µé¢" class="headerlink" title="æ„å»ºæ–°å¢é¡µé¢"></a>æ„å»ºæ–°å¢é¡µé¢</h3><h4 id="1ã€é¡µé¢åˆ›å»º"><a href="#1ã€é¡µé¢åˆ›å»º" class="headerlink" title="1ã€é¡µé¢åˆ›å»º"></a>1ã€é¡µé¢åˆ›å»º</h4><p>ä½¿ç”¨Element-UIçš„formç»„ä»¶ç¼–å†™æ·»åŠ è¡¨å•å†…å®¹ï¼Œé¡µé¢æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image14.png" srcset="/img/loading.gif" alt="img"></p><p><strong>1ï¼‰åˆ›å»ºé¡µé¢</strong></p><p>åˆ›å»ºpage_add.vueé¡µé¢</p><p><strong>2ï¼‰é…ç½®è·¯ç”±</strong></p><p>åœ¨cmsæ¨¡å—çš„è·¯ç”±æ–‡ä»¶ä¸­é…ç½®â€œæ·»åŠ é¡µé¢â€çš„è·¯ç”±ï¼š</p><div class="hljs"><pre><code class="hljs vue">&#123;path:&#39;&#x2F;cms&#x2F;page&#x2F;add&#39;,name:&#39;æ–°å¢é¡µé¢&#39;,component: page_add,hidden:true&#125;</code></pre></div><p>æ³¨æ„ï¼šç”±äº â€œæ·»åŠ é¡µé¢â€ ä¸éœ€è¦æ˜¾ç¤ºä¸ºä¸€ä¸ªèœå•ï¼Œè¿™é‡Œ <code>hidden</code> è®¾ç½®ä¸º <code>true</code> éšè—èœå•ã€‚</p><p>æµ‹è¯•ï¼Œåœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥<a href="http://localhost:11000/#/cms/page/add" target="_blank" rel="noopener">http://localhost:11000/#/cms/page/add</a></p><p><strong>3ï¼‰â€œæ·»åŠ é¡µé¢â€ çš„æŒ‰é’®</strong></p><p>å®é™…æƒ…å†µæ˜¯ç”¨æˆ·è¿›å…¥é¡µé¢æŸ¥è¯¢åˆ—è¡¨ï¼Œç‚¹å‡»â€œæ–°å¢é¡µé¢â€æŒ‰é’®è¿›å…¥æ–°å¢é¡µé¢çª—å£ã€‚</p><p>åœ¨æŸ¥è¯¢æŒ‰é’®çš„æ—è¾¹æ·»åŠ ï¼š</p><div class="hljs"><pre><code class="hljs vue">&lt;routerâ€link class&#x3D;&quot;muiâ€tabâ€item&quot; :to&#x3D;&quot;&#123;path:&#39;&#x2F;cms&#x2F;page&#x2F;add&#x2F;&#39;&#125;&quot;&gt;&lt;elâ€button type&#x3D;&quot;primary&quot; size&#x3D;&quot;small&quot;&gt;æ–°å¢é¡µé¢&lt;&#x2F;elâ€button&gt;&lt;&#x2F;routerâ€link&gt;</code></pre></div><blockquote><p>router-linkæ˜¯vueæä¾›çš„è·¯ç”±åŠŸèƒ½ï¼Œç”¨äºåœ¨é¡µé¢ç”Ÿæˆè·¯ç”±é“¾æ¥ï¼Œæœ€ç»ˆåœ¨htmlæ¸²æŸ“åå°±æ˜¯&lt;aæ ‡ç­¾ã€‚<br>toï¼šç›®æ ‡è·¯ç”±åœ°å€</p></blockquote><p><strong>4ï¼‰å®Œå–„é¡µé¢å†…å®¹</strong></p><div class="hljs"><pre><code class="hljs vue">&lt;el-form :model&#x3D;&quot;pageForm&quot; label-width&#x3D;&quot;80px&quot;&gt;  &lt;el-form-item label&#x3D;&quot;æ‰€å±ç«™ç‚¹&quot; prop&#x3D;&quot;siteId&quot;&gt;    &lt;el-select v-model&#x3D;&quot;pageForm.siteId&quot; placeholder&#x3D;&quot;è¯·é€‰æ‹©ç«™ç‚¹&quot;&gt;      &lt;el-option        v-for&#x3D;&quot;item in siteList&quot;        :key&#x3D;&quot;item.siteId&quot;        :label&#x3D;&quot;item.siteName&quot;        :value&#x3D;&quot;item.siteId&quot;&gt;      &lt;&#x2F;el-option&gt;    &lt;&#x2F;el-select&gt;  &lt;&#x2F;el-form-item&gt;  &lt;el-form-item label&#x3D;&quot;é€‰æ‹©æ¨¡ç‰ˆ&quot; prop&#x3D;&quot;templateId&quot;&gt;    &lt;el-select v-model&#x3D;&quot;pageForm.templateId&quot; placeholder&#x3D;&quot;è¯·é€‰æ‹©&quot;&gt;      &lt;el-option        v-for&#x3D;&quot;item in templateList&quot;        :key&#x3D;&quot;item.templateId&quot;        :label&#x3D;&quot;item.templateName&quot;        :value&#x3D;&quot;item.templateId&quot;&gt;      &lt;&#x2F;el-option&gt;    &lt;&#x2F;el-select&gt;  &lt;&#x2F;el-form-item&gt;  &lt;el-form-item label&#x3D;&quot;é¡µé¢åç§°&quot; prop&#x3D;&quot;pageName&quot;&gt;    &lt;el-input v-model&#x3D;&quot;pageForm.pageName&quot; auto-complete&#x3D;&quot;off&quot;&gt;&lt;&#x2F;el-input&gt;  &lt;&#x2F;el-form-item&gt;  &lt;el-form-item label&#x3D;&quot;åˆ«å&quot; prop&#x3D;&quot;pageAliase&quot;&gt;    &lt;el-input v-model&#x3D;&quot;pageForm.pageAliase&quot; auto-complete&#x3D;&quot;off&quot;&gt;&lt;&#x2F;el-input&gt;  &lt;&#x2F;el-form-item&gt;  &lt;el-form-item label&#x3D;&quot;è®¿é—®è·¯å¾„&quot; prop&#x3D;&quot;pageWebPath&quot;&gt;    &lt;el-input v-model&#x3D;&quot;pageForm.pageWebPath&quot; auto-complete&#x3D;&quot;off&quot;&gt;&lt;&#x2F;el-input&gt;  &lt;&#x2F;el-form-item&gt;  &lt;el-form-item label&#x3D;&quot;ç‰©ç†è·¯å¾„&quot; prop&#x3D;&quot;pagePhysicalPath&quot;&gt;    &lt;el-input v-model&#x3D;&quot;pageForm.pagePhysicalPath&quot; auto-complete&#x3D;&quot;off&quot;&gt;&lt;&#x2F;el-input&gt;  &lt;&#x2F;el-form-item&gt;  &lt;el-form-item label&#x3D;&quot;ç±»å‹&quot;&gt;    &lt;el-radio-group v-model&#x3D;&quot;pageForm.pageType&quot;&gt;      &lt;el-radio label&#x3D;&quot;0&quot;&gt;é™æ€&lt;&#x2F;el-radio&gt;      &lt;el-radio label&#x3D;&quot;1&quot;&gt;åŠ¨æ€&lt;&#x2F;el-radio&gt;    &lt;&#x2F;el-radio-group&gt;  &lt;&#x2F;el-form-item&gt;  &lt;el-form-item label&#x3D;&quot;åˆ›å»ºæ—¶é—´&quot;&gt;    &lt;el-date-picker type&#x3D;&quot;datetime&quot; placeholder&#x3D;&quot;åˆ›å»ºæ—¶é—´&quot; v-model&#x3D;&quot;pageForm.pageCreateTime&quot;&gt;    &lt;&#x2F;el-date-picker&gt;  &lt;&#x2F;el-form-item&gt;&lt;&#x2F;el-form&gt;&lt;div slot&#x3D;&quot;footer&quot; class&#x3D;&quot;dialog-footer&quot;&gt;  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;addSubmit&quot;&gt;æäº¤&lt;&#x2F;el-button&gt;&lt;&#x2F;div&gt;</code></pre></div><p>Form Attributesè¯´æ˜ï¼š</p><ul><li>model è¡¨å•æ•°æ®å¯¹è±¡</li><li>rules è¡¨å•éªŒè¯è§„åˆ™</li></ul><p>Form-Item Attributesè¯´æ˜ï¼š</p><ul><li>prop è¡¨å•åŸŸ model å­—æ®µï¼Œåœ¨ä½¿ç”¨ validateã€resetFields æ–¹æ³•çš„æƒ…å†µä¸‹ï¼Œè¯¥å±æ€§æ˜¯å¿…å¡«çš„</li><li>label æ ‡ç­¾æ–‡æœ¬</li></ul><p>è¯¦æƒ…å±æ€§åŠäº‹ä»¶å‚è€ƒ <a href="http://element.eleme.io/#/zh-CN/component/form" target="_blank" rel="noopener">http://element.eleme.io/#/zh-CN/component/form</a></p><p><strong>5ï¼‰æ•°æ®å¯¹è±¡</strong></p><div class="hljs"><pre><code class="hljs js">  <span class="hljs-comment">//ç«™ç‚¹åˆ—è¡¨</span>    siteList: [],    <span class="hljs-comment">//æ¨¡ç‰ˆåˆ—è¡¨</span>    templateList: [],    <span class="hljs-comment">//æ–°å¢ç•Œé¢æ•°æ®</span>    pageForm: &#123;      siteId: <span class="hljs-string">''</span>,      templateId: <span class="hljs-string">''</span>,      pageName: <span class="hljs-string">''</span>,      pageAliase: <span class="hljs-string">''</span>,      pageWebPath: <span class="hljs-string">''</span>,      pageParameter: <span class="hljs-string">''</span>,      pagePhysicalPath: <span class="hljs-string">''</span>,      pageType: <span class="hljs-string">'0'</span>,  <span class="hljs-comment">//é»˜è®¤é€‰ä¸­0</span>      pageCreateTime: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()    &#125;  &#125;&#125;,methods: &#123;  addSubmit() &#123;    alert(<span class="hljs-string">"æäº¤"</span>)  &#125;,&#125;</code></pre></div><p><strong>6ï¼‰ç«™ç‚¹åŠæ¨¡æ¿æ•°æ®</strong></p><p>å®šä¹‰è¯·æ±‚api</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//è·å–æ‰€æœ‰ç«™ç‚¹ä¿¡æ¯</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> site_list = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>&#123;  <span class="hljs-keyword">return</span> http.requestGet(apiUrl + <span class="hljs-string">"/cms/site/list"</span>)&#125;<span class="hljs-comment">//è·å–æ‰€æœ‰æ¨¡æ¿ä¿¡æ¯</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> template_list = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>&#123;  <span class="hljs-keyword">return</span> http.requestGet(apiUrl + <span class="hljs-string">"/cms/template/list"</span>)&#125;</code></pre></div><blockquote><p>åœ¨createdé’©å­ä¸­å®šä¹‰ï¼ŒåŸè®²ä¹‰å†…ä½¿ç”¨çš„æ˜¯é™æ€æ•°æ®</p></blockquote><div class="hljs"><pre><code class="hljs js">created: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-comment">//åˆå§‹åŒ–ç«™ç‚¹æ•°æ®</span>    cmsApi.site_list().then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;        <span class="hljs-keyword">if</span> (res.success) &#123;            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"ç«™ç‚¹æ•°æ®"</span>,res)            <span class="hljs-comment">//èµ‹å€¼ç»™ç«™ç‚¹ä¿¡æ¯åˆ—è¡¨</span>            <span class="hljs-keyword">this</span>.siteList = res.queryResult.list        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"è·å–ç«™ç‚¹ä¿¡æ¯æ—¶å‘ç”Ÿäº†é”™è¯¯"</span>, res)        &#125;    &#125;)    <span class="hljs-comment">//åˆå§‹åŒ–æ¨¡æ¿æ•°æ®</span>    cmsApi.template_list().then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;        <span class="hljs-keyword">if</span> (res.success) &#123;            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"æ¨¡æ¿æ•°æ®"</span>,res)            <span class="hljs-comment">//èµ‹å€¼ç»™æ¨¡æ¿åˆ—è¡¨</span>            <span class="hljs-keyword">this</span>.templateList = res.queryResult.list        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"è·å–æ¨¡æ¿ä¿¡æ¯æ—¶å‘ç”Ÿäº†é”™è¯¯"</span>, res)        &#125;    &#125;)&#125;,</code></pre></div><p><strong>7ï¼‰æµ‹è¯•é¢„è§ˆ</strong></p><p><a href="https://qnoss.codeyee.com/20200704_3/image15" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image15.png" srcset="/img/loading.gif" alt="img"></a></p><h4 id="2ã€æ·»åŠ è¿”å›"><a href="#2ã€æ·»åŠ è¿”å›" class="headerlink" title="2ã€æ·»åŠ è¿”å›"></a>2ã€æ·»åŠ è¿”å›</h4><blockquote><p>è¿›å…¥æ–°å¢é¡µé¢ååªèƒ½é€šè¿‡èœå•å†æ¬¡è¿›å…¥é¡µé¢åˆ—è¡¨ï¼Œå¯ä»¥åœ¨æ–°å¢é¡µé¢æ·»åŠ â€œè¿”å›â€æŒ‰é’®ï¼Œç‚¹å‡»è¿”å›æŒ‰é’®è¿”å›åˆ°é¡µé¢åˆ—è¡¨ã€‚</p></blockquote><ol><li>æ–°å¢é¡µé¢æŒ‰é’®å¸¦ä¸Šå‚æ•°</li></ol><div class="hljs"><pre><code class="hljs vue">&lt;router-link class&#x3D;&quot;mui-tab-item&quot;             :to&#x3D;&quot;&#123;path:&#39;&#x2F;cms&#x2F;page&#x2F;add&#x2F;&#39;, query:&#123; page:this.params.page,siteId:this.params.siteId &#125;&#125;&quot;&gt;  &lt;el-button type&#x3D;&quot;primary&quot; size&#x3D;&quot;small&quot;&gt;æ–°å¢é¡µé¢&lt;&#x2F;el-button&gt;&lt;&#x2F;router-link&gt;</code></pre></div><p>è¯´æ˜ï¼šqueryè¡¨ç¤ºåœ¨è·¯ç”±urlä¸Šå¸¦ä¸Šå‚æ•°</p><p>2ï¼‰å®šä¹‰è¿”å›æ–¹æ³•</p><p>åœ¨page_add.vueä¸Šå®šä¹‰è¿”å›æŒ‰é’®</p><div class="hljs"><pre><code class="hljs vue">&lt;elâ€button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;go_back&quot; &gt;è¿”å›&lt;&#x2F;elâ€button&gt;</code></pre></div><p>åœ¨page_add.vueä¸Šå®šä¹‰è¿”å›æ–¹æ³•</p><div class="hljs"><pre><code class="hljs js">go_back()&#123;    <span class="hljs-keyword">this</span>.$router.push(&#123;        path: <span class="hljs-string">'/cms/page/list'</span>, <span class="hljs-attr">query</span>: &#123;        page: <span class="hljs-keyword">this</span>.$route.query.page,        siteId:<span class="hljs-keyword">this</span>.$route.query.siteId    &#125;    &#125;)&#125;</code></pre></div><p>è¯´æ˜ï¼šthis.$route.query è¡¨ç¤ºå–å‡ºè·¯ç”±ä¸Šçš„å‚æ•°åˆ—è¡¨ï¼Œæœ‰ä¸¤ä¸ªå–è·¯ç”±å‚æ•°çš„æ–¹æ³•ï¼š</p><blockquote><p>aã€é€šè¿‡åœ¨è·¯ç”±ä¸Šæ·»åŠ  key/value ä¸²ä½¿ç”¨ <code>this.$route.query</code> æ¥å–å‚æ•°ï¼Œä¾‹å¦‚ï¼š<code>/router1?id=123</code> , <code>/router1?id=456</code> å¯ä»¥é€šè¿‡ <code>this.$route.query.id</code> è·å–å‚æ•°idçš„å€¼ã€‚</p><p>bã€é€šè¿‡å°†å‚æ•°ä½œä¸ºè·¯ç”±ä¸€éƒ¨åˆ†è¿›è¡Œä¼ å‚æ•°ä½¿ç”¨ <code>this.$route.params</code> æ¥è·å–ï¼Œä¾‹å¦‚ï¼šå®šä¹‰çš„è·¯ç”±ä¸º <code>/router1/:id</code> ï¼Œè¯·æ±‚ <code>/router1/123</code> æ—¶å¯ä»¥é€šè¿‡ <code>this.$route.params.id</code> æ¥è·å–ï¼Œæ­¤ç§æƒ…å†µç”¨ <code>this.$route.query.id</code> æ˜¯æ‹¿ä¸åˆ°çš„ã€‚</p></blockquote><p>3ï¼‰æŸ¥è¯¢åˆ—è¡¨æ”¯æŒå›æ˜¾</p><p>è¿›å…¥æŸ¥è¯¢åˆ—è¡¨ï¼Œä»urlä¸­è·å–é¡µç å’Œç«™ç‚¹idå¹¶èµ‹å€¼ç»™æ•°æ®æ¨¡å‹å¯¹è±¡ï¼Œä»è€Œå®ç°é¡µé¢å›æ˜¾ã€‚</p><p>urlä¾‹å­ï¼š<a href="http://localhost:12000/#/cms/page/list?page=2&amp;siteId=5a751fab6abb5044e0d19ea1" target="_blank" rel="noopener">http://localhost:12000/#/cms/page/list?page=2&amp;siteId=5a751fab6abb5044e0d19ea1</a></p><div class="hljs"><pre><code class="hljs js">created() &#123;    <span class="hljs-comment">//ä»è·¯ç”±ä¸Šè·å–å‚æ•°</span>    <span class="hljs-keyword">this</span>.params.page = <span class="hljs-built_in">Number</span>.parseInt(<span class="hljs-keyword">this</span>.$route.query.page||<span class="hljs-number">1</span>);    <span class="hljs-keyword">this</span>.params.siteId = <span class="hljs-keyword">this</span>.$route.query.siteId||<span class="hljs-string">''</span>;    .....&#125;</code></pre></div><blockquote><p>å°æŠ€å·§ï¼šä½¿ç”¨ ||è¿”å›ç¬¬ä¸€ä¸ªæœ‰æ•ˆå€¼</p></blockquote><h4 id="1-3ã€è¡¨å•éªŒè¯"><a href="#1-3ã€è¡¨å•éªŒè¯" class="headerlink" title="1.3ã€è¡¨å•éªŒè¯"></a>1.3ã€è¡¨å•éªŒè¯</h4><p>1ï¼‰é…ç½®æ ¡éªŒè§„åˆ™</p><p>Element-UIçš„Formç»„ä»¶æä¾›è¡¨å•æ ¡éªŒçš„æ–¹æ³•ï¼š</p><p>åœ¨formå±æ€§ä¸Šé…ç½®rulesï¼ˆè¡¨å•éªŒè¯è§„åˆ™ï¼‰</p><div class="hljs"><pre><code class="hljs vue">&lt;elâ€form :model&#x3D;&quot;pageForm&quot; :rules&#x3D;&quot;pageFormRules&quot; labelâ€width&#x3D;&quot;80px&quot; &gt;</code></pre></div><p>åœ¨æ•°æ®æ¨¡å‹ä¸­é…ç½®æ ¡éªŒè§„åˆ™ï¼š</p><div class="hljs"><pre><code class="hljs js">data() &#123;    <span class="hljs-keyword">return</span> &#123;        pageFormRules: &#123;            siteId:[                &#123;<span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·é€‰æ‹©ç«™ç‚¹'</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">'blur'</span>&#125;            ],            templateId:[                &#123;<span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·é€‰æ‹©æ¨¡ç‰ˆ'</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">'blur'</span>&#125;            ],            pageName: [                &#123;<span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥é¡µé¢åç§°'</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">'blur'</span>&#125;            ],            pageAliase: [                &#123;<span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥é¡µé¢åˆ«å'</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">'blur'</span>&#125;            ],            pageWebPath: [                &#123;<span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥è®¿é—®è·¯å¾„'</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">'blur'</span>&#125;            ],            pagePhysicalPath: [                &#123;<span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥ç‰©ç†è·¯å¾„'</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">'blur'</span>&#125;            ]        &#125;,    &#125;&#125;</code></pre></div><p>æ›´å¤šçš„æ ¡éªŒè§„åˆ™å‚è€ƒ <a href="http://element.eleme.io/#/zh-CN/component/form" target="_blank" rel="noopener">http://element.eleme.io/#/zh-CN/component/form</a> ä¸­â€œè¡¨å•éªŒè¯â€çš„ä¾‹å­</p><p>2ï¼‰ç‚¹å‡»æäº¤æŒ‰é’®è§¦å‘æ ¡éªŒ</p><p>åœ¨formè¡¨å•ä¸Šæ·»åŠ  refå±æ€§ï¼ˆref=â€pageFormâ€ï¼‰åœ¨æ ¡éªŒæ—¶å¼•ç”¨æ­¤è¡¨å•å¯¹è±¡</p><div class="hljs"><pre><code class="hljs vue">&lt;elâ€form :model&#x3D;&quot;pageForm&quot; :rules&#x3D;&quot;pageFormRules&quot; labelâ€width&#x3D;&quot;80px&quot; ref&#x3D;&quot;pageForm&quot;&gt;</code></pre></div><p>åœ¨æäº¤è¡¨å•æ—¶æ‰§è¡Œæ ¡éªŒ</p><div class="hljs"><pre><code class="hljs js">addSubmit() &#123;    <span class="hljs-keyword">this</span>.$refs.pageForm.validate(<span class="hljs-function">(<span class="hljs-params">valid</span>) =&gt;</span> &#123;        <span class="hljs-keyword">if</span> (valid) &#123;            alert(<span class="hljs-string">'æäº¤'</span>);        &#125; <span class="hljs-keyword">else</span> &#123;            alert(<span class="hljs-string">'æ ¡éªŒå¤±è´¥'</span>);            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;        &#125;    &#125;)&#125;,</code></pre></div><p>æµ‹è¯•</p><p><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image16.png" srcset="/img/loading.gif" alt="img"></p><h3 id="APIè°ƒç”¨-1"><a href="#APIè°ƒç”¨-1" class="headerlink" title="APIè°ƒç”¨"></a>APIè°ƒç”¨</h3><h4 id="1ã€åœ¨cms-jsä¸­å®šä¹‰page-addæ–¹æ³•"><a href="#1ã€åœ¨cms-jsä¸­å®šä¹‰page-addæ–¹æ³•" class="headerlink" title="1ã€åœ¨cms.jsä¸­å®šä¹‰page_addæ–¹æ³•"></a>1ã€åœ¨cms.jsä¸­å®šä¹‰page_addæ–¹æ³•</h4><div class="hljs"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> page_add = <span class="hljs-function"><span class="hljs-params">params</span> =&gt;</span>&#123;  <span class="hljs-keyword">return</span> http.requestPost(apiUrl + <span class="hljs-string">"/cms/page/add"</span>,params)&#125;</code></pre></div><h4 id="2ã€æ·»åŠ äº‹ä»¶"><a href="#2ã€æ·»åŠ äº‹ä»¶" class="headerlink" title="2ã€æ·»åŠ äº‹ä»¶"></a>2ã€æ·»åŠ äº‹ä»¶</h4><p>å®Œæ•´çš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//æäº¤è¡¨å•</span>addSubmit()&#123;  <span class="hljs-keyword">this</span>.$refs.pageForm.validate(<span class="hljs-function">(<span class="hljs-params">valid</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (valid) &#123;      <span class="hljs-keyword">this</span>.$confirm(<span class="hljs-string">'ç¡®è®¤æäº¤å—ï¼Ÿ'</span>, <span class="hljs-string">'æç¤º'</span>, &#123;&#125;).then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;        cmsApi.page_add(<span class="hljs-keyword">this</span>.pageForm).then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;          <span class="hljs-built_in">console</span>.log(res);          <span class="hljs-keyword">if</span>(res.success)&#123;            <span class="hljs-keyword">this</span>.$message(&#123;              message: <span class="hljs-string">'æäº¤æˆåŠŸ'</span>,              type: <span class="hljs-string">'success'</span>          &#125;);          <span class="hljs-keyword">this</span>.$refs[<span class="hljs-string">'pageForm'</span>].resetFields();          &#125;<span class="hljs-keyword">else</span>&#123;            <span class="hljs-keyword">this</span>.$message.error(<span class="hljs-string">'æäº¤å¤±è´¥'</span>);          &#125;        &#125;);      &#125;);    &#125;  &#125;)&#125;,</code></pre></div><p>æœ¬åŠŸèƒ½ä½¿ç”¨åˆ°ä¸¤ä¸ªUIç»„ä»¶ï¼š</p><ul><li>ä½¿ç”¨ <code>element-ui</code> çš„ <code>message-box</code> ç»„ä»¶å¼¹å‡ºç¡®è®¤æäº¤çª—å£ï¼ˆ<a href="http://element.eleme.io/#/zhCN/component/message-box%EF%BC%89" target="_blank" rel="noopener">http://element.eleme.io/#/zhCN/component/message-boxï¼‰</a></li><li>ä½¿ç”¨ <code>message</code>ç»„ä»¶æç¤ºæ“ä½œç»“æœ ï¼ˆ<a href="http://element.eleme.io/#/zh-CN/component/message%EF%BC%89" target="_blank" rel="noopener">http://element.eleme.io/#/zh-CN/component/messageï¼‰</a></li></ul><h4 id="3ã€æµ‹è¯•"><a href="#3ã€æµ‹è¯•" class="headerlink" title="3ã€æµ‹è¯•"></a>3ã€æµ‹è¯•</h4><p><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image17.gif" srcset="/img/loading.gif" alt="img"></p><h1 id="ä¸‰ã€ä¿®æ”¹é¡µé¢"><a href="#ä¸‰ã€ä¿®æ”¹é¡µé¢" class="headerlink" title="ä¸‰ã€ä¿®æ”¹é¡µé¢"></a>ä¸‰ã€ä¿®æ”¹é¡µé¢</h1><p>ä¿®æ”¹é¡µé¢ç”¨æˆ·æ“ä½œæµç¨‹ï¼š</p><p>1ã€ç”¨æˆ·è¿›å…¥ä¿®æ”¹é¡µé¢ï¼Œåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºäº†ä¿®æ”¹é¡µé¢çš„ä¿¡æ¯</p><p>2ã€ç”¨æˆ·ä¿®æ”¹é¡µé¢çš„å†…å®¹ï¼Œç‚¹å‡»â€œæäº¤â€ï¼Œæç¤ºâ€œä¿®æ”¹æˆåŠŸâ€æˆ–â€œä¿®æ”¹å¤±è´¥â€</p><h2 id="1-åç«¯æ¥å£å®šä¹‰"><a href="#1-åç«¯æ¥å£å®šä¹‰" class="headerlink" title="1. åç«¯æ¥å£å®šä¹‰"></a>1. åç«¯æ¥å£å®šä¹‰</h2><p>ä¿®æ”¹é¡µé¢éœ€è¦å®šä¹‰çš„APIå¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//æ ¹æ®é¡µé¢idæŸ¥è¯¢é¡µé¢ä¿¡æ¯</span>    <span class="hljs-meta">@ApiOperation</span>(<span class="hljs-string">"æ ¹æ®é¡µé¢idæŸ¥è¯¢é¡µé¢ä¿¡æ¯"</span>)    <span class="hljs-function"><span class="hljs-keyword">public</span> CmsPage <span class="hljs-title">findById</span><span class="hljs-params">(String id)</span></span>;    <span class="hljs-comment">//ä¿®æ”¹é¡µé¢</span>    <span class="hljs-meta">@ApiOperation</span>(<span class="hljs-string">"ä¿®æ”¹é¡µé¢"</span>)    <span class="hljs-function"><span class="hljs-keyword">public</span> CmsPageResult <span class="hljs-title">edit</span><span class="hljs-params">(String id,CmsPage cmsPage)</span></span>;</code></pre></div><blockquote><p>æˆ‘ä»¬ä»å‰é¢å®šä¹‰çš„ findList ç”¨çš„æ˜¯ <code>QueryResponseResult</code> ä½œä¸ºå“åº”æ¨¡å‹ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å®šä¹‰çš„ <code>CmsPageResult</code> ä½œä¸ºå“åº”æ¨¡å‹ï¼Œä¸¤è€…çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æˆ‘ä¸ªäººçš„ç†è§£æ˜¯ï¼Œ<code>findList</code> æ˜¯åˆ†é¡µæŸ¥è¯¢å¹¶ä¸”è¿”å›äº†å¤šä¸ªå¯¹è±¡çš„ä¿¡æ¯ï¼Œè€Œ <code>findById</code> åˆ™æ˜¯æŸ¥è¯¢å•ä¸ªå¯¹è±¡çš„ä¿¡æ¯ï¼Œæ‰€ä»¥ <code>CmsPageResult</code> ä½œä¸ºæ“ä½œæˆ–æŸ¥è¯¢å•ä¸ªå¯¹è±¡æ—¶çš„å“åº”æ¨¡å‹ï¼Œè€Œ <code>QueryResponseResult</code> åˆ™ä½œä¸ºæ“ä½œå¤šä¸ªå¯¹è±¡æ—¶çš„å“åº”æ¨¡å‹ã€‚</p></blockquote><p>è¯´æ˜ï¼šæäº¤æ•°æ®ä½¿ç”¨postã€putéƒ½å¯ä»¥ï¼Œåªæ˜¯æ ¹æ®httpæ–¹æ³•çš„è§„èŒƒï¼Œputæ–¹æ³•æ˜¯å¯¹æœåŠ¡å™¨æŒ‡å®šèµ„æºè¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨putæ–¹æ³•å¯¹é¡µé¢ä¿®æ”¹è¿›è¡Œä¿®æ”¹ã€‚</p><h2 id="2-æœåŠ¡ç«¯å¼€å‘"><a href="#2-æœåŠ¡ç«¯å¼€å‘" class="headerlink" title="2. æœåŠ¡ç«¯å¼€å‘"></a>2. æœåŠ¡ç«¯å¼€å‘</h2><h3 id="Daoå±‚-2"><a href="#Daoå±‚-2" class="headerlink" title="Daoå±‚"></a>Daoå±‚</h3><p>ä½¿ç”¨ Spring Dataæä¾›çš„findByIdæ–¹æ³•å®Œæˆæ ¹æ®ä¸»é”®æŸ¥è¯¢ ã€‚<br>ä½¿ç”¨ Spring Dataæä¾›çš„saveæ–¹æ³•å®Œæˆæ•°æ®ä¿å­˜ ã€‚</p><h3 id="Serviceå±‚-2"><a href="#Serviceå±‚-2" class="headerlink" title="Serviceå±‚"></a>Serviceå±‚</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//æ ¹æ®é¡µé¢idæŸ¥è¯¢é¡µé¢</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> CmsPage <span class="hljs-title">findById</span><span class="hljs-params">(String id)</span> </span>&#123;        Optional&lt;CmsPage&gt; optional = cmsPageRepository.findById(id);        <span class="hljs-keyword">if</span> (optional.isPresent())&#123;            CmsPage cmsPage = optional.get();            <span class="hljs-keyword">return</span> cmsPage;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-comment">//ä¿®æ”¹é¡µé¢</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> CmsPageResult <span class="hljs-title">edit</span><span class="hljs-params">(String id, CmsPage cmsPage)</span> </span>&#123;        <span class="hljs-comment">//æ ¹æ®idä»æ•°æ®æŸ¥è¯¢é¡µé¢ä¿¡æ¯</span>        CmsPage updateCmsPage = <span class="hljs-keyword">this</span>.findById(id);        <span class="hljs-keyword">if</span> (updateCmsPage != <span class="hljs-keyword">null</span>)&#123;            <span class="hljs-comment">//è®¾ç½®è¦ä¿®æ”¹çš„æ•°æ®</span>            updateCmsPage.setTemplateId(cmsPage.getTemplateId());            updateCmsPage.setSiteId(cmsPage.getSiteId());            updateCmsPage.setPageAliase(cmsPage.getPageAliase());            updateCmsPage.setPageName(cmsPage.getPageName());            updateCmsPage.setPageWebPath(cmsPage.getPageWebPath());            updateCmsPage.setPagePhysicalPath(cmsPage.getPagePhysicalPath());            <span class="hljs-comment">//æäº¤ä¿®æ”¹</span>            cmsPageRepository.save(updateCmsPage);            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CmsPageResult(CommonCode.SUCCESS,updateCmsPage);        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CmsPageResult(CommonCode.FAIL,<span class="hljs-keyword">null</span>);    &#125;</code></pre></div><h3 id="Controllerå±‚-1"><a href="#Controllerå±‚-1" class="headerlink" title="Controllerå±‚"></a>Controllerå±‚</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Override</span>    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/get/&#123;id&#125;"</span>)    <span class="hljs-function"><span class="hljs-keyword">public</span> CmsPage <span class="hljs-title">findById</span><span class="hljs-params">(@PathVariable(<span class="hljs-string">"id"</span>)</span> String id) </span>&#123;        <span class="hljs-keyword">return</span> pageService.findById(id);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-meta">@PutMapping</span>(<span class="hljs-string">"/edit/&#123;id&#125;"</span>)<span class="hljs-comment">//putè¡¨ç¤ºæ›´æ–°</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> CmsPageResult <span class="hljs-title">edit</span><span class="hljs-params">(@PathVariable(<span class="hljs-string">"id"</span>)</span> String id,@RequestBody CmsPage cmsPage) </span>&#123;        <span class="hljs-keyword">return</span> pageService.edit(id,cmsPage);    &#125;</code></pre></div><h2 id="3-ä¿®æ”¹ï¼šå‰ç«¯å¼€å‘"><a href="#3-ä¿®æ”¹ï¼šå‰ç«¯å¼€å‘" class="headerlink" title="3. ä¿®æ”¹ï¼šå‰ç«¯å¼€å‘"></a>3. ä¿®æ”¹ï¼šå‰ç«¯å¼€å‘</h2><h3 id="é¡µé¢å¤„ç†æµç¨‹"><a href="#é¡µé¢å¤„ç†æµç¨‹" class="headerlink" title="é¡µé¢å¤„ç†æµç¨‹"></a>é¡µé¢å¤„ç†æµç¨‹</h3><blockquote><p>å¯ä»¥å‚è€ƒæ–°å¢çš„é€»è¾‘</p></blockquote><ol><li>è¿›å…¥é¡µé¢ï¼Œé€šè¿‡é’©å­æ–¹æ³•è¯·æ±‚æœåŠ¡ç«¯è·å–é¡µé¢ä¿¡æ¯ï¼Œå¹¶èµ‹å€¼ç»™æ•°æ®æ¨¡å‹å¯¹è±¡ã€‚</li><li>é¡µé¢ä¿¡æ¯é€šè¿‡æ•°æ®ç»‘å®šåœ¨è¡¨å•ä¸­æ˜¾ç¤ºã€‚</li><li>ç”¨æˆ·ä¿®æ”¹ä¿¡æ¯ç‚¹å‡» â€œæäº¤â€ è¯·æ±‚æœåŠ¡ç«¯ä¿®æ”¹é¡µé¢ä¿¡æ¯æ¥å£ã€‚</li></ol><h3 id="å‰ç«¯HTTP-APIæ„å»º"><a href="#å‰ç«¯HTTP-APIæ„å»º" class="headerlink" title="å‰ç«¯HTTP APIæ„å»º"></a>å‰ç«¯HTTP APIæ„å»º</h3><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//æŸ¥è¯¢å•ä¸ªé¡µé¢ä¿¡æ¯</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> page_query = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span>&#123;  <span class="hljs-keyword">return</span> http.requestPut(apiUrl + <span class="hljs-string">"/cms/page/get/"</span> + id)&#125;<span class="hljs-comment">//æ›´æ–°æ¥å£</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> page_update = <span class="hljs-function">(<span class="hljs-params">id,params</span>) =&gt;</span>&#123;  <span class="hljs-keyword">return</span> http.requestPut(apiUrl + <span class="hljs-string">"/cms/page/edit/"</span> + id,params)&#125;<span class="hljs-comment">//è·å–ç«™ç‚¹å’Œæ¨¡æ¿åˆ—è¡¨</span></code></pre></div><h3 id="æ·»åŠ é¡µé¢è·¯ç”±"><a href="#æ·»åŠ é¡µé¢è·¯ç”±" class="headerlink" title="æ·»åŠ é¡µé¢è·¯ç”±"></a>æ·»åŠ é¡µé¢è·¯ç”±</h3><div class="hljs"><pre><code class="hljs js"><span class="hljs-keyword">import</span> page_update <span class="hljs-keyword">from</span> <span class="hljs-string">'@/module/cms/page/page_update.vue'</span>;<span class="hljs-comment">//å­èœå•</span>children: [    &#123;        path: <span class="hljs-string">'/cms/page/edit/:pageId'</span>, <span class="hljs-attr">name</span>:<span class="hljs-string">"ç¼–è¾‘é¡µé¢ä¿¡æ¯"</span>,<span class="hljs-attr">component</span>: page_edit, <span class="hljs-attr">hidden</span>:<span class="hljs-literal">true</span>    &#125;,]</code></pre></div><p>pathä¸­çš„ <code>:pageId</code> è¡¨ç¤ºåœ¨è·¯ç”±urlä¸­å®šä¹‰äº†ä¸€ä¸ªpageIdå˜é‡</p><h3 id="æ„å»ºå‰ç«¯é¡µé¢"><a href="#æ„å»ºå‰ç«¯é¡µé¢" class="headerlink" title="æ„å»ºå‰ç«¯é¡µé¢"></a>æ„å»ºå‰ç«¯é¡µé¢</h3><p>åœ¨ <code>page_list</code> é¡µé¢æ–°å¢ç¼–è¾‘æŒ‰é’®</p><div class="hljs"><pre><code class="hljs vue">&lt;el-table-column label&#x3D;&quot;ç¼–è¾‘&quot; width&#x3D;&quot;75&quot; fixed&#x3D;&quot;right&quot;&gt;    &lt;template slot-scope&#x3D;&quot;scope&quot;&gt;&lt;el-button size&#x3D;&quot;small&quot; type&#x3D;&quot;info&quot; @click&#x3D;&quot;toEdit(scope.row.pageId)&quot;&gt;ç¼–è¾‘&lt;&#x2F;el-button&gt;    &lt;&#x2F;template&gt;&lt;&#x2F;el-table-column&gt;</code></pre></div><p>å¢åŠ è·³è½¬edité¡µé¢çš„å‡½æ•°</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//è·³è½¬è‡³ç¼–è¾‘é¡µé¢</span>toEdit(pageId)&#123;  <span class="hljs-keyword">this</span>.$router.push(&#123;    path:<span class="hljs-string">"/cms/page/edit/"</span> + pageId,    query:&#123;      page:<span class="hljs-keyword">this</span>.params.page,      siteId:<span class="hljs-keyword">this</span>.params.siteId    &#125;  &#125;)&#125;,</code></pre></div><p>ä½¿ç”¨ <code>scope</code> è·å–å½“å‰è¡Œæ•°æ®ä¸­çš„ <code>pageId</code> ä¼ å…¥ toEdit å‡½æ•°è¿›è¡Œé¡µé¢è·³è½¬</p><p>å®Œæˆ<code>page_edit.vue</code> é¡µé¢çš„åŸºæœ¬æ„é€ </p><div class="hljs"><pre><code class="hljs vue">&lt;template&gt;  &lt;div&gt;    &lt;el-form :model&#x3D;&quot;pageForm&quot; label-width&#x3D;&quot;80px&quot; :rules&#x3D;&quot;pageFormRules&quot; ref&#x3D;&quot;pageForm&quot;&gt;      &lt;el-form-item label&#x3D;&quot;æ‰€å±ç«™ç‚¹&quot; prop&#x3D;&quot;siteId&quot;&gt;        &lt;el-select v-model&#x3D;&quot;pageForm.siteId&quot; placeholder&#x3D;&quot;è¯·é€‰æ‹©ç«™ç‚¹&quot;&gt;          &lt;el-option            v-for&#x3D;&quot;item in siteList&quot;            :key&#x3D;&quot;item.siteId&quot;            :label&#x3D;&quot;item.siteName&quot;            :value&#x3D;&quot;item.siteId&quot;&gt;          &lt;&#x2F;el-option&gt;        &lt;&#x2F;el-select&gt;      &lt;&#x2F;el-form-item&gt;      &lt;el-form-item label&#x3D;&quot;é€‰æ‹©æ¨¡ç‰ˆ&quot; prop&#x3D;&quot;templateId&quot;&gt;        &lt;el-select v-model&#x3D;&quot;pageForm.templateId&quot; placeholder&#x3D;&quot;è¯·é€‰æ‹©&quot;&gt;          &lt;el-option            v-for&#x3D;&quot;item in templateList&quot;            :key&#x3D;&quot;item.templateId&quot;            :label&#x3D;&quot;item.templateName&quot;            :value&#x3D;&quot;item.templateId&quot;&gt;          &lt;&#x2F;el-option&gt;        &lt;&#x2F;el-select&gt;      &lt;&#x2F;el-form-item&gt;      &lt;el-form-item label&#x3D;&quot;é¡µé¢åç§°&quot; prop&#x3D;&quot;pageName&quot;&gt;        &lt;el-input v-model&#x3D;&quot;pageForm.pageName&quot; auto-complete&#x3D;&quot;off&quot;&gt;&lt;&#x2F;el-input&gt;      &lt;&#x2F;el-form-item&gt;      &lt;el-form-item label&#x3D;&quot;åˆ«å&quot; prop&#x3D;&quot;pageAliase&quot;&gt;        &lt;el-input v-model&#x3D;&quot;pageForm.pageAliase&quot; auto-complete&#x3D;&quot;off&quot;&gt;&lt;&#x2F;el-input&gt;      &lt;&#x2F;el-form-item&gt;      &lt;el-form-item label&#x3D;&quot;è®¿é—®è·¯å¾„&quot; prop&#x3D;&quot;pageWebPath&quot;&gt;        &lt;el-input v-model&#x3D;&quot;pageForm.pageWebPath&quot; auto-complete&#x3D;&quot;off&quot;&gt;&lt;&#x2F;el-input&gt;      &lt;&#x2F;el-form-item&gt;      &lt;el-form-item label&#x3D;&quot;ç‰©ç†è·¯å¾„&quot; prop&#x3D;&quot;pagePhysicalPath&quot;&gt;        &lt;el-input v-model&#x3D;&quot;pageForm.pagePhysicalPath&quot; auto-complete&#x3D;&quot;off&quot;&gt;&lt;&#x2F;el-input&gt;      &lt;&#x2F;el-form-item&gt;      &lt;el-form-item label&#x3D;&quot;ç±»å‹&quot;&gt;        &lt;el-radio-group v-model&#x3D;&quot;pageForm.pageType&quot;&gt;          &lt;el-radio class&#x3D;&quot;radio&quot; label&#x3D;&quot;0&quot; &gt;é™æ€&lt;&#x2F;el-radio&gt;          &lt;el-radio class&#x3D;&quot;radio&quot; label&#x3D;&quot;1&quot; &gt;åŠ¨æ€&lt;&#x2F;el-radio&gt;        &lt;&#x2F;el-radio-group&gt;      &lt;&#x2F;el-form-item&gt;      &lt;el-form-item label&#x3D;&quot;åˆ›å»ºæ—¶é—´&quot;&gt;        &lt;el-date-picker type&#x3D;&quot;datetime&quot; placeholder&#x3D;&quot;åˆ›å»ºæ—¶é—´&quot; v-model&#x3D;&quot;pageForm.pageCreateTime&quot;&gt;        &lt;&#x2F;el-date-picker&gt;      &lt;&#x2F;el-form-item&gt;    &lt;&#x2F;el-form&gt;    &lt;div slot&#x3D;&quot;footer&quot; class&#x3D;&quot;dialog-footer&quot;&gt;      &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;addSubmit&quot;&gt;æäº¤&lt;&#x2F;el-button&gt;      &lt;el-button type&#x3D;&quot;info&quot; @click&#x3D;&quot;goBack&quot;&gt;è¿”å›&lt;&#x2F;el-button&gt;    &lt;&#x2F;div&gt;  &lt;&#x2F;div&gt;&lt;&#x2F;template&gt;&lt;script&gt;  import * as cmsApi from &#39;..&#x2F;api&#x2F;cms&#39;  export default &#123;    created: function () &#123;    &#125;,    mounted() &#123;    &#125;,    data() &#123;      return &#123;        pageFormRules: &#123;          siteId: [            &#123;required: true, message: &#39;è¯·é€‰æ‹©ç«™ç‚¹&#39;, trigger: &#39;blur&#39;&#125;          ],          templateId: [            &#123;required: true, message: &#39;è¯·é€‰æ‹©æ¨¡ç‰ˆ&#39;, trigger: &#39;blur&#39;&#125;          ],          pageName: [            &#123;required: true, message: &#39;è¯·è¾“å…¥é¡µé¢åç§°&#39;, trigger: &#39;blur&#39;&#125;          ],          pageAliase: [            &#123;required: true, message: &#39;è¯·è¾“å…¥é¡µé¢åˆ«å&#39;, trigger: &#39;blur&#39;&#125;          ],          pageWebPath: [            &#123;required: true, message: &#39;è¯·è¾“å…¥è®¿é—®è·¯å¾„&#39;, trigger: &#39;blur&#39;&#125;          ],          pagePhysicalPath: [            &#123;required: true, message: &#39;è¯·è¾“å…¥ç‰©ç†è·¯å¾„&#39;, trigger: &#39;blur&#39;&#125;          ]        &#125;,        &#x2F;&#x2F;ç«™ç‚¹åˆ—è¡¨        siteList: [],        &#x2F;&#x2F;æ¨¡ç‰ˆåˆ—è¡¨        templateList: [],        &#x2F;&#x2F;æ–°å¢ç•Œé¢æ•°æ®        pageForm: &#123;          siteId: &#39;&#39;,          templateId: &#39;&#39;,          pageName: &#39;&#39;,          pageAliase: &#39;&#39;,          pageWebPath: &#39;&#39;,          pageParameter: &#39;&#39;,          pagePhysicalPath: &#39;&#39;,          pageType: &#39;&#39;,          pageCreateTime: new Date()        &#125;      &#125;    &#125;,    methods: &#123;      &#x2F;&#x2F;è¿”å›ä¸Šä¸€é¡µ      goBack() &#123;        this.$router.push(&#123;          path: &quot;&#x2F;cms&#x2F;page&#x2F;list&quot;,          query: &#123;            page: this.$route.query.page,            siteId: this.$route.query.siteId          &#125;        &#125;)      &#125;    &#125;  &#125;&lt;&#x2F;script&gt;</code></pre></div><h4 id="1ã€é¡µé¢åˆå§‹åŒ–"><a href="#1ã€é¡µé¢åˆå§‹åŒ–" class="headerlink" title="1ã€é¡µé¢åˆå§‹åŒ–"></a>1ã€é¡µé¢åˆå§‹åŒ–</h4><p>åœ¨é’©å­å‡½æ•° <code>created</code> ä¸­è¿›è¡Œä¸€äº›æ•°æ®çš„åˆå§‹åŒ–è¯·æ±‚ï¼Œä¾‹å¦‚ç«™ç‚¹ã€æ¨¡æ¿çš„ä¿¡æ¯ï¼Œç”¨äºä¸‹æ‹‰æ¡†çš„é€‰æ‹©ï¼Œä»¥åŠåœ¨æ‰“å¼€ç¼–è¾‘é¡µé¢ä¹‹å‰ï¼Œç”¨æˆ·éœ€è¦è·å–å½“å‰ç¼–è¾‘çš„é¡µé¢åŸæœ‰çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>page_list</code> é¡µé¢é€šè¿‡çš„ <code>pageId</code> æ¥è·å–å½“å‰ç¼–è¾‘çš„é¡µé¢çš„æ•°æ®ã€‚</p><div class="hljs"><pre><code class="hljs js">created: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;     <span class="hljs-comment">//åˆå§‹åŒ–ç«™ç‚¹æ•°æ®</span>    cmsApi.site_list().then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;        <span class="hljs-keyword">if</span> (res.success) &#123;            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"ç«™ç‚¹æ•°æ®"</span>, res)            <span class="hljs-keyword">this</span>.siteList = res.queryResult.list        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"è·å–ç«™ç‚¹ä¿¡æ¯æ—¶å‘ç”Ÿäº†é”™è¯¯"</span>, res)        &#125;    &#125;)    <span class="hljs-comment">//åˆå§‹åŒ–æ¨¡æ¿æ•°æ®</span>    cmsApi.template_list().then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;        <span class="hljs-keyword">if</span> (res.success) &#123;            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"æ¨¡æ¿æ•°æ®"</span>, res)            <span class="hljs-keyword">this</span>.templateList = res.queryResult.list        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"è·å–æ¨¡æ¿ä¿¡æ¯æ—¶å‘ç”Ÿäº†é”™è¯¯"</span>, res)        &#125;    &#125;)    <span class="hljs-comment">//åˆå§‹åŒ–é¡µé¢çš„æ•°æ®</span>    cmsApi.page_query(<span class="hljs-keyword">this</span>.$route.params.pageId).then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span>&#123;        <span class="hljs-keyword">if</span>(res.success)&#123;            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"åˆå§‹åŒ–é¡µé¢æ•°æ®"</span>,res.cmsPage)            <span class="hljs-keyword">this</span>.pageForm = res.cmsPage        &#125;<span class="hljs-keyword">else</span>&#123;            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"åˆå§‹åŒ–é¡µé¢æ•°æ®å¤±è´¥"</span>,res)        &#125;    &#125;)&#125;,</code></pre></div><p>æˆ‘ä»¬åœ¨é¡µé¢è·¯ç”±å®šä¹‰äº†ä¸€ä¸ª:pageIdçš„å‚æ•°ï¼Œæ‰€ä»¥åœ¨åˆå§‹åŒ–é¡µé¢çš„æ•°æ®éƒ¨åˆ†ä» <code>this.$route.params</code> å–å‡ºäº†<code>pageId</code></p><h4 id="2ã€æäº¤æ›´æ–°è¡¨å•"><a href="#2ã€æäº¤æ›´æ–°è¡¨å•" class="headerlink" title="2ã€æäº¤æ›´æ–°è¡¨å•"></a>2ã€æäº¤æ›´æ–°è¡¨å•</h4><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//æäº¤è¡¨å•</span>addSubmit() &#123;    <span class="hljs-keyword">this</span>.$refs.pageForm.validate(<span class="hljs-function">(<span class="hljs-params">valid</span>) =&gt;</span> &#123;        <span class="hljs-keyword">if</span> (valid) &#123;            <span class="hljs-keyword">this</span>.$confirm(<span class="hljs-string">'ç¡®è®¤æäº¤ä¿®æ”¹å—ï¼Ÿ'</span>, <span class="hljs-string">'æç¤º'</span>, &#123;&#125;).then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;                cmsApi.page_edit(<span class="hljs-keyword">this</span>.$route.params.pageId,<span class="hljs-keyword">this</span>.pageForm).then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;                    <span class="hljs-keyword">if</span> (res.success) &#123;                        <span class="hljs-keyword">this</span>.$message(&#123;                            message: <span class="hljs-string">'ä¿®æ”¹æäº¤æˆåŠŸ'</span>,                            type: <span class="hljs-string">'success'</span>                        &#125;);                    &#125; <span class="hljs-keyword">else</span> &#123;                        <span class="hljs-keyword">this</span>.$message.error(<span class="hljs-string">'æäº¤å¤±è´¥'</span>);                    &#125;                &#125;);            &#125;);        &#125;    &#125;)&#125;,</code></pre></div><h1 id="å››ã€åˆ é™¤é¡µé¢"><a href="#å››ã€åˆ é™¤é¡µé¢" class="headerlink" title="å››ã€åˆ é™¤é¡µé¢"></a>å››ã€åˆ é™¤é¡µé¢</h1><p>ä¿®æ”¹é¡µé¢ç”¨æˆ·æ“ä½œæµç¨‹ï¼š</p><p>1ã€ç”¨æˆ·è¿›å…¥ä¿®æ”¹é¡µé¢ï¼Œåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºäº†ä¿®æ”¹é¡µé¢çš„ä¿¡æ¯</p><p>2ã€ç”¨æˆ·ä¿®æ”¹é¡µé¢çš„å†…å®¹ï¼Œç‚¹å‡»â€œæäº¤â€ï¼Œæç¤ºâ€œä¿®æ”¹æˆåŠŸâ€æˆ–â€œä¿®æ”¹å¤±è´¥â€</p><h2 id="1-åç«¯æ¥å£å®šä¹‰-1"><a href="#1-åç«¯æ¥å£å®šä¹‰-1" class="headerlink" title="1. åç«¯æ¥å£å®šä¹‰"></a>1. åç«¯æ¥å£å®šä¹‰</h2><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * åˆ é™¤æ¥å£</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> id é¡µé¢id</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-meta">@ApiOperation</span>(<span class="hljs-string">"åˆ é™¤é¡µé¢"</span>)<span class="hljs-function"><span class="hljs-keyword">public</span> ResponseResult <span class="hljs-title">delete</span><span class="hljs-params">(String id)</span></span>;</code></pre></div><h2 id="2-æœåŠ¡ç«¯å¼€å‘-1"><a href="#2-æœåŠ¡ç«¯å¼€å‘-1" class="headerlink" title="2. æœåŠ¡ç«¯å¼€å‘"></a>2. æœåŠ¡ç«¯å¼€å‘</h2><h3 id="Daoå±‚-3"><a href="#Daoå±‚-3" class="headerlink" title="Daoå±‚"></a>Daoå±‚</h3><p><code>dao</code>å±‚ ä½¿ç”¨ <code>MongoDB</code> æä¾›çš„daoæ¥å£æ¥å®ç°</p><h3 id="Serviceå±‚-3"><a href="#Serviceå±‚-3" class="headerlink" title="Serviceå±‚"></a>Serviceå±‚</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * æ ¹æ®idåˆ é™¤</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> id</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">public</span> ResponseResult <span class="hljs-title">deleteCmsPage</span><span class="hljs-params">(String id)</span></span>&#123;    <span class="hljs-comment">//æ£€ç´¢è¯¥é¡µé¢idæ˜¯å¦å­˜åœ¨</span>    Optional&lt;CmsPage&gt; optional = cmsPageRepository.findById(id);    <span class="hljs-keyword">if</span>(optional.isPresent())&#123;        <span class="hljs-comment">//åˆ é™¤å¹¶è¿”å›ç»“æœ</span>        cmsPageRepository.deleteById(id);        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ResponseResult(CommonCode.SUCCESS);    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ResponseResult(CommonCode.FAIL);&#125;</code></pre></div><h3 id="Controllerå±‚-2"><a href="#Controllerå±‚-2" class="headerlink" title="Controllerå±‚"></a>Controllerå±‚</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * åˆ é™¤é¡µé¢</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> id é¡µé¢id</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-meta">@DeleteMapping</span>(<span class="hljs-string">"/delete/&#123;id&#125;"</span>)<span class="hljs-meta">@Override</span><span class="hljs-function"><span class="hljs-keyword">public</span> ResponseResult <span class="hljs-title">delete</span><span class="hljs-params">(@PathVariable(<span class="hljs-string">"id"</span>)</span> String id) </span>&#123;    <span class="hljs-keyword">return</span> pageService.deleteCmsPage(id);&#125;</code></pre></div><h3 id="æ¥å£æµ‹è¯•"><a href="#æ¥å£æµ‹è¯•" class="headerlink" title="æ¥å£æµ‹è¯•"></a>æ¥å£æµ‹è¯•</h3><p><a href="https://qnoss.codeyee.com/20200704_3/image18" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image18.png" srcset="/img/loading.gif" alt="img"></a></p><h2 id="3-å‰ç«¯å¼€å‘"><a href="#3-å‰ç«¯å¼€å‘" class="headerlink" title="3.å‰ç«¯å¼€å‘"></a>3.å‰ç«¯å¼€å‘</h2><h3 id="é¡µé¢ç¼–å†™"><a href="#é¡µé¢ç¼–å†™" class="headerlink" title="é¡µé¢ç¼–å†™"></a>é¡µé¢ç¼–å†™</h3><p>1ã€åœ¨ <code>page_list</code> é¡µé¢å†…æ–°å¢ä¸€ä¸ªåˆ é™¤æŒ‰é’®</p><div class="hljs"><pre><code class="hljs vue">&lt;el-table-column label&#x3D;&quot;åˆ é™¤&quot; width&#x3D;&quot;75&quot; fixed&#x3D;&quot;right&quot;&gt;  &lt;template slot-scope&#x3D;&quot;scope&quot;&gt;    &lt;el-button      size&#x3D;&quot;mini&quot;      type&#x3D;&quot;danger&quot;      @click&#x3D;&quot;deletePage(scope.row.pageId)&quot;&gt;åˆ é™¤    &lt;&#x2F;el-button&gt;  &lt;&#x2F;template&gt;&lt;&#x2F;el-table-column&gt;</code></pre></div><p>2ã€åœ¨ <code>cms.js</code> å®šä¹‰åˆ é™¤çš„api</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//åˆ é™¤æ¥å£</span>export <span class="hljs-keyword">const</span> page_delete = (id) =&gt;&#123;  <span class="hljs-keyword">return</span> http.requestDelete(apiUrl + <span class="hljs-string">"/cms/page/delete/"</span> + id)&#125;</code></pre></div><p>3ã€åˆ›å»º <code>deletePage</code> å‡½æ•°ï¼Œæ¥æ”¶åˆ° å½“å‰è¡Œçš„ <code>pageId</code></p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//åˆ é™¤é¡µé¢</span>deletePage(pageId) &#123;  <span class="hljs-keyword">this</span>.$confirm(<span class="hljs-string">"æ­¤æ“ä½œå°†æ°¸ä¹…çš„åˆ é™¤è¯¥é¡µé¢"</span>, <span class="hljs-string">"æç¤º"</span>, &#123;    confirmButtonText: <span class="hljs-string">'ç¡®å®š'</span>,    cancelButtonText: <span class="hljs-string">'å–æ¶ˆ'</span>,    type: <span class="hljs-string">'warning'</span>  &#125;).then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;    cmsApi.page_delete(pageId).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;      <span class="hljs-keyword">if</span> (res.success) &#123;        <span class="hljs-keyword">this</span>.$message(&#123;          type: <span class="hljs-string">'success'</span>,          message: <span class="hljs-string">'åˆ é™¤æˆåŠŸ!'</span>        &#125;)        <span class="hljs-keyword">this</span>.query()      &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">this</span>.$message(&#123;          type: <span class="hljs-string">'warning'</span>,          message: <span class="hljs-string">'åˆ é™¤å¤±è´¥'</span>        &#125;);      &#125;    &#125;)  &#125;).catch(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;    <span class="hljs-keyword">this</span>.$message(&#123;      type: <span class="hljs-string">'info'</span>,      message: <span class="hljs-string">'å·²å–æ¶ˆåˆ é™¤'</span>    &#125;);  &#125;);&#125;,</code></pre></div><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p><a href="https://qnoss.codeyee.com/20200704_3/image19" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image19.gif" srcset="/img/loading.gif" alt="img"></a></p><h1 id="äº”ã€å¼‚å¸¸å¤„ç†"><a href="#äº”ã€å¼‚å¸¸å¤„ç†" class="headerlink" title="äº”ã€å¼‚å¸¸å¤„ç†"></a>äº”ã€å¼‚å¸¸å¤„ç†</h1><h2 id="1-å¼‚å¸¸å¤„ç†çš„é—®é¢˜åˆ†æ"><a href="#1-å¼‚å¸¸å¤„ç†çš„é—®é¢˜åˆ†æ" class="headerlink" title="1. å¼‚å¸¸å¤„ç†çš„é—®é¢˜åˆ†æ"></a>1. å¼‚å¸¸å¤„ç†çš„é—®é¢˜åˆ†æ</h2><p>ä»æ·»åŠ é¡µé¢çš„serviceæ–¹æ³•ä¸­æ‰¾é—®é¢˜ï¼š</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment">* æ·»åŠ é¡µé¢æ•°æ®</span><span class="hljs-comment">*/</span><span class="hljs-function"><span class="hljs-keyword">public</span> CmsPageResult <span class="hljs-title">addCmsPage</span><span class="hljs-params">(CmsPage cmsPage)</span> </span>&#123;    <span class="hljs-comment">//éªŒè¯æ•°æ®å”¯ä¸€æ€§ï¼šsizeIdã€pageNameã€pageWebPath</span>    CmsPage cmsPage1 = cmsPageRepository.findByPageNameAndSiteIdAndPageWebPath(cmsPage.getPageName(), cmsPage.getSiteId(), cmsPage.getPageWebPath());    <span class="hljs-keyword">if</span> (cmsPage1 == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-comment">//ç«™ç‚¹idç”±mongoDBè‡ªåŠ¨ç”Ÿæˆï¼Œé˜²æ­¢å‰ç«¯ä¼ å€¼</span>        cmsPage.setPageId(<span class="hljs-keyword">null</span>);        CmsPage save = cmsPageRepository.save(cmsPage);        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CmsPageResult(CommonCode.SUCCESS, save);    &#125;    <span class="hljs-comment">//æ·»åŠ å¤±è´¥</span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CmsPageResult(CommonCode.FAIL, cmsPage);&#125;</code></pre></div><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a><strong>é—®é¢˜</strong></h3><p>1ã€ä¸Šè¾¹çš„ä»£ç åªè¦æ“ä½œä¸æˆåŠŸä»…å‘ç”¨æˆ·è¿”å›â€œé”™è¯¯ä»£ç ï¼š11111ï¼Œå¤±è´¥ä¿¡æ¯ï¼šæ“ä½œå¤±è´¥â€ï¼Œæ— æ³•åŒºåˆ«å…·ä½“çš„é”™è¯¯ä¿¡æ¯ã€‚</p><p>2ã€<code>service</code> æ–¹æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹å‡ºç°å¼‚å¸¸åœ¨å“ªæ•è·ï¼Ÿåœ¨ <code>service</code> ä¸­éœ€è¦éƒ½åŠ  <code>try</code>/<code>catch</code>ï¼Œå¦‚æœåœ¨<code>controller</code> ä¹Ÿéœ€è¦æ·»åŠ  try/catchï¼Œä»£ç å†—ä½™ä¸¥é‡ä¸”ä¸æ˜“ç»´æŠ¤ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>1ã€åœ¨ <code>Service</code> æ–¹æ³•ä¸­çš„ç¼–ç é¡ºåºæ˜¯å…ˆæ ¡éªŒåˆ¤æ–­ï¼Œæœ‰é—®é¢˜åˆ™æŠ›å‡ºå…·ä½“çš„å¼‚å¸¸ä¿¡æ¯ï¼Œæœ€åæ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡æ“ä½œï¼Œè¿”å›æˆåŠŸä¿¡æ¯ã€‚</p><p>2ã€åœ¨ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±»ä¸­å»æ•è·å¼‚å¸¸ï¼Œæ— éœ€<code>controller</code>æ•è·å¼‚å¸¸ï¼Œå‘ç”¨æˆ·è¿”å›ç»Ÿä¸€è§„èŒƒçš„å“åº”ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬çš„ä»£ç åº”è¯¥æ˜¯è¿™æ ·çš„</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * æ·»åŠ é¡µé¢æ•°æ®</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">public</span> CmsPageResult <span class="hljs-title">addCmsPage</span><span class="hljs-params">(CmsPage cmsPage)</span> </span>&#123;    <span class="hljs-comment">//æ•ˆéªŒcmsPageæ˜¯å¦ä¸ºç©º</span>    <span class="hljs-keyword">if</span>(cmsPage == <span class="hljs-keyword">null</span>)&#123;        <span class="hljs-comment">//æŠ›å‡ºå¼‚å¸¸ï¼Œéæ³•å‚æ•°</span>    &#125;    <span class="hljs-comment">//éªŒè¯æ•°æ®å”¯ä¸€æ€§ï¼šsizeIdã€pageNameã€pageWebPath</span>    CmsPage cmsPage1 = cmsPageRepository.findByPageNameAndSiteIdAndPageWebPath(cmsPage.getPageName(), cmsPage.getSiteId(), cmsPage.getPageWebPath());    <span class="hljs-comment">//æ£€éªŒé¡µé¢æ˜¯å¦å·²å­˜åœ¨</span>    <span class="hljs-keyword">if</span> (cmsPage1 != <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-comment">//æŠ›å‡ºå¼‚å¸¸</span>    &#125;    <span class="hljs-comment">//ç«™ç‚¹idç”±mongoDBè‡ªåŠ¨ç”Ÿæˆï¼Œé˜²æ­¢å‰ç«¯ä¼ å€¼</span>    cmsPage.setPageId(<span class="hljs-keyword">null</span>);    CmsPage save = cmsPageRepository.save(cmsPage);    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CmsPageResult(CommonCode.SUCCESS, save);    <span class="hljs-comment">//æ·»åŠ å¤±è´¥</span>&#125;</code></pre></div><p>åœ¨æ‰§è¡Œæ­£å¸¸çš„é€»è¾‘ä¹‹å‰ï¼Œè¦æŠŠå·²çŸ¥çš„å¼‚å¸¸è¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯å…¨éƒ¨é€šè¿‡åæ‰ä¼šå»æ‰§è¡Œæ­£å¸¸çš„é€»è¾‘ä»£ç ã€‚</p><h2 id="2-å¼‚å¸¸å¤„ç†æµç¨‹"><a href="#2-å¼‚å¸¸å¤„ç†æµç¨‹" class="headerlink" title="2. å¼‚å¸¸å¤„ç†æµç¨‹"></a>2. å¼‚å¸¸å¤„ç†æµç¨‹</h2><p>ç³»ç»Ÿå¯¹å¼‚å¸¸çš„å¤„ç†ä½¿ç”¨ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æµç¨‹ï¼š</p><p>1ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»å‹ã€‚</p><p>2ã€è‡ªå®šä¹‰é”™è¯¯ä»£ç åŠé”™è¯¯ä¿¡æ¯ã€‚</p><p>3ã€å¯¹äºå¯é¢„çŸ¥çš„å¼‚å¸¸ç”±ç¨‹åºå‘˜åœ¨ä»£ç ä¸­ä¸»åŠ¨æŠ›å‡ºï¼Œç”± <code>SpringMVC</code> ç»Ÿä¸€æ•è·ã€‚</p><p>å¯é¢„çŸ¥å¼‚å¸¸æ˜¯ç¨‹åºå‘˜åœ¨ä»£ç ä¸­æ‰‹åŠ¨æŠ›å‡ºæœ¬ç³»ç»Ÿå®šä¹‰çš„ç‰¹å®šå¼‚å¸¸ç±»å‹ï¼Œç”±äºæ˜¯ç¨‹åºå‘˜æŠ›å‡ºçš„å¼‚å¸¸ï¼Œé€šå¸¸å¼‚å¸¸ä¿¡æ¯æ¯”è¾ƒé½å…¨ï¼Œç¨‹åºå‘˜åœ¨æŠ›å‡ºæ—¶ä¼šæŒ‡å®šé”™è¯¯ä»£ç åŠé”™è¯¯ä¿¡æ¯ï¼Œè·å–å¼‚å¸¸ä¿¡æ¯ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚</p><p>4ã€å¯¹äºä¸å¯é¢„çŸ¥çš„å¼‚å¸¸ï¼ˆè¿è¡Œæ—¶å¼‚å¸¸ï¼‰ç”±<code>SpringMVC</code>ç»Ÿä¸€æ•è· <code>Exception</code> ç±»å‹çš„å¼‚å¸¸ã€‚</p><p>ä¸å¯é¢„çŸ¥å¼‚å¸¸é€šå¸¸æ˜¯ç”±äºç³»ç»Ÿå‡ºç°bugã€æˆ–ä¸€äº›ä¸è¦æŠ—æ‹’çš„é”™è¯¯ï¼ˆæ¯”å¦‚ç½‘ç»œä¸­æ–­ã€æœåŠ¡å™¨å®•æœºç­‰ï¼‰ï¼Œå¼‚å¸¸ç±»å‹ä¸º <code>RuntimeException</code>ç±»å‹ï¼ˆè¿è¡Œæ—¶å¼‚å¸¸ï¼‰ã€‚</p><p>5ã€å¯é¢„çŸ¥çš„å¼‚å¸¸åŠä¸å¯é¢„çŸ¥çš„è¿è¡Œæ—¶å¼‚å¸¸æœ€ç»ˆä¼šé‡‡ç”¨ç»Ÿä¸€çš„ä¿¡æ¯æ ¼å¼ï¼ˆé”™è¯¯ä»£ç +é”™è¯¯ä¿¡æ¯ï¼‰æ¥è¡¨ç¤ºï¼Œæœ€ç»ˆä¹Ÿä¼šéšè¯·æ±‚å“åº”ç»™å®¢æˆ·ç«¯ã€‚</p><p>å¼‚å¸¸æŠ›å‡ºåŠå¤„ç†æµç¨‹ï¼š</p><p><a href="https://qnoss.codeyee.com/20200704_3/image20" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image20.png" srcset="/img/loading.gif" alt="img"></a></p><p>1ã€åœ¨ <code>controller</code>ã€<code>service</code>ã€<code>dao</code> ä¸­ç¨‹åºå‘˜æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ï¼›<code>springMVC</code> æ¡†æ¶æŠ›å‡ºæ¡†æ¶å¼‚å¸¸ç±»å‹</p><p>2ã€ç»Ÿä¸€ç”±å¼‚å¸¸æ•è·ç±»æ•è·å¼‚å¸¸ï¼Œå¹¶è¿›è¡Œå¤„ç†</p><p>3ã€æ•è·åˆ°è‡ªå®šä¹‰å¼‚å¸¸åˆ™ç›´æ¥å–å‡ºé”™è¯¯ä»£ç åŠé”™è¯¯ä¿¡æ¯ï¼Œå“åº”ç»™ç”¨æˆ·</p><p>4ã€æ•è·åˆ°éè‡ªå®šä¹‰å¼‚å¸¸ç±»å‹é¦–å…ˆä» <code>Map</code> ä¸­æ‰¾è¯¥å¼‚å¸¸ç±»å‹æ˜¯å¦å¯¹åº”å…·ä½“çš„é”™è¯¯ä»£ç ï¼Œå¦‚æœæœ‰åˆ™å–å‡ºé”™è¯¯ä»£ç å’Œé”™è¯¯ä¿¡æ¯å¹¶å“åº”ç»™ç”¨æˆ·ï¼Œå¦‚æœä» <code>Map</code> ä¸­æ‰¾ä¸åˆ°å¼‚å¸¸ç±»å‹æ‰€å¯¹åº”çš„é”™è¯¯ä»£ç åˆ™ç»Ÿä¸€ä¸º <code>99999</code> é”™è¯¯ä»£ç å¹¶å“åº”ç»™ç”¨æˆ·ã€‚</p><p>5ã€å°†é”™è¯¯ä»£ç åŠé”™è¯¯ä¿¡æ¯ä»¥ <code>Json</code> æ ¼å¼å“åº”ç»™ç”¨æˆ·ã€‚</p><h2 id="3-å¯é¢„çŸ¥å¼‚å¸¸å¤„ç†"><a href="#3-å¯é¢„çŸ¥å¼‚å¸¸å¤„ç†" class="headerlink" title="3. å¯é¢„çŸ¥å¼‚å¸¸å¤„ç†"></a>3. å¯é¢„çŸ¥å¼‚å¸¸å¤„ç†</h2><h3 id="è‡ªå®šä¹‰å¼‚å¸¸ç±»"><a href="#è‡ªå®šä¹‰å¼‚å¸¸ç±»" class="headerlink" title="è‡ªå®šä¹‰å¼‚å¸¸ç±»"></a>è‡ªå®šä¹‰å¼‚å¸¸ç±»</h3><p>åœ¨commonå·¥ç¨‹å®šä¹‰å¼‚å¸¸ç±»å‹ã€‚</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.framework.exception;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.ResultCode;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RuntimeException</span> </span>&#123;    <span class="hljs-keyword">private</span> ResultCode resultCode;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CustomException</span><span class="hljs-params">(ResultCode resultCode)</span></span>&#123;        <span class="hljs-comment">//å¼‚å¸¸ä¿¡æ¯ä¸ºé”™è¯¯ä»£ç +å¼‚å¸¸ä¿¡æ¯</span>        <span class="hljs-keyword">super</span>(<span class="hljs-string">"é”™è¯¯ä»£ç : "</span> + resultCode.code() + <span class="hljs-string">" é”™è¯¯ä¿¡æ¯: "</span> + resultCode.message());        <span class="hljs-keyword">this</span>.resultCode = resultCode;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> ResultCode <span class="hljs-title">getResultCode</span><span class="hljs-params">()</span></span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.resultCode;    &#125;&#125;</code></pre></div><p>ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€ä¸ªåä¸º <code>CustomException</code> çš„å¼‚å¸¸ï¼Œå¹¶ä¸”ç»§æ‰¿äº† <code>RuntimeException</code> å¼‚å¸¸ç±»ï¼Œæœ‰çš„äººå¯èƒ½ä¼šé—®ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ç›´æ¥ç»§æ‰¿ <code>Exception</code> ç±»ï¼Ÿå› ä¸ºå¦‚æœç»§æ‰¿äº† <code>Exception</code> ç±»ï¼Œæˆ‘ä»¬åœ¨æŠ›å‡ºå¼‚å¸¸æ—¶å¯¹ä»£ç ä¼šæœ‰ä¸€å®šçš„ä¾µå…¥æ€§ï¼Œä¾‹å¦‚æˆ‘ä»¬éœ€è¦åœ¨æŠ›å‡ºè¯¥å¼‚å¸¸çš„æ–¹æ³•å‰åŠ å…¥ <code>throws Exception</code> ï¼Œä¾‹å¦‚</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> CmsPageResult <span class="hljs-title">addCmsPage</span><span class="hljs-params">(CmsPage cmsPage)</span> <span class="hljs-keyword">throws</span> Exception</span>&#123;&#125;</code></pre></div><p>æˆ–è€…ä½¿ç”¨</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">try</span> &#123;    <span class="hljs-comment">//æŠ›å‡ºå¼‚å¸¸ï¼Œéæ³•å‚æ•°</span>&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;    e.printStackTrace();&#125;</code></pre></div><p>è€Œæˆ‘ä»¬å¦‚æœä½¿ç”¨ <code>RuntimeException</code> ,è‡³éœ€è¦åœ¨æŠ›å‡ºå¼‚å¸¸çš„åœ°æ–¹å†™å…¥ä¸‹é¢ä»£ç å°±èƒ½æŠ›å‡ºæˆ‘ä»¬è‡ªå®šä¹‰çš„å¼‚å¸¸</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> CustomException(resultCode);</code></pre></div><h3 id="æŠ›å‡ºå¼‚å¸¸ç±»"><a href="#æŠ›å‡ºå¼‚å¸¸ç±»" class="headerlink" title="æŠ›å‡ºå¼‚å¸¸ç±»"></a>æŠ›å‡ºå¼‚å¸¸ç±»</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.framework.exception;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.ResultCode;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExceptionCast</span> </span>&#123;    <span class="hljs-comment">//ä½¿ç”¨æ­¤é™æ€æ–¹æ³•æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cast</span><span class="hljs-params">(ResultCode resultCode)</span> </span>&#123;        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> CustomException(resultCode);    &#125;&#125;</code></pre></div><h3 id="å¼‚å¸¸æ•è·ç±»"><a href="#å¼‚å¸¸æ•è·ç±»" class="headerlink" title="å¼‚å¸¸æ•è·ç±»"></a>å¼‚å¸¸æ•è·ç±»</h3><p>ä½¿ç”¨ @ControllerAdviceå’Œ@ExceptionHandleræ³¨è§£æ¥æ•è·æŒ‡å®šç±»å‹çš„å¼‚å¸¸</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.framework.exception;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.ResponseResult;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.ResultCode;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;<span class="hljs-keyword">import</span> org.slf4j.Logger;<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<span class="hljs-meta">@ControllerAdvice</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExceptionCatch</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(ExceptionCatch<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;    <span class="hljs-comment">//æ•è· CustomException å¼‚å¸¸</span>    <span class="hljs-meta">@ExceptionHandler</span>(CustomException<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span><span class="hljs-class">    @<span class="hljs-title">ResponseBody</span></span><span class="hljs-class">    <span class="hljs-title">public</span> <span class="hljs-title">ResponseResult</span> <span class="hljs-title">customException</span>(<span class="hljs-title">CustomException</span> <span class="hljs-title">e</span>)</span>&#123;        LOGGER.error(<span class="hljs-string">"catch exceptionï¼š&#123;&#125;\r\nExceptionï¼š"</span>,e.getMessage(),e);        ResultCode resultCode = e.getResultCode();        ResponseResult responseResult = <span class="hljs-keyword">new</span> ResponseResult(resultCode);        <span class="hljs-keyword">return</span> responseResult;    &#125;&#125;</code></pre></div><h3 id="å¼‚å¸¸å¤„ç†æµ‹è¯•"><a href="#å¼‚å¸¸å¤„ç†æµ‹è¯•" class="headerlink" title="å¼‚å¸¸å¤„ç†æµ‹è¯•"></a>å¼‚å¸¸å¤„ç†æµ‹è¯•</h3><h4 id="1ï¼‰å®šä¹‰é”™è¯¯ä»£ç "><a href="#1ï¼‰å®šä¹‰é”™è¯¯ä»£ç " class="headerlink" title="1ï¼‰å®šä¹‰é”™è¯¯ä»£ç "></a>1ï¼‰å®šä¹‰é”™è¯¯ä»£ç </h4><p>æ¯ä¸ªä¸šåŠ¡æ“ä½œçš„å¼‚å¸¸ä½¿ç”¨å¼‚å¸¸ä»£ç å»æ ‡è¯†ã€‚</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.framework.model.response;<span class="hljs-keyword">import</span> lombok.ToString;<span class="hljs-meta">@ToString</span><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> CmsCode implements ResultCode &#123;    CMS_ADDPAGE_EXISTS(<span class="hljs-keyword">false</span>,<span class="hljs-number">24001</span>,<span class="hljs-string">"é¡µé¢å·²å­˜åœ¨ï¼"</span>);    <span class="hljs-comment">//æ“ä½œç»“æœ</span>    <span class="hljs-keyword">boolean</span> success;    <span class="hljs-comment">//æ“ä½œä»£ç </span>    <span class="hljs-keyword">int</span> code;    <span class="hljs-comment">//æç¤ºä¿¡æ¯</span>    String message;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">CmsCode</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> success, <span class="hljs-keyword">int</span> code, String message)</span></span>&#123;        <span class="hljs-keyword">this</span>.success = success;        <span class="hljs-keyword">this</span>.code = code;        <span class="hljs-keyword">this</span>.message = message;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">success</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> success;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">code</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> code;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">message</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> message;    &#125;&#125;</code></pre></div><h4 id="2ï¼‰å¼‚å¸¸å¤„ç†æµ‹è¯•"><a href="#2ï¼‰å¼‚å¸¸å¤„ç†æµ‹è¯•" class="headerlink" title="2ï¼‰å¼‚å¸¸å¤„ç†æµ‹è¯•"></a>2ï¼‰å¼‚å¸¸å¤„ç†æµ‹è¯•</h4><p>1ã€æŠ›å‡ºå¼‚å¸¸</p><p>å›åˆ°æˆ‘ä»¬ <code>PageService</code> ä¸­çš„ <code>addCmsPage</code> æŠ›å‡ºå¼‚å¸¸</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//æ£€éªŒé¡µé¢æ˜¯å¦å·²å­˜åœ¨</span><span class="hljs-keyword">if</span> (cmsPage1 != <span class="hljs-keyword">null</span>) &#123;    <span class="hljs-comment">//æŠ›å‡ºå¼‚å¸¸</span>    ExceptionCast.cast(CmsCode.CMS_ADDPAGE_EXISTS);&#125;</code></pre></div><p>2ã€åœ¨å¯åŠ¨å·¥ç¨‹ä¸­æ‰«æå¼‚å¸¸æ•è·ç±»</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@ComponentScan</span>(basePackages = &#123;<span class="hljs-string">"com.xuecheng.framework"</span>&#125;)  <span class="hljs-comment">// æ‰«æframeworkä¸‹çš„å¼‚å¸¸æ•è·ç±»</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ManageCmsApplication</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        SpringApplication.run(ManageCmsApplication<span class="hljs-class">.<span class="hljs-keyword">class</span>,<span class="hljs-title">args</span>)</span>;    &#125;&#125;</code></pre></div><p>3ã€å‰ç«¯å±•ç¤ºå¼‚å¸¸ä¿¡æ¯</p><p>åœ¨å‰ç«¯æ–°å¢é¡µé¢çš„è¡¨å•æäº¤ä¸­å¢åŠ åˆ¤æ–­</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(res.message)&#123;<span class="hljs-keyword">this</span>.$message.error(res.message)&#125;</code></pre></div><p>å…¨éƒ¨ä»£ç å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//æäº¤è¡¨å•</span>addSubmit() &#123;  <span class="hljs-keyword">this</span>.$refs.pageForm.validate(<span class="hljs-function">(<span class="hljs-params">valid</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (valid) &#123;      <span class="hljs-keyword">this</span>.$confirm(<span class="hljs-string">'ç¡®è®¤æäº¤å—ï¼Ÿ'</span>, <span class="hljs-string">'æç¤º'</span>, &#123;&#125;).then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;        cmsApi.page_add(<span class="hljs-keyword">this</span>.pageForm).then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;          <span class="hljs-built_in">console</span>.log(res);          <span class="hljs-keyword">if</span> (res.success) &#123;            <span class="hljs-keyword">this</span>.$message(&#123;              message: <span class="hljs-string">'æäº¤æˆåŠŸ'</span>,              type: <span class="hljs-string">'success'</span>            &#125;);            <span class="hljs-keyword">this</span>.$refs[<span class="hljs-string">'pageForm'</span>].resetFields();          &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(res.message)&#123;            <span class="hljs-keyword">this</span>.$message.error(res.message)          &#125;          <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">this</span>.$message.error(<span class="hljs-string">'æäº¤å¤±è´¥'</span>);          &#125;        &#125;);      &#125;);    &#125;  &#125;)&#125;,</code></pre></div><p>æµ‹è¯•</p><p><a href="https://qnoss.codeyee.com/20200704_3/image21" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image21.png" srcset="/img/loading.gif" alt="img"></a></p><h2 id="4-ä¸å¯é¢„çŸ¥çš„å¼‚å¸¸å¤„ç†"><a href="#4-ä¸å¯é¢„çŸ¥çš„å¼‚å¸¸å¤„ç†" class="headerlink" title="4. ä¸å¯é¢„çŸ¥çš„å¼‚å¸¸å¤„ç†"></a>4. ä¸å¯é¢„çŸ¥çš„å¼‚å¸¸å¤„ç†</h2><h4 id="1ï¼‰å®šä¹‰å¼‚å¸¸æ•è·æ–¹æ³•"><a href="#1ï¼‰å®šä¹‰å¼‚å¸¸æ•è·æ–¹æ³•" class="headerlink" title="1ï¼‰å®šä¹‰å¼‚å¸¸æ•è·æ–¹æ³•"></a>1ï¼‰å®šä¹‰å¼‚å¸¸æ•è·æ–¹æ³•</h4><h5 id="æŠ›å‡ºå¼‚å¸¸æµ‹è¯•"><a href="#æŠ›å‡ºå¼‚å¸¸æµ‹è¯•" class="headerlink" title="æŠ›å‡ºå¼‚å¸¸æµ‹è¯•"></a>æŠ›å‡ºå¼‚å¸¸æµ‹è¯•</h5><p>ä½¿ç”¨postmanæµ‹è¯•æ·»åŠ é¡µé¢ï¼Œä¸è¾“å…¥cmsPostä¿¡æ¯ï¼Œæäº¤ï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs json">org.springframework.http.converter.HttpMessageNotReadableExceptionæ­¤å¼‚å¸¸æ˜¯springMVCåœ¨è¿›è¡Œå‚æ•°è½¬æ¢æ—¶æŠ¥çš„é”™è¯¯ã€‚&#123;    <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1528712906727</span>,    <span class="hljs-attr">"status"</span>: <span class="hljs-number">400</span>,    <span class="hljs-attr">"error"</span>: <span class="hljs-string">"Bad Request"</span>,    <span class="hljs-attr">"exception"</span>: <span class="hljs-string">"org.springframework.http.converter.HttpMessageNotReadableException"</span>,    <span class="hljs-attr">"message"</span>: <span class="hljs-string">"Required request body is missing: public</span><span class="hljs-string">    com.xuecheng.framework.domain.cms.response.CmsPageResult</span><span class="hljs-string">    com.xuecheng.manage_cms.web.controller.CmsPageController.add(com.xuecheng.framework.domain.cms.C</span><span class="hljs-string">    msPage)"</span>,    <span class="hljs-attr">"path"</span>: <span class="hljs-string">"/cms/page/add"</span>&#125;</code></pre></div><p>ä¸Šè¾¹çš„å“åº”ä¿¡æ¯åœ¨å®¢æˆ·ç«¯æ˜¯æ— æ³•è§£æçš„ã€‚</p><p>åœ¨å¼‚å¸¸æ•è·ç±» <code>ExceptionCatch</code> ä¸­æ·»åŠ å¯¹Exceptionå¼‚å¸¸çš„æ•è·ï¼Œä¸‹é¢å¤§è‡´çš„ä»£ç ç»“æ„ï¼š</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@ExceptionHandler</span>(Exception<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span><span class="hljs-class">@<span class="hljs-title">ResponseBody</span></span><span class="hljs-class"><span class="hljs-title">public</span> <span class="hljs-title">ResponseResult</span> <span class="hljs-title">exception</span>(<span class="hljs-title">Exception</span> <span class="hljs-title">exception</span>)</span>&#123;    <span class="hljs-comment">//è®°å½•æ—¥å¿—</span>    LOGGER.error(<span class="hljs-string">"catch exception:&#123;&#125;"</span>,exception.getMessage());    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;&#125;</code></pre></div><h5 id="å¼‚å¸¸æ•è·æ–¹æ³•"><a href="#å¼‚å¸¸æ•è·æ–¹æ³•" class="headerlink" title="å¼‚å¸¸æ•è·æ–¹æ³•"></a>å¼‚å¸¸æ•è·æ–¹æ³•</h5><p>é’ˆå¯¹ä¸Šè¾¹çš„é—®é¢˜å…¶è§£å†³æ–¹æ¡ˆæ˜¯ï¼š</p><ol><li>æˆ‘ä»¬åœ¨mapä¸­é…ç½®HttpMessageNotReadableExceptionå’Œé”™è¯¯ä»£ç ã€‚</li><li>åœ¨å¼‚å¸¸æ•è·ç±»ä¸­å¯¹Exceptionå¼‚å¸¸è¿›è¡Œæ•è·ï¼Œå¹¶ä»mapä¸­è·å–å¼‚å¸¸ç±»å‹å¯¹åº”çš„é”™è¯¯ä»£ç ï¼Œå¦‚æœå­˜åœ¨é”™è¯¯ä»£ç åˆ™è¿”å›æ­¤é”™è¯¯ï¼Œå¦åˆ™ç»Ÿä¸€è¿”å›99999é”™è¯¯ã€‚</li></ol><p>å…·ä½“çš„å¼€å‘å®ç°å¦‚ä¸‹ï¼š</p><p>1ã€åœ¨é€šç”¨é”™è¯¯ä»£ç ç±»CommCodeä¸­é…ç½®éæ³•å‚æ•°å¼‚å¸¸</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@ToString</span><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> CommonCode implements ResultCode&#123;    INVALID_PARAM(<span class="hljs-keyword">false</span>,<span class="hljs-number">10003</span>,<span class="hljs-string">"éæ³•å‚æ•°ï¼"</span>),    <span class="hljs-comment">/**å…¶ä»–ä»£ç çœç•¥**/</span>&#125;</code></pre></div><p>2ã€åœ¨å¼‚å¸¸æ•è·ç±»ä¸­é…ç½® HttpMessageNotReadableException ä¸ºéæ³•å‚æ•°å¼‚å¸¸ã€‚</p><p>å…·ä½“çš„è¯´æ˜æˆ‘éƒ½å†™åœ¨æ³¨é‡Šå½“ä¸­äº†ï¼Œå°±ä¸å¤šåšè§£é‡Šï¼Œç›´æ¥çœ‹ä»£ç </p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.framework.exception;<span class="hljs-keyword">import</span> com.google.common.collect.ImmutableMap;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.CommonCode;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.ResponseResult;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.ResultCode;<span class="hljs-keyword">import</span> org.slf4j.Logger;<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<span class="hljs-keyword">import</span> org.springframework.http.converter.HttpMessageNotReadableException;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;<span class="hljs-comment">/**</span><span class="hljs-comment"> * ç»Ÿä¸€å¼‚å¸¸æ•è·ç±»</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.JK</span><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-08-09  11:12</span><span class="hljs-comment"> */</span><span class="hljs-meta">@ControllerAdvice</span><span class="hljs-comment">//æ§åˆ¶å™¨å¢å¼º</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExceptionCatch</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(ExceptionCatch<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;    <span class="hljs-comment">//å®šä¹‰mapï¼Œé…ç½®å¼‚å¸¸ç±»å‹æ‰€å¯¹åº”çš„é”™è¯¯ä»£ç ï¼ˆImmutableMap åªè¯»ï¼Œçº¿ç¨‹å®‰å…¨</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ImmutableMap&lt;Class&lt;? extends Throwable&gt;,ResultCode&gt; EXCEPTIONS;    <span class="hljs-comment">//å®šä¹‰mapçš„builderå¯¹è±¡ï¼Œå»æ„å»ºimmutablemap</span>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">static</span> ImmutableMap.Builder&lt;Class&lt;? extends Throwable&gt;,ResultCode&gt; builder = ImmutableMap.builder();    <span class="hljs-comment">//æ•è·CustomExceptionç±»çš„å¼‚å¸¸</span>    <span class="hljs-meta">@ExceptionHandler</span>(CustomException<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span><span class="hljs-class">    <span class="hljs-title">public</span> <span class="hljs-title">ResponseResult</span> <span class="hljs-title">customException</span>(<span class="hljs-title">CustomException</span> <span class="hljs-title">customException</span>)</span>&#123;        <span class="hljs-comment">//è®°å½•æ—¥å¿—</span>        LOGGER.error(<span class="hljs-string">"catch exception:&#123;&#125;"</span>,customException.getMessage());        ResultCode resultCode = customException.getResultCode();        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ResponseResult(resultCode);    &#125;    <span class="hljs-comment">//æ•è·Exceptionç±»çš„å¼‚å¸¸</span>    <span class="hljs-meta">@ExceptionHandler</span>(Exception<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span><span class="hljs-class">    @<span class="hljs-title">ResponseBody</span></span><span class="hljs-class">    <span class="hljs-title">public</span> <span class="hljs-title">ResponseResult</span> <span class="hljs-title">exception</span>(<span class="hljs-title">Exception</span> <span class="hljs-title">exception</span>)</span>&#123;        <span class="hljs-comment">//è®°å½•æ—¥å¿—</span>        LOGGER.error(<span class="hljs-string">"catch exception:&#123;&#125;"</span>,exception.getMessage());        <span class="hljs-keyword">if</span> (EXCEPTIONS == <span class="hljs-keyword">null</span>)&#123;            EXCEPTIONS = builder.build();<span class="hljs-comment">//EXCEPTIONSæ„å»ºæˆåŠŸ</span>        &#125;        <span class="hljs-comment">//ä»EXCEPTIONSä¸­æ‰¾å‡ºå¼‚å¸¸ç±»å‹æ‰€å¯¹åº”çš„é”™è¯¯ä»£ç ï¼Œå¦‚æœæ‰¾åˆ°äº†å°†é”™è¯¯ä»£ç å“åº”ç»™ç”¨æˆ·</span>        <span class="hljs-comment">// å¦‚æœæ‰¾ä¸åˆ°ç»™ç”¨æˆ·å“åº”99999å¼‚å¸¸</span>        ResultCode resultCode = EXCEPTIONS.get(exception.getClass());        <span class="hljs-keyword">if</span> (resultCode != <span class="hljs-keyword">null</span>)&#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ResponseResult(resultCode);        &#125;<span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">//å¦‚æœéé¢„å®šä¹‰çš„é”™è¯¯ï¼Œåˆ™è¿”å›æœåŠ¡å™¨é”™è¯¯</span>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ResponseResult(CommonCode.SERVER_ERROR);        &#125;    &#125;    <span class="hljs-keyword">static</span> &#123;        builder.put(HttpMessageNotReadableException<span class="hljs-class">.<span class="hljs-keyword">class</span>,<span class="hljs-title">CommonCode</span>.<span class="hljs-title">INVALID_PARAM</span>)</span>;    &#125;&#125;</code></pre></div><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œæ˜¯å¦èƒ½æˆåŠŸæ•æŠ“åˆ°è¯¥å¼‚å¸¸</p><p><a href="https://qnoss.codeyee.com/20200704_3/image22" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image22.png" srcset="/img/loading.gif" alt="img"></a></p><p>æˆ‘ä»¬æ”¹æˆ GET è¯·æ±‚è¿›è¡Œæµ‹è¯•ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰é¢„å®šè¿™ç§å¼‚å¸¸çš„é”™è¯¯ä»£ç ï¼Œæ‰€ä»¥ç»Ÿä¸€è¿”å›99999é”™è¯¯ä»£ç </p><p><a href="https://qnoss.codeyee.com/20200704_3/image23" target="_blank" rel="noopener"><img src="/2020/08/09/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday03/image23.png" srcset="/img/loading.gif" alt="img"></a></p>]]></content>
    
    
    <categories>
      
      <category>å­¦æˆåœ¨çº¿</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Spring Data MongoDB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å­¦æˆåœ¨çº¿day02</title>
    <link href="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/"/>
    <url>/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ"><a href="#ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ" class="headerlink" title="ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ"></a>ğŸ˜çŸ¥è¯†ç‚¹æ¦‚è§ˆ</h1><blockquote><p>ä¸ºäº†æ–¹ä¾¿åç»­å›é¡¾è¯¥é¡¹ç›®æ—¶èƒ½å¤Ÿæ¸…æ™°çš„çŸ¥é“æœ¬ç« èŠ‚è®²äº†å“ªäº›å†…å®¹ï¼Œå¹¶ä¸”èƒ½å¤Ÿä»è¯¥ç« èŠ‚çš„ç¬”è®°ä¸­å¾—åˆ°ä¸€äº›å¸®åŠ©ï¼Œæ‰€ä»¥åœ¨å®Œæˆæœ¬ç« èŠ‚çš„å­¦ä¹ ååœ¨æ­¤å¯¹æœ¬ç« èŠ‚æ‰€æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹è¿›è¡Œæ€»ç»“æ¦‚è¿°ã€‚</p></blockquote><p>æœ¬ç« èŠ‚ä¸ºã€å­¦æˆåœ¨çº¿ã€‘é¡¹ç›®çš„ <code>day02</code> çš„å†…å®¹</p><ul><li><code>vue</code> åŸºç¡€è¯­æ³•</li><li>å¯¹ <code>webpack</code>ä¸ <code>webpack-dev-server</code> çš„åŸºæœ¬ä½¿ç”¨ï¼Œç†è§£ <code>webpack</code> çš„æ‰“åŒ…è¿‡ç¨‹ã€‚</li><li><code>CMS</code> å‰ç«¯å·¥ç¨‹çš„åŸºç¡€æ„å»º</li><li>è§£å†³å‰ç«¯è·¨åŸŸè¯·æ±‚çš„é—®é¢˜ï¼Œå¹¶ç†è§£å‰ç«¯è¯·æ±‚æ•°æ®çš„æµç¨‹ã€‚</li><li>é…åˆä½¿ç”¨ <code>Element-UI</code> çš„ <code>table</code> ç»„ä»¶è¿›è¡Œåˆ†é¡µæŸ¥è¯¢</li></ul><h1 id="ä¸€ã€vueåŸºç¡€"><a href="#ä¸€ã€vueåŸºç¡€" class="headerlink" title="ä¸€ã€vueåŸºç¡€"></a>ä¸€ã€vueåŸºç¡€</h1><p>vueåŸºç¡€éƒ¨åˆ†å†…å®¹çš„ç¬”è®°ç•¥è¿‡ï¼Œå¦‚è¿‡ä½ ä»éœ€è¦è¯¥é˜¶æ®µçš„å­¦ä¹ ï¼Œé˜…è¯»å®˜æ–¹çš„è®²ä¹‰æˆ–è€…ç§»æ­¥ï¼š<a href="https://cn.vuejs.org/v2/guide/" target="_blank" rel="noopener">https://cn.vuejs.org/v2/guide/</a> è¿›è¡Œé˜…è¯»å’Œç»ƒä¹ ã€‚</p><h1 id="äºŒã€webpackå…¥é—¨"><a href="#äºŒã€webpackå…¥é—¨" class="headerlink" title="äºŒã€webpackå…¥é—¨"></a>äºŒã€webpackå…¥é—¨</h1><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h2><p>ä½¿ç”¨vue.jså¼€å‘å¤§å‹åº”ç”¨éœ€è¦ä½¿ç”¨ <code>webpack</code> æ‰“åŒ…å·¥å…·ï¼Œæœ¬èŠ‚ç ”ç©¶webpackçš„ä½¿ç”¨æ–¹æ³•ã€‚</p><p>Webpack æ˜¯ä¸€ä¸ªå‰ç«¯èµ„æºçš„æ‰“åŒ…å·¥å…·ï¼Œå®ƒå¯ä»¥å°†jsã€imageã€cssç­‰èµ„æºå½“æˆä¸€ä¸ªæ¨¡å—è¿›è¡Œæ‰“åŒ…ã€‚</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image7.png" srcset="/img/loading.gif" alt></p><h2 id="2-ä½¿ç”¨webpackæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ"><a href="#2-ä½¿ç”¨webpackæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ" class="headerlink" title="2. ä½¿ç”¨webpackæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ"></a>2. ä½¿ç”¨webpackæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ</h2><p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒWebpack å¯ä»¥å°†jsã€cssã€pngç­‰å¤šç§é™æ€èµ„æº è¿›è¡Œæ‰“åŒ…</p><ul><li>æ¨¡å—åŒ–å¼€å‘<br>ç¨‹åºå‘˜åœ¨å¼€å‘æ—¶å¯ä»¥åˆ†æ¨¡å—åˆ›å»ºä¸åŒçš„jsã€ cssç­‰å°æ–‡ä»¶æ–¹ä¾¿å¼€å‘ï¼Œæœ€åä½¿ç”¨webpackå°†è¿™äº›å°æ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ªæ–‡<br>ä»¶ï¼Œå‡å°‘äº†httpçš„è¯·æ±‚æ¬¡æ•°ã€‚<br>webpackå¯ä»¥å®ç°æŒ‰éœ€æ‰“åŒ…ï¼Œä¸ºäº†é¿å…å‡ºç°æ‰“åŒ…æ–‡ä»¶è¿‡å¤§å¯ä»¥æ‰“åŒ…æˆå¤šä¸ªæ–‡ä»¶ã€‚</li><li>ç¼–è¯‘typescriptã€ES6ç­‰é«˜çº§jsè¯­æ³•<br>éšç€å‰ç«¯æŠ€æœ¯çš„å¼ºå¤§ï¼Œå¼€å‘ä¸­å¯ä»¥ä½¿ç”¨javascriptçš„å¾ˆå¤šé«˜çº§ç‰ˆæœ¬ï¼Œæ¯”å¦‚ï¼štypescriptã€ES6ç­‰ï¼Œæ–¹ä¾¿å¼€å‘ï¼Œ<br>webpackå¯ä»¥å°†æ‰“åŒ…æ–‡ä»¶è½¬æ¢æˆæµè§ˆå™¨å¯è¯†åˆ«çš„jsè¯­æ³•ã€‚</li><li>CSSé¢„ç¼–è¯‘<br>webpackå…è®¸åœ¨å¼€å‘ä¸­ä½¿ç”¨Sass å’Œ Lessç­‰åŸç”ŸCSSçš„æ‰©å±•æŠ€æœ¯ï¼Œé€šè¿‡sass-loaderã€less-loaderå°†Sass å’Œ Lessçš„<br>è¯­æ³•ç¼–è¯‘æˆæµè§ˆå™¨å¯è¯†åˆ«çš„cssè¯­æ³•ã€‚</li></ul><h2 id="3-webpackçš„ç¼ºç‚¹"><a href="#3-webpackçš„ç¼ºç‚¹" class="headerlink" title="3. webpackçš„ç¼ºç‚¹"></a>3. webpackçš„ç¼ºç‚¹</h2><p>1ã€é…ç½®æœ‰äº›ç¹ç<br>2ã€æ–‡æ¡£ä¸ä¸°å¯Œ</p><h2 id="4-å®‰è£…-npm"><a href="#4-å®‰è£…-npm" class="headerlink" title="4.å®‰è£… npm"></a>4.å®‰è£… npm</h2><p><code>node.js</code> å·²ç»é›†æˆäº†npmå·¥å…·ï¼Œåœ¨å‘½ä»¤æç¤ºç¬¦è¾“å…¥ npm -v å¯æŸ¥çœ‹å½“å‰npmç‰ˆæœ¬ï¼Œnodeå¯ä»¥ç›´æ¥å»å®˜ç½‘ä¸‹è½½å®‰è£…</p><p>è®¾ç½®åŒ…è·¯å¾„</p><div class="hljs"><pre><code class="hljs shell">npm config set prefix "C:\Program Files\nodejs\npm_modules"npm config set cache "c:\Program Files\nodejs\npm_cache"</code></pre></div><h2 id="5-å®‰è£…-cnpm"><a href="#5-å®‰è£…-cnpm" class="headerlink" title="5. å®‰è£… cnpm"></a>5. å®‰è£… cnpm</h2><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><div class="hljs"><pre><code class="hljs shell">npm install -g cnpm --registry=https://registry.npm.taobao.org</code></pre></div><p>å®‰è£…å®Œæˆåæ‰§è¡Œå‘½ä»¤ <code>cnpm -v</code></p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image8.png" srcset="/img/loading.gif" alt></p><h2 id="6-å®‰è£…-webpack"><a href="#6-å®‰è£…-webpack" class="headerlink" title="6. å®‰è£… webpack"></a>6. å®‰è£… webpack</h2><p><strong>node.js å®‰è£…åŒ…åˆ†ä¸ºä¸¤ç§æ¨¡å¼</strong></p><ul><li>æœ¬åœ°å®‰è£…ï¼šä»…å°†webpackå®‰è£…åœ¨å½“å‰é¡¹ç›®çš„node_modulesç›®å½•ä¸­ï¼Œä»…å¯¹å½“å‰é¡¹ç›®æœ‰æ•ˆã€‚</li><li>å…¨å±€å®‰è£…ï¼šå°†webpackå®‰è£…åœ¨æœ¬æœºï¼Œå¯¹æ‰€æœ‰é¡¹ç›®æœ‰æ•ˆï¼Œå…¨å±€å®‰è£…ä¼šé”å®šä¸€ä¸ªwebpackç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å¯èƒ½ä¸é€‚ç”¨æŸä¸ªé¡¹ç›®ã€‚å…¨å±€å®‰è£…éœ€è¦æ·»åŠ  -g å‚æ•°</li></ul><p><strong>æœ¬åœ°å®‰è£…</strong></p><div class="hljs"><pre><code class="hljs shell">npm install --save-dev webpack æˆ– cnpm install --save-dev webpacknpm install --save-dev webpack-cli (4.0ä»¥åçš„ç‰ˆæœ¬éœ€è¦å®‰è£…webpack-cli)</code></pre></div><p><strong>å…¨å±€å®‰è£…</strong></p><p>å…¨å±€å®‰è£…åŠ -gï¼Œå¦‚ä¸‹ï¼šå…¨å±€å®‰è£…å°±å°†webpackçš„jsåŒ…ä¸‹è½½åˆ°npmçš„åŒ…è·¯å¾„ä¸‹ã€‚</p><div class="hljs"><pre><code class="hljs shell">npm install webpack -g æˆ– cnpm install webpack -g</code></pre></div><p><strong>å®‰è£… webpack æŒ‡å®šçš„ç‰ˆæœ¬ï¼š</strong><br>è¿›å…¥webpacktestæµ‹è¯•ç›®å½•ï¼Œè¿è¡Œï¼š<code>cnpm install --save-dev webpack@3.6.0</code><br>å…¨å±€å®‰è£…ï¼š<code>npm install webpack@3.6.0 -g</code> æˆ– <code>cnpm install webpack@3.6.0 -g</code></p><h2 id="7-å…¥é—¨ç¨‹åº"><a href="#7-å…¥é—¨ç¨‹åº" class="headerlink" title="7. å…¥é—¨ç¨‹åº"></a>7. å…¥é—¨ç¨‹åº</h2><p>é€šè¿‡æœ¬å…¥é—¨ç¨‹åºä½“ä¼šwebpackæ‰“åŒ…çš„è¿‡ç¨‹åŠæ¨¡å—åŒ–å¼€å‘çš„æ€æƒ³ã€‚</p><h3 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h3><p>é€šè¿‡å…¥é—¨ç¨‹åºå®ç°å¯¹jsæ–‡ä»¶çš„æ‰“åŒ…ï¼Œä½“ä¼šwebpackæ˜¯å¦‚ä½•å¯¹åº”ç”¨è¿›è¡Œæ¨¡å—åŒ–ç®¡ç†ã€‚<br>å¯¹ä¸Šè¾¹1+1=2çš„ä¾‹å­ä½¿ç”¨webpackè¿›è¡Œæ¨¡å—åŒ–ç®¡ç†</p><h3 id="å®šä¹‰-model01-js"><a href="#å®šä¹‰-model01-js" class="headerlink" title="å®šä¹‰ model01.js"></a>å®šä¹‰ model01.js</h3><p>åœ¨<code>webpacktest01</code>ç›®å½•ä¸‹åˆ›å»º<code>model01.js</code></p><p>å°†æœ¬ç¨‹åºä½¿ç”¨çš„åŠ æ³•è¿ç®—çš„jsæ–¹æ³•æŠ½å–åˆ°ä¸€ä¸ªjsæ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å— ï¼Œä»£ç å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs javascript"><span class="hljs-comment">//å®šä¹‰addå‡½æ•°</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">x, y</span>) </span>&#123;    <span class="hljs-keyword">return</span> x+y;&#125;<span class="hljs-comment">//å¯¼å‡ºaddå‡½æ•°</span><span class="hljs-built_in">module</span>.exports.add = add;</code></pre></div><h3 id="å®šä¹‰main-js"><a href="#å®šä¹‰main-js" class="headerlink" title="å®šä¹‰main.js"></a>å®šä¹‰main.js</h3><p>åœ¨<code>webpacktest01</code>ç›®å½•ä¸‹åˆ›å»º<code>main.js</code>ï¼Œ<code>main.js</code>æ˜¯æœ¬ç¨‹åºçš„jsä¸»æ–‡ä»¶ï¼ŒåŒ…æ‹¬å¦‚ä¸‹å†…å®¹ï¼š</p><p>1ã€åœ¨æ­¤æ–‡ä»¶ä¸­ä¼šå¼•ç”¨model01.jsæ¨¡å—<br>2ã€å¼•ç”¨vue.min.jsï¼ˆå®ƒä¹Ÿä¸€ä¸ªæ¨¡å—ï¼‰<br>3ã€å°†htmlé¡µé¢ä¸­æ„å»ºvueå®ä¾‹çš„ä»£ç æ”¾åœ¨main.jsä¸­ã€‚</p><div class="hljs"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> &#123;add&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./model01.js"</span>)<span class="hljs-keyword">var</span> Vue = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./vue.min"</span>)<span class="hljs-comment">// å®ä¾‹åŒ–Vueå¯¹è±¡</span><span class="hljs-comment">//vm :å«åšMVVMä¸­çš„ View Model</span><span class="hljs-keyword">var</span> VM = <span class="hljs-keyword">new</span> Vue(&#123;    el:<span class="hljs-string">"#app"</span>,<span class="hljs-comment">//è¡¨ç¤ºå½“å‰vueå¯¹è±¡æ¥ç®¡appçš„divåŒºåŸŸ</span>    data:&#123;        name:<span class="hljs-string">'é»‘é©¬ç¨‹åºå‘˜'</span>,<span class="hljs-comment">// ç›¸å½“äºæ˜¯MVVMä¸­çš„Modelè¿™ä¸ªè§’è‰²</span>        num1:<span class="hljs-number">0</span>,        num2:<span class="hljs-number">0</span>,        result:<span class="hljs-number">0</span>,        url:<span class="hljs-string">'http://www.itcast.cn'</span>    &#125;,    methods:&#123;        change:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;            <span class="hljs-keyword">this</span>.result = add(<span class="hljs-built_in">Number</span>.parseInt(<span class="hljs-keyword">this</span>.num1),<span class="hljs-built_in">Number</span>.parseInt(<span class="hljs-keyword">this</span>.num2));        &#125;    &#125;&#125;);</code></pre></div><h3 id="æ‰“åŒ…æµ‹è¯•"><a href="#æ‰“åŒ…æµ‹è¯•" class="headerlink" title="æ‰“åŒ…æµ‹è¯•"></a>æ‰“åŒ…æµ‹è¯•</h3><p>ä¸Šè¾¹å°† <code>mode01.js</code> æ¨¡å—åŠ <code>main.js</code> ä¸»æ–‡ä»¶ç¼–å†™å®Œæˆï¼Œä¸‹è¾¹ä½¿ç”¨ <code>webpack</code> å¯¹è¿™äº›jsæ–‡ä»¶è¿›è¡Œæ‰“åŒ…</p><p>1ã€è¿›å…¥ç¨‹åºç›®å½•ï¼Œæ‰§è¡Œ <code>webpack main.js -o build.js</code> ï¼Œè¿™æ®µæŒ‡ä»¤è¡¨ç¤ºå°† <code>main.js</code> æ‰“åŒ…è¾“å‡ºä¸º <code>build.js</code> æ–‡ä»¶æ‰§è¡Œå®Œæˆï¼Œè§‚å¯Ÿç¨‹åºç›®å½•æ˜¯å¦å‡ºç° <code>build.js</code>ã€‚</p><p>2ã€åœ¨åˆ›å»ºä¸€ä¸ªhtml ï¼Œè¿™é‡Œæˆ‘å‘½åä¸º <code>vue_02.html</code> å¹¶ ä¸­å¼•ç”¨ <code>build.js</code></p><div class="hljs"><pre><code class="hljs java">&lt;!DOCTYPE html&gt;&lt;html lang=<span class="hljs-string">"en"</span> xmlns:v-on=<span class="hljs-string">"http://www.w3.org/1999/xhtml"</span>&gt;&lt;head&gt;    &lt;meta http-equiv=<span class="hljs-string">"Content-Type"</span> content=<span class="hljs-string">"text/html; charset=utf-8"</span> /&gt;    &lt;title&gt;vue.jså…¥é—¨ç¨‹åº&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div id=<span class="hljs-string">"app"</span>&gt;    &#123;&#123;name&#125;&#125;    &lt;input type=<span class="hljs-string">"text"</span> v-model=<span class="hljs-string">"num1"</span>&gt;+    &lt;input type=<span class="hljs-string">"text"</span> v-model=<span class="hljs-string">"num2"</span>&gt;=    &lt;input type=<span class="hljs-string">"text"</span> v-model=<span class="hljs-string">"result"</span>&gt;    &lt;button v-on:click="change"&gt;è®¡ç®—&lt;/button&gt;&lt;/div&gt;&lt;/body&gt;&lt;script src="build.js"&gt;&lt;/script&gt;&lt;/html&gt;</code></pre></div><h3 id="è¿è¡Œhtml"><a href="#è¿è¡Œhtml" class="headerlink" title="è¿è¡Œhtml"></a>è¿è¡Œhtml</h3><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image9.png" srcset="/img/loading.gif" alt></p><h1 id="ä¸‰ã€webpack-dev-server"><a href="#ä¸‰ã€webpack-dev-server" class="headerlink" title="ä¸‰ã€webpack-dev-server"></a>ä¸‰ã€webpack-dev-server</h1><h2 id="1-æµ‹è¯•ç¯å¢ƒæ­å»º"><a href="#1-æµ‹è¯•ç¯å¢ƒæ­å»º" class="headerlink" title="1. æµ‹è¯•ç¯å¢ƒæ­å»º"></a>1. æµ‹è¯•ç¯å¢ƒæ­å»º</h2><p><code>webpack-dev-server</code> å¼€å‘æœåŠ¡å™¨ï¼Œå®ƒçš„åŠŸèƒ½å¯ä»¥å®ç°çƒ­åŠ è½½ å¹¶ä¸”è‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨ã€‚</p><p>åˆ›å»ºä¸€ä¸ªæ–°çš„ç¨‹åºç›®å½•ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ›å»º <code>webpacktest02</code> ç›®å½•ï¼Œå°† <code>webpack</code> å…¥é—¨ç¨‹åº( <code>webpacktest01</code> )çš„ä»£ç æ‹·è´è¿›æ¥ï¼Œå¹¶åœ¨ç›®å½•ä¸‹åˆ›å»º <code>src</code> ç›®å½•ã€<code>dist</code> ç›®å½•ï¼Œå¹¶å°†main.jså’Œmodel01.jsæ‹·è´åˆ°srcç›®å½•ã€‚</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image10.png" srcset="/img/loading.gif" alt></p><h2 id="2-å®‰è£…é…ç½®"><a href="#2-å®‰è£…é…ç½®" class="headerlink" title="2. å®‰è£…é…ç½®"></a>2. å®‰è£…é…ç½®</h2><h3 id="å®‰è£…webpack-dev-server"><a href="#å®‰è£…webpack-dev-server" class="headerlink" title="å®‰è£…webpack-dev-server"></a>å®‰è£…webpack-dev-server</h3><p>ä½¿ç”¨ <code>webpack-dev-server</code> éœ€è¦å®‰è£…webpackã€ webpack-dev-server å’Œ html-webpack-pluginä¸‰ä¸ªåŒ…ã€‚</p><div class="hljs"><pre><code class="hljs shell">cnpm install webpackwebpack-dev-server html-webpack-plugin</code></pre></div><p>å®‰è£…å®Œæˆï¼Œä¼šå‘ç°ç¨‹åºç›®å½•å‡ºç°ä¸€ä¸ªpackage.jsonæ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶ä¸­è®°å½•äº†ç¨‹åºçš„ä¾èµ–ã€‚</p><h3 id="é…ç½®webpack-dev-server"><a href="#é…ç½®webpack-dev-server" class="headerlink" title="é…ç½®webpack-dev-server"></a>é…ç½®webpack-dev-server</h3><p>åœ¨package.jsonä¸­é…ç½®script</p><div class="hljs"><pre><code class="hljs json">"scripts": &#123;  "dev": "webpack-dev-server --inline --hot --open --port 5008"&#125;</code></pre></div><p>â€“inlineï¼šè‡ªåŠ¨åˆ·æ–°<br>â€“hotï¼šçƒ­åŠ è½½<br>â€“portï¼šæŒ‡å®šç«¯å£<br>â€“openï¼šè‡ªåŠ¨åœ¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€<br>â€“hostï¼šå¯ä»¥æŒ‡å®šæœåŠ¡å™¨çš„ ipï¼Œä¸æŒ‡å®šåˆ™ä¸º127.0.0.1ï¼Œå¦‚æœå¯¹å¤–å‘å¸ƒåˆ™å¡«å†™å…¬ç½‘ipåœ°å€</p><p>æ­¤æ—¶package.jsonçš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs json">&#123;  <span class="hljs-attr">"devDependencies"</span>: &#123;    <span class="hljs-attr">"html-webpack-plugin"</span>: <span class="hljs-string">"^3.2.0"</span>,    <span class="hljs-attr">"webpack-dev-server"</span>: <span class="hljs-string">"^3.10.3"</span>  &#125;,  <span class="hljs-attr">"scripts"</span>: &#123;    <span class="hljs-attr">"dev"</span>: <span class="hljs-string">"webpack-dev-server --inline --hot --open --port 5008"</span>  &#125;&#125;</code></pre></div><blockquote><p>devDependenciesï¼šå¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­æ‰€éœ€è¦çš„ä¾èµ–ã€‚<br>scriptsï¼šå¯æ‰§è¡Œçš„å‘½ä»¤</p></blockquote><h2 id="3-webpack-config-js"><a href="#3-webpack-config-js" class="headerlink" title="3. webpack.config.js"></a>3. webpack.config.js</h2><p>åœ¨ <code>webpacktest02</code> ç›®å½•ä¸‹åˆ›å»º <code>webpack.config.js</code>ï¼Œ <code>webpack.config.js</code> æ˜¯ <code>webpack</code> çš„é…ç½®æ–‡ä»¶ã€‚</p><p>åœ¨æ­¤æ–‡ä»¶ä¸­å¯ä»¥é…ç½®åº”ç”¨çš„å…¥å£æ–‡ä»¶ã€è¾“å‡ºé…ç½®ã€æ’ä»¶ç­‰ï¼Œå…¶ä¸­è¦å®ç°çƒ­åŠ è½½è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½éœ€è¦é…ç½® <code>html-webpack-plugin</code> æ’ä»¶ã€‚</p><p><code>html-webpack-plugin</code> çš„ä½œç”¨æ˜¯æ ¹æ® <code>html</code> æ¨¡æ¿åœ¨å†…å­˜ç”Ÿæˆ <code>html</code> æ–‡ä»¶ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯æ ¹æ®æ¨¡æ¿æ–‡ä»¶åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ª <code>index.html</code> æ–‡ä»¶ã€‚</p><h3 id="é…ç½®æ¨¡æ¿æ–‡ä»¶"><a href="#é…ç½®æ¨¡æ¿æ–‡ä»¶" class="headerlink" title="é…ç½®æ¨¡æ¿æ–‡ä»¶"></a>é…ç½®æ¨¡æ¿æ–‡ä»¶</h3><p>å°†åŸæ¥çš„ <code>vue_02.html</code> ä½œä¸ºæ¨¡æ¿æ–‡ä»¶ï¼Œä¸ºäº†å’Œå†…å­˜ä¸­çš„ <code>index.html</code> æ–‡ä»¶ååŒºåˆ«ï¼Œæ³¨æ„å°† <code>vue_02.html</code> ä¸­çš„<code>script</code> æ ‡ç­¾å»æ‰ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span> <span class="hljs-attr">xmlns:v-on</span>=<span class="hljs-string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"Content-Type"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"text/html; charset=utf-8"</span> /&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>vue.jså…¥é—¨ç¨‹åº<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>    &#123;&#123;name&#125;&#125;    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"num1"</span>&gt;</span>+    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"num2"</span>&gt;</span>=<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"result"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">"change"</span>&gt;</span>è®¡ç®—<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><h3 id="é…ç½®-html-webpack-plugin"><a href="#é…ç½®-html-webpack-plugin" class="headerlink" title="é…ç½® html-webpack-plugin"></a>é…ç½® html-webpack-plugin</h3><p>åœ¨ <code>webpack.config.js</code> ä¸­é…ç½® <code>html-webpack-plugin</code> æ’ä»¶</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">var</span> htmlwp = require(<span class="hljs-string">'html-webpack-plugin'</span>);<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span>=&#123;    entry:<span class="hljs-string">'./src/main.js'</span>, <span class="hljs-comment">//æŒ‡å®šæ‰“åŒ…çš„å…¥å£æ–‡ä»¶</span>    output:&#123;        path : __dirname + <span class="hljs-string">'/dist'</span>, <span class="hljs-comment">// æ³¨æ„ï¼š__dirnameè¡¨ç¤ºwebpack.config.jsæ‰€åœ¨ç›®å½•çš„ç»å¯¹è·¯å¾„</span>        filename:<span class="hljs-string">'build.js'</span> <span class="hljs-comment">//è¾“å‡ºæ–‡ä»¶</span>    &#125;,    plugins:[        <span class="hljs-keyword">new</span> htmlwp(&#123;            <span class="hljs-comment">//ç”Ÿæˆçš„é¡µé¢æ ‡é¢˜&lt;head&gt;&lt;title&gt;é¦–é¡µ&lt;/title&gt;&lt;/head&gt;</span>            title: <span class="hljs-string">'é¦–é¡µ'</span>,            <span class="hljs-comment">//webpack-dev-serveråœ¨å†…å­˜ä¸­ç”Ÿæˆçš„æ–‡ä»¶åç§°ï¼Œè‡ªåŠ¨å°†buildæ³¨å…¥åˆ°è¿™ä¸ªé¡µé¢åº•éƒ¨æ‰èƒ½å®ç°è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½</span>            filename: <span class="hljs-string">'index.html'</span>,            <span class="hljs-comment">//æ ¹æ®vue_02.htmlè¿™ä¸ªæ¨¡æ¿æ¥ç”Ÿæˆ(è¿™ä¸ªæ–‡ä»¶è¯·ç¨‹åºå‘˜è‡ªå·±ç”Ÿæˆ)</span>            template: <span class="hljs-string">'vue_02.html'</span>        &#125;)    ]&#125;</code></pre></div><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><p>å¯åŠ¨æ–‡ä»¶ï¼š<br>1ã€è¿›å…¥ <code>webpacktest02</code>ç›®å½•ï¼Œæ‰§è¡Œ<code>npm run dev</code><br>2ã€ä½¿ç”¨webstormï¼Œå³é”®<code>package.json</code>æ–‡ä»¶ï¼Œé€‰æ‹© â€œShow npm Scriptsâ€</p><p>æ‰“å¼€çª—å£ï¼š</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image11.png" srcset="/img/loading.gif" alt></p><p>åŒå‡» <code>dev</code>ã€‚<br>æ³¨æ„ï¼šdev å°±æ˜¯åœ¨ <code>package.json</code> ä¸­é…ç½®çš„ <code>webpack dev server</code> å‘½ä»¤ã€‚<br>å‘ç°å¯åŠ¨æˆåŠŸè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ã€‚<br>ä¿®æ”¹srcä¸­çš„ä»»æ„æ–‡ä»¶å†…å®¹ï¼Œè‡ªåŠ¨åŠ è½½å¹¶åˆ·æ–°æµè§ˆå™¨ã€‚</p><h3 id="debugè°ƒè¯•"><a href="#debugè°ƒè¯•" class="headerlink" title="debugè°ƒè¯•"></a>debugè°ƒè¯•</h3><p>ä½¿ç”¨äº† <code>webpack</code> ä¹‹åå°±ä¸èƒ½é‡‡ç”¨ä¼ ç»Ÿjsçš„è°ƒè¯•æ–¹æ³•åœ¨ <code>chrome</code> ä¸­æ‰“æ–­ç‚¹ã€‚</p><p><code>webpack</code> å°†å¤šä¸ªæºæ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”æ–‡ä»¶çš„å†…å®¹äº§ç”Ÿäº†å¾ˆå¤§çš„å˜åŒ–ï¼Œ<code>webpack</code> æä¾› <code>devtool</code> è¿›è¡Œè°ƒè¯•ï¼Œ<code>devtool</code> æ˜¯åŸºäº <code>sourcemap</code> çš„æ–¹å¼ï¼Œåœ¨è°ƒè¯•æ—¶ä¼šç”Ÿæˆä¸€ä¸ª <code>map</code> æ–‡ä»¶ï¼Œå…¶å†…å®¹è®°å½•ç”Ÿæˆæ–‡ä»¶å’Œæºæ–‡ä»¶çš„å†…å®¹æ˜ å°„ï¼Œå³ç”Ÿæˆæ–‡ä»¶ä¸­çš„å“ªä¸ªä½ç½®å¯¹åº”æºæ–‡ä»¶ä¸­çš„å“ªä¸ªä½ç½®ï¼Œæœ‰äº† <code>sourcemap</code> å°±å¯ä»¥åœ¨è°ƒè¯•æ—¶çœ‹åˆ°æºä»£ç ã€‚</p><p><strong>é…ç½®å¦‚ä¸‹</strong></p><p>1ã€åœ¨webpack.config.jsä¸­é…ç½®ï¼š</p><div class="hljs"><pre><code class="hljs js">devtool: <span class="hljs-string">'evalâ€sourceâ€map'</span>,</code></pre></div><p>devtool: â€˜evalâ€sourceâ€mapâ€™,</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-keyword">var</span> htmlwp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'htmlâ€webpackâ€plugin'</span>);    <span class="hljs-built_in">module</span>.exports=&#123;    entry:<span class="hljs-string">'./src/main.js'</span>, <span class="hljs-comment">//æŒ‡å®šæ‰“åŒ…çš„å…¥å£æ–‡ä»¶</span>    output:&#123;    path : __dirname+<span class="hljs-string">'/dist'</span>, <span class="hljs-comment">// æ³¨æ„ï¼š__dirnameè¡¨ç¤ºwebpack.config.jsæ‰€åœ¨ç›®å½•çš„ç»å¯¹è·¯å¾„</span>    filename:<span class="hljs-string">'build.js'</span> <span class="hljs-comment">//è¾“å‡ºæ–‡ä»¶</span>&#125;,devtool: <span class="hljs-string">'evalâ€sourceâ€map'</span>,......</code></pre></div><p>2ã€åœ¨jsä¸­è·Ÿè¸ªä»£ç çš„ä½ç½®ä¸Šæ·»åŠ debugger</p><p>ä¸€ä¸ªä¾‹å­ï¼š<br>åœ¨addæ–¹æ³•ä¸­æ·»åŠ debugger</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">// å®šä¹‰addå‡½æ•°</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">x, y</span>) </span>&#123;    <span class="hljs-keyword">debugger</span>    <span class="hljs-keyword">return</span> x + y&#125;</code></pre></div><p>å¯åŠ¨åº”ç”¨ï¼Œåˆ·æ–°é¡µé¢è·Ÿè¸ªä»£ç ï¼š<br>ç‚¹å‡»â€œè®¡ç®—â€ å³è¿›å…¥debuggerä»£ç ä½ç½®ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨chromeè¿›è¡Œè°ƒè¯•äº†ã€‚</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image12.png" srcset="/img/loading.gif" alt></p><h3 id="æ— æ³•æ­£å¸¸å¯åŠ¨è°ƒè¯•ï¼Ÿ"><a href="#æ— æ³•æ­£å¸¸å¯åŠ¨è°ƒè¯•ï¼Ÿ" class="headerlink" title="æ— æ³•æ­£å¸¸å¯åŠ¨è°ƒè¯•ï¼Ÿ"></a>æ— æ³•æ­£å¸¸å¯åŠ¨è°ƒè¯•ï¼Ÿ</h3><p>è°·æ­Œæµè§ˆå™¨ä¸­å…ˆæŒ‰ä¸‹ <code>F12</code> æ‰“å¼€è°ƒè¯•æ¨¡å¼ååœ¨ç‚¹å‡» <code>è®¡ç®—</code> æŒ‰é’®è¿›è¡Œè§¦å‘ä»£ç ä¸­çš„ <code>debugger</code></p><h1 id="å››ã€CMSå‰ç«¯å·¥ç¨‹åˆ›å»º"><a href="#å››ã€CMSå‰ç«¯å·¥ç¨‹åˆ›å»º" class="headerlink" title="å››ã€CMSå‰ç«¯å·¥ç¨‹åˆ›å»º"></a>å››ã€CMSå‰ç«¯å·¥ç¨‹åˆ›å»º</h1><h2 id="1-å¯¼å…¥ç³»ç»Ÿç®¡ç†å‰ç«¯å·¥ç¨‹"><a href="#1-å¯¼å…¥ç³»ç»Ÿç®¡ç†å‰ç«¯å·¥ç¨‹" class="headerlink" title="1.å¯¼å…¥ç³»ç»Ÿç®¡ç†å‰ç«¯å·¥ç¨‹"></a>1.å¯¼å…¥ç³»ç»Ÿç®¡ç†å‰ç«¯å·¥ç¨‹</h2><p>CMSç³»ç»Ÿä½¿ç”¨Vue-cliè„šæ‰‹æ¶åˆ›å»ºï¼Œ <code>Vue-cli</code>æ˜¯ <code>Vue</code> å®˜æ–¹æä¾›çš„å¿«é€Ÿæ„å»ºå•é¡µåº”ç”¨çš„è„šæ‰‹æ¶ï¼Œ<code>github</code>åœ°å€ï¼š<br><a href="https://github.com/vuejs/vue-cli%EF%BC%88%E6%9C%89%E5%85%B4%E8%B6%A3%E7%9A%84%E5%90%8C%E5%AD%A6%E5%8F%AF%E4%BB%A5%E5%8F%82%E8%80%83%E5%AE%98%E6%96%B9%E6%8C%87%E5%AF%BC%E4%BD%BF%E7%94%A8vue-cli%E5%88%9B%E5%BB%BA%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%EF%BC%89%EF%BC%8C%E6%9C%AC%E9%A1%B9%E7%9B%AE%E5%AF%B9" target="_blank" rel="noopener">https://github.com/vuejs/vue-cliï¼ˆæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒå®˜æ–¹æŒ‡å¯¼ä½¿ç”¨vue-cliåˆ›å»ºå‰ç«¯å·¥ç¨‹ï¼‰ï¼Œæœ¬é¡¹ç›®å¯¹</a> <code>Vue-cli</code>åˆ›å»ºçš„å·¥ç¨‹è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œä¸‹è¾¹ä»‹ç»CMSå·¥ç¨‹çš„æƒ…å†µã€‚</p><h2 id="2-å·¥ç¨‹ç»“æ„"><a href="#2-å·¥ç¨‹ç»“æ„" class="headerlink" title="2. å·¥ç¨‹ç»“æ„"></a>2. å·¥ç¨‹ç»“æ„</h2><p>å¦‚æœæˆ‘è¦åŸºäºVue-Cliåˆ›å»ºçš„å·¥ç¨‹è¿›è¡Œå¼€å‘è¿˜éœ€è¦åœ¨å®ƒåŸºç¡€ä¸Šä½œä¸€äº›å°è£…ï¼Œå¯¼å…¥è¯¾ç¨‹èµ„æ–™ä¸­æä¾›Vue-Cliå°è£…å·¥ç¨‹ã€‚<br><code>èµ„æ–™/xc-ui-pc-sysmanage.7z</code> æ‹·è´åˆ°UIå·¥ç¨‹ç›®å½•ä¸­ï¼Œå¹¶è§£å‹ï¼Œç”¨<code>WebStorm</code>æ‰“å¼€ <code>xc-ui-pc-sysmanage</code> ç›®å½•ã€‚</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image13.png" srcset="/img/loading.gif" alt></p><h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h3><p>package.jsonè®°å½•äº†å·¥ç¨‹æ‰€æœ‰ä¾èµ–ï¼ŒåŠè„šæœ¬å‘½ä»¤ï¼š</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image14.png" srcset="/img/loading.gif" alt></p><p>å¼€å‘ä½¿ç”¨ï¼š<code>npm run dev</code><br>æ‰“åŒ…ä½¿ç”¨ï¼š<code>npm run build</code></p><h3 id="webpack-base-conf-js"><a href="#webpack-base-conf-js" class="headerlink" title="webpack.base.conf.js"></a>webpack.base.conf.js</h3><p><code>webpack.base.conf.js</code> å°±æ˜¯ webpack çš„ <code>webpack.config.js</code> é…ç½®æ–‡ä»¶ï¼Œåœ¨æ­¤æ–‡ä»¶ä¸­é…ç½®äº†å…¥å£æ–‡ä»¶åŠå„ç§<code>Loader</code>ã€‚webpack æ˜¯é€šè¿‡<code>vue-load</code>è§£æ <code>.vue</code> æ–‡ä»¶ï¼Œé€šè¿‡ <code>css-load</code> æ‰“åŒ… <code>css</code> æ–‡ä»¶ç­‰ã€‚</p><h3 id="main-js"><a href="#main-js" class="headerlink" title="main.js"></a>main.js</h3><p><code>main.js</code> æ˜¯å·¥ç¨‹çš„å…¥å£æ–‡ä»¶ï¼Œåœ¨æ­¤æ–‡ä»¶ä¸­åŠ è½½äº†å¾ˆå¤šç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œå¦‚ï¼šElement-UIã€Base64ã€VueRouter ç­‰ã€‚<br><code>index.html</code> æ˜¯æ¨¡æ¿æ–‡ä»¶ã€‚</p><h3 id="srcç›®å½•"><a href="#srcç›®å½•" class="headerlink" title="srcç›®å½•"></a>srcç›®å½•</h3><p>srcç›®å½•ä¸‹å­˜æ”¾é¡µé¢åŠjsä»£ç ã€‚</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image15.png" srcset="/img/loading.gif" alt></p><ul><li>assetsï¼šå­˜æ”¾ä¸€äº›é™æ€æ–‡ä»¶ï¼Œå¦‚å›¾ç‰‡ã€‚</li><li>baseï¼šå­˜æ”¾åŸºç¡€ç»„ä»¶</li><li>base/apiï¼šåŸºç¡€apiæ¥å£</li><li>base/componentï¼šåŸºç¡€ç»„ä»¶ï¼Œè¢«å„å„æ¨¡å—éƒ½ä½¿ç”¨çš„ç»„ä»¶</li><li>base/routerï¼šæ€»çš„è·¯ç”±é…ç½®ï¼ŒåŠ è½½å„æ¨¡å—çš„è·¯ç”±é…ç½®æ–‡ä»¶ã€‚</li><li>commonï¼šå·¥å…·ç±»</li><li>componentï¼šç»„ä»¶ç›®å½•ï¼Œæœ¬é¡¹ç›®ä¸ç”¨ã€‚</li><li>mockï¼šå­˜æ”¾å‰ç«¯å•å…ƒæµ‹è¯•æ–¹æ³•ã€‚</li><li>moduleï¼šå­˜æ”¾å„ä¸šåŠ¡æ¨¡å—çš„é¡µé¢å’Œapiæ–¹æ³•ã€‚</li></ul><p>ä¸‹çº§ç›®å½•ä»¥æ¨¡å—åå‘½åï¼Œä¸‹è¾¹ä»¥cmsä¸¾ä¾‹ï¼š</p><ul><li>cms/apiï¼šcmsæ¨¡å—çš„apiæ¥å£</li><li>cms/componentï¼šcmsæ¨¡å—çš„ç»„ä»¶</li><li>cms/pageï¼š cmsæ¨¡å—çš„é¡µé¢</li><li>cms/routerï¼šcmsæ¨¡å—çš„è·¯ç”±é…ç½®</li><li>staticsï¼šå­˜æ”¾ç¬¬ä¸‰æ–¹ç»„ä»¶çš„é™æ€èµ„æº</li><li>vuexï¼šå­˜æ”¾vuexæ–‡ä»¶ï¼Œæœ¬é¡¹ç›®ä¸ä½¿ç”¨</li><li>staticï¼šä¸srcçš„å¹³çº§ç›®å½•ï¼Œæ­¤ç›®å½•å­˜æ”¾é™æ€èµ„æºå®ƒä¸assetsçš„åŒºåˆ«åœ¨äºï¼Œstaticç›®å½•ä¸­çš„æ–‡ä»¶ä¸è¢«webpackæ‰“åŒ…å¤„ç†ï¼Œä¼šåŸæ ·æ‹·è´åˆ°distç›®å½•ä¸‹</li></ul><h2 id="3-å•é¡µé¢åº”ç”¨ä»‹ç»"><a href="#3-å•é¡µé¢åº”ç”¨ä»‹ç»" class="headerlink" title="3. å•é¡µé¢åº”ç”¨ä»‹ç»"></a>3. å•é¡µé¢åº”ç”¨ä»‹ç»</h2><h3 id="å•é¡µé¢åº”ç”¨çš„ä¼˜ç¼ºç‚¹ï¼š"><a href="#å•é¡µé¢åº”ç”¨çš„ä¼˜ç¼ºç‚¹ï¼š" class="headerlink" title="å•é¡µé¢åº”ç”¨çš„ä¼˜ç¼ºç‚¹ï¼š"></a>å•é¡µé¢åº”ç”¨çš„ä¼˜ç¼ºç‚¹ï¼š</h3><p><strong>ä¼˜ç‚¹</strong>ï¼š<br>1ã€ç”¨æˆ·æ“ä½œä½“éªŒå¥½ï¼Œç”¨æˆ·ä¸ç”¨åˆ·æ–°é¡µé¢ï¼Œæ•´ä¸ªäº¤äº’è¿‡ç¨‹éƒ½æ˜¯é€šè¿‡Ajaxæ¥æ“ä½œã€‚<br>2ã€é€‚åˆå‰åç«¯åˆ†ç¦»å¼€å‘ï¼ŒæœåŠ¡ç«¯æä¾›httpæ¥å£ï¼Œå‰ç«¯è¯·æ±‚httpæ¥å£è·å–æ•°æ®ï¼Œä½¿ç”¨JSè¿›è¡Œå®¢æˆ·ç«¯æ¸²æŸ“ã€‚</p><p><strong>ç¼ºç‚¹</strong>ï¼š<br>1ã€é¦–é¡µåŠ è½½æ…¢<br>å•é¡µé¢åº”ç”¨ä¼šå°†jsã€ cssæ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨åŠ è½½é¡µé¢æ˜¾ç¤ºçš„æ—¶å€™åŠ è½½æ‰“åŒ…æ–‡ä»¶ï¼Œå¦‚æœæ‰“åŒ…æ–‡ä»¶è¾ƒå¤§æˆ–è€…ç½‘é€Ÿæ…¢åˆ™<br>ç”¨æˆ·ä½“éªŒä¸å¥½ã€‚</p><p>2ã€SEOä¸å‹å¥½<br>SEOï¼ˆSearch Engine Optimizationï¼‰ä¸ºæœç´¢å¼•æ“ä¼˜åŒ–ã€‚å®ƒæ˜¯ä¸€ç§åˆ©ç”¨æœç´¢å¼•æ“çš„æœç´¢è§„åˆ™æ¥æé«˜ç½‘ç«™åœ¨æœç´¢å¼•æ“<br>æ’åçš„æ–¹æ³•ã€‚ç›®å‰å„å®¶æœç´¢å¼•æ“å¯¹JSæ”¯æŒä¸å¥½ï¼Œæ‰€ä»¥ä½¿ç”¨å•é¡µé¢åº”ç”¨å°†å¤§å¤§å‡å°‘æœç´¢å¼•æ“å¯¹ç½‘ç«™çš„æ”¶å½•ã€‚</p><p>æ€»ç»“ï¼šæœ¬é¡¹ç›®çš„é—¨æˆ·ã€è¯¾ç¨‹ä»‹ç»ä¸é‡‡ç”¨å•é¡µé¢åº”ç”¨æ¶æ„å»å¼€å‘ï¼Œå¯¹äºéœ€è¦ç”¨æˆ·ç™»å½•çš„ç®¡ç†ç³»ç»Ÿé‡‡ç”¨å•é¡µé¢å¼€å‘ã€‚</p><h1 id="äº”ã€CMSå‰ç«¯é¡µé¢æŸ¥è¯¢å¼€å‘"><a href="#äº”ã€CMSå‰ç«¯é¡µé¢æŸ¥è¯¢å¼€å‘" class="headerlink" title="äº”ã€CMSå‰ç«¯é¡µé¢æŸ¥è¯¢å¼€å‘"></a>äº”ã€CMSå‰ç«¯é¡µé¢æŸ¥è¯¢å¼€å‘</h1><h2 id="1-é¡µé¢åŸå‹"><a href="#1-é¡µé¢åŸå‹" class="headerlink" title="1. é¡µé¢åŸå‹"></a>1. é¡µé¢åŸå‹</h2><h3 id="1ã€åˆ›å»ºé¡µé¢"><a href="#1ã€åˆ›å»ºé¡µé¢" class="headerlink" title="1ã€åˆ›å»ºé¡µé¢"></a>1ã€åˆ›å»ºé¡µé¢</h3><h4 id="é¡µé¢ç»“æ„"><a href="#é¡µé¢ç»“æ„" class="headerlink" title="é¡µé¢ç»“æ„"></a>é¡µé¢ç»“æ„</h4><p>åœ¨modelç›®å½•åˆ›å»º cmsæ¨¡å—çš„ç›®å½•ç»“æ„</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image16.png" srcset="/img/loading.gif" alt></p><p>åœ¨pageç›®å½•æ–°å»ºpage_list.vueï¼Œæ‰©å±•åä¸º.vueã€‚<br>.vueæ–‡ä»¶çš„ç»“æ„å¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs vue">&lt;template&gt;&lt;!â€â€ç¼–å†™é¡µé¢é™æ€éƒ¨åˆ†ï¼Œå³viewéƒ¨åˆ†â€â€&gt;æµ‹è¯•é¡µé¢æ˜¾ç¤º...&lt;&#x2F;template&gt;&lt;script&gt;&#x2F;*ç¼–å†™é¡µé¢é™æ€éƒ¨åˆ†ï¼Œå³modelåŠvméƒ¨åˆ†ã€‚*&#x2F;&lt;&#x2F;script&gt;&lt;style&gt;&#x2F;*ç¼–å†™é¡µé¢æ ·å¼ï¼Œä¸æ˜¯å¿…é¡»*&#x2F;&lt;&#x2F;style&gt;</code></pre></div><p>åœ¨é¡µé¢çš„<code>template</code>ä¸­å¡«å†™ â€œæµ‹è¯•é¡µé¢æ˜¾ç¤ºâ€¦â€ã€‚<br>æ³¨æ„ï¼š<code>template</code>å†…å®¹å¿…é¡»æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ï¼Œå¦åˆ™vueä¼šæŠ¥é”™ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨<code>template</code>æ ‡ç­¾å†…å®šä¹‰ä¸€ä¸ª<code>div</code>ã€‚</p><h4 id="é¡µé¢è·¯ç”±"><a href="#é¡µé¢è·¯ç”±" class="headerlink" title="é¡µé¢è·¯ç”±"></a>é¡µé¢è·¯ç”±</h4><p>åœ¨ <code>cms</code> ç›®å½•ä¸‹åˆ›å»º <code>page_list.vue</code> é¡µé¢ã€‚<br>ç°åœ¨å…ˆé…ç½®è·¯ç”±ï¼Œå®ç° url è®¿é—®åˆ°é¡µé¢å†è¿›è¡Œå†…å®¹å®Œå–„ä¸è°ƒè¯•ã€‚</p><p>1ã€åœ¨cmsçš„routerä¸‹é…ç½®è·¯ç”±</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-keyword">import</span> Home <span class="hljs-keyword">from</span> <span class="hljs-string">'@/module/home/page/home.vue'</span>;<span class="hljs-keyword">import</span> page_list <span class="hljs-keyword">from</span> <span class="hljs-string">'@/module/cms/page/page_list.vue'</span>;    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> [&#123;        path: <span class="hljs-string">'/cms'</span>,        component: Home,        name: <span class="hljs-string">'CMSå†…å®¹ç®¡ç†'</span>,        hidden: <span class="hljs-literal">false</span>,        children:[            &#123;<span class="hljs-attr">path</span>:<span class="hljs-string">'/cms/page/list'</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">'é¡µé¢åˆ—è¡¨'</span>,<span class="hljs-attr">component</span>: page_list,<span class="hljs-attr">hidden</span>:<span class="hljs-literal">false</span>&#125;        ]    &#125;]</code></pre></div><p>2ã€åœ¨baseç›®å½•ä¸‹çš„routerå¯¼å…¥cmsæ¨¡å—çš„è·¯ç”±</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">// // å¯¼å…¥è·¯ç”±è§„åˆ™</span><span class="hljs-keyword">import</span> HomeRouter <span class="hljs-keyword">from</span> <span class="hljs-string">'@/module/home/router'</span><span class="hljs-keyword">import</span> CmsRouter <span class="hljs-keyword">from</span> <span class="hljs-string">'@/module/cms/router'</span><span class="hljs-comment">// åˆå¹¶è·¯ç”±è§„åˆ™</span>concat(HomeRouter)concat(CmsRouter)</code></pre></div><p>3ã€æµ‹è¯•</p><p>å¯åŠ¨å·¥ç¨‹ï¼Œåˆ·æ–°é¡µé¢ï¼Œé¡µé¢å¯ä»¥å¤–æ­£å¸¸æµè§ˆï¼Œå¹¶ä¸”çœ‹åˆ°â€œæµ‹è¯•é¡µé¢æ˜¾ç¤ºâ€¦â€å­—æ ·</p><h3 id="2ã€Tableç»„ä»¶æµ‹è¯•"><a href="#2ã€Tableç»„ä»¶æµ‹è¯•" class="headerlink" title="2ã€Tableç»„ä»¶æµ‹è¯•"></a>2ã€Tableç»„ä»¶æµ‹è¯•</h3><p>æœ¬åŠŸèƒ½å®ç°çš„é¡µé¢åˆ—è¡¨ï¼Œç”¨æˆ·å¯ä»¥è¿›è¡Œåˆ†é¡µæŸ¥è¯¢ã€è¾“å…¥æŸ¥è¯¢æ¡ä»¶æŸ¥è¯¢ï¼Œé€šè¿‡æŸ¥çœ‹ <code>Element-UI</code> åº“ï¼Œæˆ‘ä»¬éœ€è¦<code>Table</code> è¡¨æ ¼ã€<code>Form</code>è¡¨å• åŠ<code>Pagination</code> åˆ†é¡µç»„ä»¶ã€‚</p><p>è¿›å…¥<a href="https://element.eleme.cn/#/zh-CN/component/table" target="_blank" rel="noopener">Element-UI</a>å®˜æ–¹ï¼Œæ‰¾åˆ° <code>Table</code> ç»„ä»¶ï¼Œæ‹·è´æºä»£ç åˆ° <code>vue</code> é¡µé¢ä¸­ï¼Œå¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs vue">&lt;template&gt;  &lt;div&gt;    &lt;el-table      :data&#x3D;&quot;tableData&quot;      border      style&#x3D;&quot;width: 100%&quot;&gt;      &lt;el-table-column        prop&#x3D;&quot;date&quot;        label&#x3D;&quot;æ—¥æœŸ&quot;        width&#x3D;&quot;180&quot;&gt;      &lt;&#x2F;el-table-column&gt;      &lt;el-table-column        prop&#x3D;&quot;name&quot;        label&#x3D;&quot;å§“å&quot;        width&#x3D;&quot;180&quot;&gt;      &lt;&#x2F;el-table-column&gt;      &lt;el-table-column        prop&#x3D;&quot;address&quot;        label&#x3D;&quot;åœ°å€&quot;&gt;      &lt;&#x2F;el-table-column&gt;      &lt;el-table-column        prop&#x3D;&quot;test&quot;        label&#x3D;&quot;æµ‹è¯•åˆ—&quot;&gt;      &lt;&#x2F;el-table-column&gt;    &lt;&#x2F;el-table&gt;  &lt;&#x2F;div&gt;&lt;&#x2F;template&gt;&lt;script&gt;  export default &#123;    data() &#123;      return &#123;        tableData: [&#123;          date: &#39;2016-05-02&#39;,          name: &#39;ç‹å°è™&#39;,          address: &#39;ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1518 å¼„&#39;,          test: &#39;æµ‹è¯•&#39;        &#125;, &#123;          date: &#39;2016-05-04&#39;,          name: &#39;ç‹å°è™&#39;,          address: &#39;ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1517 å¼„&#39;        &#125;, &#123;          date: &#39;2016-05-01&#39;,          name: &#39;ç‹å°è™&#39;,          address: &#39;ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1519 å¼„&#39;        &#125;, &#123;          date: &#39;2016-05-03&#39;,          name: &#39;ç‹å°è™&#39;,          address: &#39;ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1516 å¼„&#39;        &#125;]      &#125;    &#125;  &#125;&lt;&#x2F;script&gt;&lt;style&gt;&lt;&#x2F;style&gt;</code></pre></div><p>æµ‹è¯•ï¼š</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image17.png" srcset="/img/loading.gif" alt></p><p>é€šè¿‡æŸ¥çœ‹ä»£ç å‘ç°ï¼Œ<code>el-table</code> ç»„ä»¶ç»‘å®šäº†<code>tableData</code>æ¨¡å‹æ•°æ®ï¼Œ<code>tableData</code>æ¨¡å‹æ•°æ®åœ¨<code>script</code>æ ‡ç­¾ä¸­å®šä¹‰ã€‚</p><h3 id="3ã€é¡µé¢å†…å®¹å®Œå–„"><a href="#3ã€é¡µé¢å†…å®¹å®Œå–„" class="headerlink" title="3ã€é¡µé¢å†…å®¹å®Œå–„"></a>3ã€é¡µé¢å†…å®¹å®Œå–„</h3><p>æ ¹æ®éœ€æ±‚å®Œå–„é¡µé¢å†…å®¹ï¼Œå®Œå–„åˆ—è¡¨å­—æ®µï¼Œæ·»åŠ åˆ†é¡µç»„ä»¶ã€‚</p><div class="hljs"><pre><code class="hljs vue">&lt;template&gt;  &lt;div&gt;    &lt;el-button type&#x3D;&quot;primary&quot; v-on:click&#x3D;&quot;query&quot; size&#x3D;&quot;small&quot;&gt;æŸ¥è¯¢&lt;&#x2F;el-button&gt;    &lt;el-table    :data&#x3D;&quot;list&quot;    border    style&#x3D;&quot;width: 100%&quot;&gt;    &lt;el-table-column prop&#x3D;&quot;pageName&quot; label&#x3D;&quot;é¡µé¢åç§°&quot; width&#x3D;&quot;120&quot;&gt;    &lt;&#x2F;el-table-column&gt;    &lt;el-table-column prop&#x3D;&quot;pageAliase&quot; label&#x3D;&quot;åˆ«å&quot; width&#x3D;&quot;120&quot;&gt;    &lt;&#x2F;el-table-column&gt;    &lt;el-table-column prop&#x3D;&quot;pageType&quot; label&#x3D;&quot;é¡µé¢ç±»å‹&quot; width&#x3D;&quot;150&quot;&gt;    &lt;&#x2F;el-table-column&gt;    &lt;el-table-column prop&#x3D;&quot;pageWebPath&quot; label&#x3D;&quot;è®¿é—®è·¯å¾„&quot; width&#x3D;&quot;250&quot;&gt;    &lt;&#x2F;el-table-column&gt;    &lt;el-table-column prop&#x3D;&quot;pagePhysicalPath&quot; label&#x3D;&quot;ç‰©ç†è·¯å¾„&quot; width&#x3D;&quot;250&quot;&gt;    &lt;&#x2F;el-table-column&gt;    &lt;el-table-column prop&#x3D;&quot;pageCreateTime&quot; label&#x3D;&quot;åˆ›å»ºæ—¶é—´&quot;&gt;    &lt;&#x2F;el-table-column&gt;    &lt;&#x2F;el-table&gt;    &lt;el-pagination    layout&#x3D;&quot;prev, pager, next&quot;    :page-size&#x3D;&quot;this.params.size&quot;    v-on:current-change&#x3D;&quot;changePage&quot;    :total&#x3D;&quot;total&quot; :current-page&#x3D;&quot;this.params.page&quot; style&#x3D;&quot;float:right;&quot;&gt;    &lt;&#x2F;el-pagination&gt;  &lt;&#x2F;div&gt;&lt;&#x2F;template&gt;&lt;script&gt;  export default &#123;    data() &#123;      return &#123;        list:[],        total:50,        params:&#123;          page:1,&#x2F;&#x2F;é¡µç           size:2&#x2F;&#x2F;æ¯é¡µæ˜¾ç¤ºä¸ªæ•°        &#125;      &#125;    &#125;,    methods:&#123;      changePage:function () &#123;        this.query()      &#125;,    &#x2F;&#x2F;æŸ¥è¯¢      query:function () &#123;        alert(&quot;æŸ¥è¯¢&quot;)      &#125;    &#125;  &#125;&lt;&#x2F;script&gt;</code></pre></div><p>æµ‹è¯•</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image18.png" srcset="/img/loading.gif" alt></p><h2 id="2-APIè°ƒç”¨"><a href="#2-APIè°ƒç”¨" class="headerlink" title="2. APIè°ƒç”¨"></a>2. APIè°ƒç”¨</h2><h3 id="1ã€å®šä¹‰"><a href="#1ã€å®šä¹‰" class="headerlink" title="1ã€å®šä¹‰"></a>1ã€å®šä¹‰</h3><p>åœ¨cmsæ¨¡å—çš„ <code>api</code> ç›®å½•å®šä¹‰<code>cms.js</code>ï¼Œ<br>åœ¨ <code>cms.js</code> ä¸­å®šä¹‰å¦‚ä¸‹jsæ–¹æ³•ï¼Œæ­¤æ–¹æ³•å®ç° <code>http</code> è¯·æ±‚æœåŠ¡ç«¯é¡µé¢æŸ¥è¯¢æ¥å£ã€‚</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//publicæ˜¯å¯¹axiosçš„å·¥å…·ç±»å°è£…ï¼Œå®šä¹‰äº†httpè¯·æ±‚æ–¹æ³•</span><span class="hljs-keyword">import</span> http <span class="hljs-keyword">from</span> <span class="hljs-string">'./../../../base/api/public'</span><span class="hljs-comment">//é¡µé¢æŸ¥è¯¢</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> page_list = <span class="hljs-function">(<span class="hljs-params">page,size,params</span>) =&gt;</span> &#123;    <span class="hljs-comment">//å®šä¹‰æ–¹æ³•ï¼Œè¯·æ±‚æœåŠ¡ç«¯æŸ¥è¯¢æ¥å£</span>    <span class="hljs-keyword">return</span> http.requestQuickGet(<span class="hljs-string">'http://localhost:31001/cms/page/list/'</span>+page+<span class="hljs-string">'/'</span>+size)&#125;</code></pre></div><p><code>axios</code>å®ç°äº†<code>http</code>æ–¹æ³•çš„å°è£…ï¼Œ<code>vue.js</code> å®˜æ–¹ä¸å†ç»§ç»­ç»´æŠ¤ <code>vue-resource</code>,æ¨èä½¿ç”¨ <code>axios</code>ã€‚</p><h3 id="2ã€è°ƒç”¨"><a href="#2ã€è°ƒç”¨" class="headerlink" title="2ã€è°ƒç”¨"></a>2ã€è°ƒç”¨</h3><p>å‰ç«¯ <code>page_list.vue</code> é¡µé¢å¯¼å…¥cms.jsï¼Œè°ƒç”¨jsæ–¹æ³•è¯·æ±‚æœåŠ¡ç«¯é¡µé¢æŸ¥è¯¢æ¥å£ã€‚</p><p>è¯·æ±‚çš„å‚æ•°æ ¹æ®åç«¯çš„ <code>Swagger</code> æ–‡æ¡£è¿›è¡Œé…ç½® <a href="http://localhost:31001/swagger-ui.html" target="_blank" rel="noopener">http://localhost:31001/swagger-ui.html</a></p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image19.png" srcset="/img/loading.gif" alt></p><p>é…ç½®</p><div class="hljs"><pre><code class="hljs js">&lt;script&gt;  <span class="hljs-comment">//å¯¼å…¥api</span>  <span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> cmsApi <span class="hljs-keyword">from</span> <span class="hljs-string">'../api/cms'</span>;  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;    data() &#123;      <span class="hljs-keyword">return</span> &#123;        list:[],        total:<span class="hljs-number">50</span>,        params:&#123;          page:<span class="hljs-number">1</span>,<span class="hljs-comment">//é¡µç </span>          size:<span class="hljs-number">2</span><span class="hljs-comment">//æ¯é¡µæ˜¾ç¤ºä¸ªæ•°</span>        &#125;      &#125;    &#125;,    methods:&#123;      changePage:<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-keyword">this</span>.query()      &#125;,    <span class="hljs-comment">//æŸ¥è¯¢</span>      query:<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-comment">//è°ƒç”¨æœåŠ¡ç«¯æ¥å£</span>        cmsApi.page_list(<span class="hljs-keyword">this</span>.params.page, <span class="hljs-keyword">this</span>.params.size).then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span>&#123;          <span class="hljs-comment">//å°†resç»“æœæ•°æ®èµ‹å€¼ç»™æ•°æ®æ¨¡å‹å¯¹è±¡</span>          <span class="hljs-keyword">this</span>.list = res.queryResult.list          <span class="hljs-keyword">this</span>.total = res.queryResult.total        &#125;)      &#125;    &#125;  &#125;&lt;<span class="hljs-regexp">/script&gt;</span></code></pre></div><h2 id="3-è·¨åŸŸé—®é¢˜è§£å†³"><a href="#3-è·¨åŸŸé—®é¢˜è§£å†³" class="headerlink" title="3. è·¨åŸŸé—®é¢˜è§£å†³"></a>3. è·¨åŸŸé—®é¢˜è§£å†³</h2><p>æµ‹è¯• ä¸Šè¾¹çš„ä»£ç† ï¼Œç»“æœ æŠ¥é”™å¦‚ä¸‹ ï¼š</p><div class="hljs"><pre><code class="hljs html">No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin'http://localhost:11000' is therefore not allowed access.</code></pre></div><p>åŸå› ï¼šæµè§ˆå™¨çš„åŒæºç­–ç•¥ä¸å…è®¸è·¨åŸŸè®¿é—®ï¼Œæ‰€è°“åŒæºç­–ç•¥æ˜¯æŒ‡åè®®ã€åŸŸåã€ç«¯å£ç›¸åŒã€‚</p><p>è§£å†³ï¼šé‡‡ç”¨ <code>proxyTable</code> è§£å†³ã€‚</p><h3 id="proxyTable-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#proxyTable-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="proxyTable æ˜¯ä»€ä¹ˆï¼Ÿ"></a>proxyTable æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>vue-cliæä¾›çš„è§£å†³vueå¼€å‘ç¯å¢ƒä¸‹è·¨åŸŸé—®é¢˜çš„æ–¹æ³•ï¼ŒproxyTableçš„åº•å±‚ä½¿ç”¨äº† <code>http-proxymiddleware</code>ï¼ˆ<a href="https://github.com/chimurai/http-proxy-middleware%EF%BC%89%EF%BC%8C%E5%AE%83%E6%98%AFhttp%E4%BB%A3%E7%90%86%E4%B8%AD%E9%97%B4%E4%BB%B6%EF%BC%8C%E5%AE%83%E4%BE%9D%E8%B5%96" target="_blank" rel="noopener">https://github.com/chimurai/http-proxy-middlewareï¼‰ï¼Œå®ƒæ˜¯httpä»£ç†ä¸­é—´ä»¶ï¼Œå®ƒä¾èµ–</a> <code>node.js</code>ï¼Œ<br>åŸºæœ¬åŸç†æ˜¯ç”¨æœåŠ¡ç«¯ä»£ç†è§£å†³æµè§ˆå™¨è·¨åŸŸï¼š</p><h3 id="cmsè·¨åŸŸè§£å†³åŸç†ï¼š"><a href="#cmsè·¨åŸŸè§£å†³åŸç†ï¼š" class="headerlink" title="cmsè·¨åŸŸè§£å†³åŸç†ï¼š"></a>cmsè·¨åŸŸè§£å†³åŸç†ï¼š</h3><p>1ã€è®¿é—®é¡µé¢<a href="http://localhost:11000/" target="_blank" rel="noopener">http://localhost:11000/</a></p><p>2ã€é¡µé¢è¯·æ±‚<a href="http://localhost:11000/cms" target="_blank" rel="noopener">http://localhost:11000/cms</a></p><blockquote><p>ç”±äºurlç”±<a href="http://localhost/" target="_blank" rel="noopener">http://localhost</a>:31001/cmsâ€¦æ”¹ä¸ºâ€œ<a href="http://localhost:11000/cms.&quot;ï¼Œæ‰€ä»¥ä¸å­˜åœ¨è·¨åŸŸ" target="_blank" rel="noopener">http://localhost:11000/cms.&quot;ï¼Œæ‰€ä»¥ä¸å­˜åœ¨è·¨åŸŸ</a></p></blockquote><p>3ã€é€šè¿‡proxyTableç”±nodeæœåŠ¡å™¨ä»£ç†è¯·æ±‚ <a href="http://localhost:31001/cms" target="_blank" rel="noopener">http://localhost:31001/cms</a>.</p><blockquote><p>æœåŠ¡ç«¯ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜</p></blockquote><p>å…·ä½“çš„é…ç½®å¦‚ä¸‹ï¼š</p><p>1ã€ä¿®æ”¹<code>api</code>æ–¹æ³•ä¸­<code>url</code>çš„å®šä¹‰</p><p>è¯·æ±‚å‰åŠ /apiå‰ç¼€</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//publicæ˜¯å¯¹axiosçš„å·¥å…·ç±»å°è£…ï¼Œå®šä¹‰äº†httpè¯·æ±‚æ–¹æ³•</span><span class="hljs-keyword">import</span> http <span class="hljs-keyword">from</span> <span class="hljs-string">'./../../../base/api/public'</span>  <span class="hljs-comment">//ES6 å¯¼å…¥</span><span class="hljs-keyword">let</span> sysConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@/../config/sysConfig'</span>)<span class="hljs-keyword">let</span> apiUrl = sysConfig.xcApiUrlPre<span class="hljs-comment">//é¡µé¢æŸ¥è¯¢</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> page_list = <span class="hljs-function">(<span class="hljs-params">page,size,params</span>) =&gt;</span> &#123;  <span class="hljs-comment">//å®šä¹‰æ–¹æ³•ï¼Œè¯·æ±‚æœåŠ¡ç«¯æŸ¥è¯¢æ¥å£</span>  <span class="hljs-keyword">return</span> http.requestQuickGet(apiUrl + <span class="hljs-string">'/cms/page/list/'</span>+page+<span class="hljs-string">'/'</span>+size)&#125;</code></pre></div><p>2ã€åœ¨ <code>config/index.js</code> ä¸‹é…ç½® <code>proxyTable</code></p><div class="hljs"><pre><code class="hljs js"><span class="hljs-string">'/api/cms'</span>: &#123;    target: <span class="hljs-string">'http://localhost:31001'</span>,    pathRewrite: &#123;    <span class="hljs-string">'^/api'</span>: <span class="hljs-string">''</span><span class="hljs-comment">//å®é™…è¯·æ±‚å»æ‰/api</span>&#125;</code></pre></div><h2 id="4-åˆ†é¡µæŸ¥è¯¢æµ‹è¯•"><a href="#4-åˆ†é¡µæŸ¥è¯¢æµ‹è¯•" class="headerlink" title="4. åˆ†é¡µæŸ¥è¯¢æµ‹è¯•"></a>4. åˆ†é¡µæŸ¥è¯¢æµ‹è¯•</h2><p>1ã€å®šä¹‰åˆ†é¡µè§†å›¾</p><div class="hljs"><pre><code class="hljs vue"> &lt;el-pagination      @size-change&#x3D;&quot;handleSizeChange&quot;      @current-change&#x3D;&quot;handleCurrentChange&quot;      :page-sizes&#x3D;&quot;[5,10, 20, 30, 100]&quot;      :current-page&#x3D;&quot;this.params.page&quot;      :page-size&#x3D;&quot;this.params.size&quot;      :total&#x3D;&quot;this.total&quot;      layout&#x3D;&quot;total, sizes, prev, pager, next, jumper&quot;      v-on:current-change&#x3D;&quot;changePage&quot;      style&#x3D;&quot;float:right;&quot;&gt;&lt;&#x2F;el-pagination&gt;</code></pre></div><p>2ã€å®šä¹‰æ•°æ®æ¨¡å‹å¯¹è±¡</p><div class="hljs"><pre><code class="hljs js">data() &#123;     <span class="hljs-keyword">return</span> &#123;       list:[],       total:<span class="hljs-number">0</span>,  <span class="hljs-comment">//æ•°æ®æ€»é‡</span>       params:&#123;         page:<span class="hljs-number">1</span>,<span class="hljs-comment">//é»˜è®¤é¡µç </span>         size:<span class="hljs-number">10</span><span class="hljs-comment">//é»˜è®¤æ¯é¡µæ˜¾ç¤ºä¸ªæ•°</span>       &#125;     &#125;&#125;,</code></pre></div><p>3ã€å®šä¹‰åˆ†é¡µæ–¹æ³•ï¼Œæ¥æ”¶é¡µç å‚æ•°</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//è§¦å‘åˆ†é¡µå‚æ•°å˜åŠ¨</span>handleSizeChange(val) &#123;  <span class="hljs-keyword">this</span>.params.size = val  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`æ¯é¡µ <span class="hljs-subst">$&#123;val&#125;</span> æ¡`</span>);&#125;,handleCurrentChange(val) &#123;  <span class="hljs-keyword">this</span>.params.page = val  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`å½“å‰é¡µ: <span class="hljs-subst">$&#123;val&#125;</span>`</span>);&#125;,<span class="hljs-comment">//åˆ†é¡µæŸ¥è¯¢ï¼Œæ¥æ”¶pageé¡µç </span>changePage()&#123;  <span class="hljs-keyword">this</span>.query()&#125;,<span class="hljs-comment">//æŸ¥è¯¢</span>query:<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;  <span class="hljs-comment">//è°ƒç”¨æœåŠ¡ç«¯æ¥å£</span>  cmsApi.page_list(<span class="hljs-keyword">this</span>.params.page, <span class="hljs-keyword">this</span>.params.size).then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span>&#123;    <span class="hljs-comment">//å°†resç»“æœæ•°æ®èµ‹å€¼ç»™æ•°æ®æ¨¡å‹å¯¹è±¡</span>    <span class="hljs-keyword">this</span>.list = res.queryResult.list    <span class="hljs-keyword">this</span>.total = res.queryResult.total  &#125;)&#125;</code></pre></div><p>ä¿®æ”¹å®Œæ¯•ï¼Œåˆ†é¡µæµ‹è¯•æ•ˆæœå¦‚ä¸‹</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image20.png" srcset="/img/loading.gif" alt></p><h2 id="5-è¿›å…¥é¡µé¢ç«‹å³æŸ¥è¯¢"><a href="#5-è¿›å…¥é¡µé¢ç«‹å³æŸ¥è¯¢" class="headerlink" title="5.è¿›å…¥é¡µé¢ç«‹å³æŸ¥è¯¢"></a>5.è¿›å…¥é¡µé¢ç«‹å³æŸ¥è¯¢</h2><p>ç›®å‰å®ç°çš„åŠŸèƒ½æ˜¯è¿›å…¥é¡µé¢ç‚¹å‡»æŸ¥è¯¢æŒ‰é’®å‘æœåŠ¡ç«¯è¡¨æ±‚æŸ¥è¯¢ï¼Œå®é™…çš„éœ€æ±‚æ˜¯è¿›å…¥é¡µé¢ç«‹å³æŸ¥è¯¢ã€‚</p><p><strong>é‚£ä¹ˆå¦‚ä½•å®ç°ï¼Ÿ</strong></p><p>è¿™è¦ç”¨åˆ° <code>vue</code> çš„é’©å­å‡½æ•°ï¼Œæ¯ä¸ª <code>Vue</code> å®ä¾‹åœ¨è¢«åˆ›å»ºæ—¶éƒ½è¦ç»è¿‡ä¸€ç³»åˆ—çš„åˆå§‹åŒ–è¿‡ç¨‹â€”â€”ä¾‹å¦‚ï¼Œéœ€è¦è®¾ç½®æ•°æ®ç›‘å¬ã€ç¼–è¯‘æ¨¡æ¿ã€å°†å®ä¾‹æŒ‚è½½åˆ° <code>DOM</code> å¹¶åœ¨æ•°æ®å˜åŒ–æ—¶æ›´æ–° <code>DOM</code> ç­‰ã€‚åŒæ—¶åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿä¼šè¿è¡Œä¸€äº›å«åšç”Ÿå‘½å‘¨æœŸé’©å­çš„å‡½æ•°ï¼Œè¿™ç»™äº†ç”¨æˆ·åœ¨ä¸åŒé˜¶æ®µæ·»åŠ è‡ªå·±çš„ä»£ç çš„æœºä¼š ã€‚</p><p>é€šå¸¸ä½¿ç”¨æœ€å¤šçš„æ˜¯ <code>created</code> å’Œ <code>mounted</code> ä¸¤ä¸ªé’©å­ï¼š</p><p><code>created</code>ï¼švueå®ä¾‹å·²åˆ›å»ºä½†æ˜¯DOMå…ƒç´ è¿˜æ²¡æœ‰æ¸²æŸ“ç”Ÿæˆã€‚</p><p><code>mounted</code>ï¼šDOMå…ƒç´ æ¸²æŸ“ç”Ÿæˆå®Œæˆåè°ƒç”¨ ã€‚</p><p>æœ¬ä¾‹å­åœ¨ä¸¤ä¸ªæ–¹æ³•çš„ä»»æ„ä¸€ä¸ªéƒ½æ»¡è¶³éœ€æ±‚ï¼š</p><p>æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><div class="hljs"><pre><code class="hljs js">mounted() &#123;    <span class="hljs-comment">//é»˜è®¤æŸ¥è¯¢é¡µé¢</span>    <span class="hljs-keyword">this</span>.query()&#125;</code></pre></div><p>é‡æ–°åˆ·æ–°é¡µé¢ã€‚</p><h1 id="å…­ã€å‰ç«¯è¯·æ±‚å“åº”æµç¨‹å°ç»“"><a href="#å…­ã€å‰ç«¯è¯·æ±‚å“åº”æµç¨‹å°ç»“" class="headerlink" title="å…­ã€å‰ç«¯è¯·æ±‚å“åº”æµç¨‹å°ç»“"></a>å…­ã€å‰ç«¯è¯·æ±‚å“åº”æµç¨‹å°ç»“</h1><p>å‚è€ƒ â€œè®²ä¹‰â€“&gt;å‰åç«¯è¯·æ±‚å“åº”æµç¨‹.pngâ€ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday02/image21.png" srcset="/img/loading.gif" alt></p><p>æ ¹æ®å›¾ä¸­æ‰€ç¤ºï¼Œæˆ‘ä»¬æ€»ç»“æµç¨‹å¦‚ä¸‹ï¼š</p><p>1ã€åœ¨æµè§ˆå™¨è¾“å…¥å‰ç«¯url</p><p>2ã€å‰ç«¯æ¡†æ¶ <code>vue.js</code> æ ¹æ® <code>url</code> è§£æè·¯ç”±ï¼Œæ ¹æ®è·¯ç”±æ‰¾åˆ° <code>page_list.vue</code> é¡µé¢</p><p>3ã€é¦–å…ˆæ‰§è¡Œ <code>page_list.vue</code> ä¸­çš„é’©å­æ–¹æ³•</p><p>4ã€åœ¨é’©å­æ–¹æ³•ä¸­è°ƒç”¨ <code>query</code> æ–¹æ³•ã€‚</p><p>5ã€åœ¨ <code>query</code> æ–¹æ³•ä¸­è°ƒç”¨ <code>cms.js</code> ä¸­çš„ <code>page_list</code> æ–¹æ³•</p><p>6ã€<code>cms.js</code> ä¸­çš„ <code>page_list</code> æ–¹æ³•é€šè¿‡ <code>axios</code> è¯·æ±‚æœåŠ¡ç«¯æ¥å£</p><p>7ã€é‡‡ç”¨ <code>proxyTable</code> è§£å†³è·¨åŸŸé—®é¢˜ï¼Œ<code>node.js</code> å°†è¯·æ±‚è½¬å‘åˆ°æœåŠ¡ç«¯(<a href="http://localhost:31001/cms/page/list" target="_blank" rel="noopener">http://localhost:31001/cms/page/list</a>)</p><p>8ã€æœåŠ¡ç«¯å¤„ç†ï¼Œå°†æŸ¥è¯¢ç»“æœå“åº”ç»™å‰ç«¯</p><p>9ã€æˆåŠŸå“åº”è°ƒç”¨ <code>then</code> æ–¹æ³•ï¼Œåœ¨ <code>then</code> æ–¹æ³•ä¸­å¤„ç†å“åº”ç»“æœï¼Œå°†æŸ¥è¯¢ç»“æœèµ‹å€¼ç»™æ•°æ®æ¨¡å‹ä¸­çš„totalå’Œlistå˜é‡ã€‚</p><p>10ã€<code>vue.js</code> é€šè¿‡åŒå‘æ•°æ®ç»‘å®šå°†listæ•°æ®æ¸²æŸ“è¾“å‡º ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å­¦æˆåœ¨çº¿</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
      <tag>webpack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å­¦æˆåœ¨çº¿day01</title>
    <link href="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday01/"/>
    <url>/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday01/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ˜-çŸ¥è¯†ç‚¹æ¦‚è§ˆ"><a href="#ğŸ˜-çŸ¥è¯†ç‚¹æ¦‚è§ˆ" class="headerlink" title="ğŸ˜ çŸ¥è¯†ç‚¹æ¦‚è§ˆ"></a>ğŸ˜ çŸ¥è¯†ç‚¹æ¦‚è§ˆ</h1><blockquote><p>ä¸ºäº†æ–¹ä¾¿åç»­å›é¡¾è¯¥é¡¹ç›®æ—¶èƒ½å¤Ÿæ¸…æ™°çš„çŸ¥é“æœ¬ç« èŠ‚è®²äº†å“ªäº›å†…å®¹ï¼Œå¹¶ä¸”èƒ½å¤Ÿä»è¯¥ç« èŠ‚çš„ç¬”è®°ä¸­å¾—åˆ°ä¸€äº›å¸®åŠ©ï¼Œæ‰€ä»¥åœ¨å®Œæˆæœ¬ç« èŠ‚çš„å­¦ä¹ ååœ¨æ­¤å¯¹æœ¬ç« èŠ‚æ‰€æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹è¿›è¡Œæ€»ç»“æ¦‚è¿°ã€‚</p></blockquote><p>æœ¬ç« èŠ‚ä¸ºã€å­¦æˆåœ¨çº¿ã€‘é¡¹ç›®çš„ <code>day01</code> çš„å†…å®¹</p><ul><li>æ­å»ºé—¨æˆ·é¡µé¢</li><li>æ­å»ºæœåŠ¡ç«¯åŸºç¡€å·¥ç¨‹</li><li>é¡µé¢æŸ¥è¯¢æœåŠ¡çš„æ„å»º</li><li>ä½¿ç”¨<code>MangoDB</code> è¿›è¡Œ <code>CRUD</code> æ“ä½œ</li><li><code>Swagger</code> çš„åŸºæœ¬ä½¿ç”¨</li><li><code>Postman</code> çš„åŸºæœ¬ä½¿ç”¨</li></ul><h1 id="ä¸€ã€é¡¹ç›®æ¶æ„"><a href="#ä¸€ã€é¡¹ç›®æ¶æ„" class="headerlink" title="ä¸€ã€é¡¹ç›®æ¶æ„"></a>ä¸€ã€é¡¹ç›®æ¶æ„</h1><h2 id="1-ä¸šåŠ¡æ¶æ„"><a href="#1-ä¸šåŠ¡æ¶æ„" class="headerlink" title="1. ä¸šåŠ¡æ¶æ„"></a>1. ä¸šåŠ¡æ¶æ„</h2><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday01/image1.png" srcset="/img/loading.gif" alt></p><h2 id="2-æŠ€æœ¯æ¶æ„"><a href="#2-æŠ€æœ¯æ¶æ„" class="headerlink" title="2. æŠ€æœ¯æ¶æ„"></a>2. æŠ€æœ¯æ¶æ„</h2><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday01/image2.png" srcset="/img/loading.gif" alt></p><h1 id="äºŒã€CMS-é—¨æˆ·å·¥ç¨‹æ­å»º"><a href="#äºŒã€CMS-é—¨æˆ·å·¥ç¨‹æ­å»º" class="headerlink" title="äºŒã€CMS é—¨æˆ·å·¥ç¨‹æ­å»º"></a>äºŒã€CMS é—¨æˆ·å·¥ç¨‹æ­å»º</h1><h2 id="1-å®‰è£…-WebStorm"><a href="#1-å®‰è£…-WebStorm" class="headerlink" title="1. å®‰è£… WebStorm"></a>1. å®‰è£… WebStorm</h2><p>å‚è€ƒ <code>WebStormå®‰è£…æ‰‹å†Œ.md</code> å®‰è£…WebStormï¼Œå¯¼å…¥ <code>èµ„æ–™\é—¨æˆ·\xc-ui-pc-static-portal.rar</code> å‹ç¼©åŒ…ä¸‹çš„å†…å®¹ã€‚</p><h2 id="2-Nginxè™šæ‹Ÿä¸»æœº"><a href="#2-Nginxè™šæ‹Ÿä¸»æœº" class="headerlink" title="2. Nginxè™šæ‹Ÿä¸»æœº"></a>2. Nginxè™šæ‹Ÿä¸»æœº</h2><p>åœ¨nginxä¸­é…ç½®è™šæ‹Ÿä¸»æœºï¼š</p><div class="hljs"><pre><code class="hljs nginx">server&#123;    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;    <span class="hljs-attribute">server_name</span> www.xuecheng.com;    <span class="hljs-attribute">ssi</span> <span class="hljs-literal">on</span>;    <span class="hljs-attribute">ssi_silent_errors</span> <span class="hljs-literal">on</span>;    <span class="hljs-attribute">location</span> / &#123;    <span class="hljs-attribute">alias</span> F:/teach/xcEdu/xcEduUI/xcâ€uiâ€pcâ€staticâ€portal/;    <span class="hljs-attribute">index</span> index.html;    &#125;&#125;</code></pre></div><p>F:/teach/xcEdu/xcEduUI/xc-ui-pc-static-portal/ æœ¬ç›®å½•å³ä¸ºé—¨æˆ·çš„ä¸»ç›®å½•ï¼Œè‡ªè¡Œä¿®æ”¹ä¸ºè‡ªå·±çš„è·¯å¾„</p><h1 id="ä¸‰ã€CMS-æœåŠ¡ç«¯å·¥ç¨‹æ­å»º"><a href="#ä¸‰ã€CMS-æœåŠ¡ç«¯å·¥ç¨‹æ­å»º" class="headerlink" title="ä¸‰ã€CMS æœåŠ¡ç«¯å·¥ç¨‹æ­å»º"></a>ä¸‰ã€CMS æœåŠ¡ç«¯å·¥ç¨‹æ­å»º</h1><h2 id="1-åŸºç¡€å·¥ç¨‹æ­å»º"><a href="#1-åŸºç¡€å·¥ç¨‹æ­å»º" class="headerlink" title="1. åŸºç¡€å·¥ç¨‹æ­å»º"></a>1. åŸºç¡€å·¥ç¨‹æ­å»º</h2><p>åˆ›å»ºä¸€ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹ <code>xcEduService01</code>å¯¼å…¥ <code>èµ„æ–™\åŸºç¡€å·¥ç¨‹\åŸºç¡€å·¥ç¨‹.zip</code> ä¸­çš„åŸºç¡€å·¥ç¨‹ï¼Œå¹¶ä¾æ¬¡å°†æ‰€æœ‰åŸºç¡€å·¥ç¨‹æ·»åŠ è‡³<code>pom</code>é¡¹ç›®ä¸­</p><h2 id="2-å¯¼å…¥MongoDBæ•°æ®"><a href="#2-å¯¼å…¥MongoDBæ•°æ®" class="headerlink" title="2. å¯¼å…¥MongoDBæ•°æ®"></a>2. å¯¼å…¥MongoDBæ•°æ®</h2><p>æ­å»ºå¥½mongodbæ•°æ®åº“åï¼Œå¯¼å…¥ <code>èµ„æ–™\mongodb\xc_cms</code> å†…çš„jsonæ•°æ®</p><h2 id="3-å®šä¹‰æ¥å£"><a href="#3-å®šä¹‰æ¥å£" class="headerlink" title="3. å®šä¹‰æ¥å£"></a>3. å®šä¹‰æ¥å£</h2><h3 id="å®šä¹‰è¯·æ±‚ä»¥åŠç›¸åº”ç±»å‹"><a href="#å®šä¹‰è¯·æ±‚ä»¥åŠç›¸åº”ç±»å‹" class="headerlink" title="å®šä¹‰è¯·æ±‚ä»¥åŠç›¸åº”ç±»å‹"></a>å®šä¹‰è¯·æ±‚ä»¥åŠç›¸åº”ç±»å‹</h3><p>åœ¨ <code>domain.cms.request</code> ä¸‹åˆ›å»º <code>QueryPageRequest</code> å¹¶ç»§æ‰¿ <code>RequestData</code></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.framework.domain.cms.request;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.request.RequestData;<span class="hljs-keyword">import</span> lombok.Data;<span class="hljs-meta">@Data</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QueryPageRequest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RequestData</span> </span>&#123;    <span class="hljs-comment">//ç«™ç‚¹id</span>    <span class="hljs-keyword">private</span> String siteId;    <span class="hljs-comment">//é¡µé¢id</span>    <span class="hljs-keyword">private</span> String pageId;    <span class="hljs-comment">//é¡µé¢åç§°</span>    <span class="hljs-keyword">private</span> String pageName;    <span class="hljs-comment">//åˆ«å</span>    <span class="hljs-keyword">private</span> String pageAliase;    <span class="hljs-comment">//æ¨¡æ¿id</span>    <span class="hljs-keyword">private</span> String templateId;&#125;</code></pre></div><h3 id="å®šä¹‰å“åº”æ¥å£"><a href="#å®šä¹‰å“åº”æ¥å£" class="headerlink" title="å®šä¹‰å“åº”æ¥å£"></a>å®šä¹‰å“åº”æ¥å£</h3><p>åœ¨ <code>com.xuecheng.api.cms</code> ä¸‹å®šä¹‰ <code>CmsPageControllerApi</code> æŸ¥è¯¢åˆ—è¡¨çš„å“åº”æ ¼å¼ç»Ÿä¸€ä¸º <code>QueryResponseResult</code></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.api.cms;<span class="hljs-keyword">import</span> com.xuecheng.framework.domain.cms.request.QueryPageRequest;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.QueryResponseResult;<span class="hljs-comment">/**</span><span class="hljs-comment"> * åˆ†é¡µæŸ¥è¯¢æ¥å£</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CmsPageControllerApi</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResponseResult <span class="hljs-title">findList</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size, QueryPageRequest queryPageRequest)</span></span>;&#125;</code></pre></div><h1 id="å››ã€é¡µé¢æŸ¥è¯¢æœåŠ¡å¼€å‘"><a href="#å››ã€é¡µé¢æŸ¥è¯¢æœåŠ¡å¼€å‘" class="headerlink" title="å››ã€é¡µé¢æŸ¥è¯¢æœåŠ¡å¼€å‘"></a>å››ã€é¡µé¢æŸ¥è¯¢æœåŠ¡å¼€å‘</h1><h2 id="1-åˆ›å»ºCMSæœåŠ¡å·¥ç¨‹"><a href="#1-åˆ›å»ºCMSæœåŠ¡å·¥ç¨‹" class="headerlink" title="1. åˆ›å»ºCMSæœåŠ¡å·¥ç¨‹"></a>1. åˆ›å»ºCMSæœåŠ¡å·¥ç¨‹</h2><p>å¯¼å…¥ <code>pom.xml</code> é…ç½®</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xc-framework-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>&gt;</span>../xc-framework-parent/pom.xml<span class="hljs-tag">&lt;/<span class="hljs-name">relativePath</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xc-service-manage-cms<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xc-service-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xc-framework-model<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xc-framework-utils<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.xuecheng<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>xc-framework-common<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-mongodb<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.squareup.okhttp3<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>okhttp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span></code></pre></div><p>åˆ›å»ºä¸€ä¸ª <code>xc-service-manage-cms</code> çš„mavenå·¥ç¨‹ï¼Œä¾èµ–çˆ¶å·¥ç¨‹ <code>xc-framework-parent</code> ï¼Œ</p><p>åˆ›å»ºåœ¨ <code>com.xuecheng.manage_cms</code> åŒ…å¹¶åœ¨åŒ…ä¸‹åˆ›å»ºconfigã€daoã€serviceã€controller ç­‰åŒ…ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday01/image3.png" srcset="/img/loading.gif" alt></p><p>åˆ›å»ºå…¥å£æ–‡ä»¶ <code>ManageCmsApplication</code>ï¼Œå¹¶æ‰«æç›¸åº”çš„åŒ…</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.manage_cms;<span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.domain.EntityScan;<span class="hljs-keyword">import</span> org.springframework.context.annotation.ComponentScan;<span class="hljs-meta">@SpringBootApplication</span><span class="hljs-meta">@EntityScan</span>(<span class="hljs-string">"com.xuecheng.framework.domain.cms"</span>) <span class="hljs-comment">//æ‰«æå…¬å…±çš„å®ä½“ç±»</span><span class="hljs-meta">@ComponentScan</span>(basePackages = &#123;<span class="hljs-string">"com.xuecheng.api"</span>&#125;) <span class="hljs-comment">//æ‰«ææ¥å£</span><span class="hljs-meta">@ComponentScan</span>(basePackages = &#123;<span class="hljs-string">"com.xuecheng.manage_cms"</span>&#125;)  <span class="hljs-comment">// æ‰«ææœ¬é¡¹ç›®ä¸‹çš„æ‰€æœ‰ç±»</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ManageCmsApplication</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        SpringApplication.run(ManageCmsApplication<span class="hljs-class">.<span class="hljs-keyword">class</span>,<span class="hljs-title">args</span>)</span>;    &#125;&#125;</code></pre></div><p>resources ä¸‹åˆ›å»º <code>application.yml</code></p><div class="hljs"><pre><code class="hljs yml"><span class="hljs-attr">server:</span>  <span class="hljs-attr">port:</span> <span class="hljs-number">31001</span><span class="hljs-attr">spring:</span>  <span class="hljs-attr">application:</span>    <span class="hljs-attr">name:</span> <span class="hljs-string">xc-service-manage-cms</span>  <span class="hljs-attr">data:</span>    <span class="hljs-attr">mongodb:</span>      <span class="hljs-attr">uri:</span> <span class="hljs-string">mongodb://root:123123@localhost:27017</span>      <span class="hljs-attr">database:</span> <span class="hljs-string">xc_cms</span></code></pre></div><p>resources ä¸‹å¯¼å…¥æ—¥å¿—æ–‡ä»¶ï¼Œç›´æ¥å¤åˆ¶ <code>èµ„æ–™\CMSé…ç½®æ–‡ä»¶</code> ä¸‹çš„ <code>logback-spring.xml</code></p><h2 id="2-å®šä¹‰dao"><a href="#2-å®šä¹‰dao" class="headerlink" title="2. å®šä¹‰dao"></a>2. å®šä¹‰dao</h2><p>åœ¨daoä¸‹å®šä¹‰ä¸€ä¸ªæ¥å£ <code>CmsPageRepository</code> ç»§æ‰¿ <code>MongoRepository</code> ç±»</p><blockquote><p>MongoRepository&lt;CmsPage,String&gt; ä¸­çš„ CmsPage å¯¹åº”æˆ‘ä»¬mongodbä¸­é›†åˆçš„å®ä½“ç±»</p></blockquote><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.manage_cms.dao;<span class="hljs-keyword">import</span> com.xuecheng.framework.domain.cms.CmsPage;<span class="hljs-keyword">import</span> org.springframework.data.mongodb.repository.MongoRepository;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CmsPageRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MongoRepository</span>&lt;<span class="hljs-title">CmsPage</span>,<span class="hljs-title">String</span>&gt; </span>&#123;&#125;</code></pre></div><h2 id="3-å•å…ƒæµ‹è¯•"><a href="#3-å•å…ƒæµ‹è¯•" class="headerlink" title="3. å•å…ƒæµ‹è¯•"></a>3. å•å…ƒæµ‹è¯•</h2><h3 id="æŸ¥è¯¢æµ‹è¯•"><a href="#æŸ¥è¯¢æµ‹è¯•" class="headerlink" title="æŸ¥è¯¢æµ‹è¯•"></a>æŸ¥è¯¢æµ‹è¯•</h3><p>å®šä¹‰<code>CmsPageRepository</code> çš„æµ‹è¯•ç±» <code>CmsPageRepositoryTest</code></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<span class="hljs-keyword">import</span> org.springframework.data.domain.Page;<span class="hljs-keyword">import</span> org.springframework.data.domain.PageRequest;<span class="hljs-keyword">import</span> org.springframework.data.domain.Pageable;<span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringRunner;<span class="hljs-keyword">import</span> java.util.List;<span class="hljs-meta">@SpringBootTest</span><span class="hljs-meta">@RunWith</span>(SpringRunner<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span><span class="hljs-class"><span class="hljs-title">public</span> <span class="hljs-title">class</span> <span class="hljs-title">CmsPageRepositoryTest</span> </span>&#123;    <span class="hljs-meta">@Autowired</span>    CmsPageRepository cmsPageRepository;    <span class="hljs-meta">@Test</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindAll</span><span class="hljs-params">()</span></span>&#123;        List&lt;CmsPage&gt; all = cmsPageRepository.findAll();        System.out.println(all);    &#125;    <span class="hljs-comment">//åˆ†é¡µæŸ¥è¯¢</span>    <span class="hljs-meta">@Test</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindPage</span><span class="hljs-params">()</span></span>&#123;        <span class="hljs-comment">//åˆ†é¡µå‚æ•°</span>        <span class="hljs-keyword">int</span> page = <span class="hljs-number">0</span>; <span class="hljs-comment">//ä»0å¼€å§‹</span>        <span class="hljs-keyword">int</span> size = <span class="hljs-number">10</span>;        Pageable pageable = PageRequest.of(page,size);        Page&lt;CmsPage&gt; all = cmsPageRepository.findAll(pageable);        System.out.println(all);    &#125;&#125;</code></pre></div><p>è¿è¡Œæµ‹è¯•ï¼ŒæˆåŠŸæŸ¥è¯¢åˆ°åˆ†é¡µæ•°æ®ã€‚</p><h3 id="æ·»åŠ "><a href="#æ·»åŠ " class="headerlink" title="æ·»åŠ "></a>æ·»åŠ </h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//æ·»åŠ </span><span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testInsert</span><span class="hljs-params">()</span></span>&#123;    <span class="hljs-comment">//å®šä¹‰å®ä½“ç±»</span>    CmsPage cmsPage = <span class="hljs-keyword">new</span> CmsPage();    <span class="hljs-comment">//è®¾ç½®å±æ€§</span>    cmsPage.setSiteId(<span class="hljs-string">"s01"</span>);    cmsPage.setTemplateId(<span class="hljs-string">"t01"</span>);    cmsPage.setPageName(<span class="hljs-string">"æµ‹è¯•é¡µé¢"</span>);    cmsPage.setPageCreateTime(<span class="hljs-keyword">new</span> Date());    <span class="hljs-comment">//å‚æ•°é›†åˆ</span>    List&lt;CmsPageParam&gt; cmsPageParams = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    CmsPageParam cmsPageParam = <span class="hljs-keyword">new</span> CmsPageParam();    cmsPageParam.setPageParamName(<span class="hljs-string">"param1"</span>);    cmsPageParam.setPageParamValue(<span class="hljs-string">"value1"</span>);    <span class="hljs-comment">//å°†å‚æ•°æ·»åŠ è‡³é›†åˆå†…</span>    cmsPageParams.add(cmsPageParam);    <span class="hljs-comment">//å®ä½“æ·»åŠ å‚æ•°é›†</span>    cmsPage.setPageParams(cmsPageParams);    cmsPageRepository.save(cmsPage);&#125;</code></pre></div><h3 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//åˆ é™¤</span><span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDelete</span><span class="hljs-params">()</span></span>&#123;    cmsPageRepository.deleteById(<span class="hljs-string">"5e705470cc53e4266c135ee7"</span>);    System.out.println(<span class="hljs-string">"åˆ é™¤æˆåŠŸ!"</span>);&#125;</code></pre></div><h3 id="ä¿®æ”¹"><a href="#ä¿®æ”¹" class="headerlink" title="ä¿®æ”¹"></a>ä¿®æ”¹</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//ä¿®æ”¹</span><span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testUpdate</span><span class="hljs-params">()</span></span>&#123;    Optional&lt;CmsPage&gt; optional = cmsPageRepository.findById(<span class="hljs-string">"5e705470cc53e4266c135ee7"</span>);    <span class="hljs-keyword">if</span>(optional.isPresent())&#123;  <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦ä¸ºç©ºï¼Œjdk1.8æ–°ç‰¹æ€§optional</span>        CmsPage cmsPage = optional.get();        cmsPage.setPageName(<span class="hljs-string">"æµ‹è¯•é¡µé¢02"</span>);        CmsPage save = cmsPageRepository.save(cmsPage);        System.out.println(<span class="hljs-string">"ä¿®æ”¹æˆåŠŸ "</span> + save);    &#125;&#125;</code></pre></div><h2 id="4-é…ç½®-Service"><a href="#4-é…ç½®-Service" class="headerlink" title="4.é…ç½® Service"></a>4.é…ç½® Service</h2><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.manage_cms.service;<span class="hljs-keyword">import</span> com.xuecheng.framework.domain.cms.CmsPage;<span class="hljs-keyword">import</span> com.xuecheng.framework.domain.cms.request.QueryPageRequest;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.CommonCode;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.QueryResponseResult;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.QueryResult;<span class="hljs-keyword">import</span> com.xuecheng.manage_cms.dao.CmsPageRepository;<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<span class="hljs-keyword">import</span> org.springframework.data.domain.Page;<span class="hljs-keyword">import</span> org.springframework.data.domain.PageRequest;<span class="hljs-keyword">import</span> org.springframework.data.domain.Pageable;<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<span class="hljs-meta">@Service</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PageService</span> </span>&#123;    <span class="hljs-meta">@Autowired</span>    CmsPageRepository cmsPageRepository;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * åˆ†é¡µæŸ¥è¯¢</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResponseResult <span class="hljs-title">findList</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page,<span class="hljs-keyword">int</span> size,QueryPageRequest queryPageRequest)</span> </span>&#123;        <span class="hljs-comment">//è¿‡æ»¤æ¡ä»¶</span>        <span class="hljs-keyword">if</span>(page &lt;= <span class="hljs-number">0</span>)&#123;            page = <span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">if</span>(size &lt;= <span class="hljs-number">0</span>)&#123;            size = <span class="hljs-number">10</span>;        &#125;        <span class="hljs-comment">//åˆ›å»ºåˆ†é¡µæŸ¥è¯¢å‚æ•°</span>        PageRequest pageable = PageRequest.of(page, size);        <span class="hljs-comment">//åˆ†é¡µæŸ¥è¯¢æ•°æ®</span>        Page&lt;CmsPage&gt; all = cmsPageRepository.findAll(pageable);        <span class="hljs-comment">//æ•´ç†æŸ¥è¯¢åˆ°çš„æ•°æ®</span>        QueryResult queryResult = <span class="hljs-keyword">new</span> QueryResult();        queryResult.setList(all.getContent());        queryResult.setTotal(all.getTotalElements());        <span class="hljs-comment">//è¿”å›ç»“æœ</span>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> QueryResponseResult(CommonCode.SUCCESS,queryResult);    &#125;&#125;</code></pre></div><h2 id="5-é…ç½®-Controller"><a href="#5-é…ç½®-Controller" class="headerlink" title="5. é…ç½® Controller"></a>5. é…ç½® Controller</h2><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.manage_cms.web.controller;<span class="hljs-keyword">import</span> com.xuecheng.api.cms.CmsPageControllerApi;<span class="hljs-keyword">import</span> com.xuecheng.framework.domain.cms.CmsPage;<span class="hljs-keyword">import</span> com.xuecheng.framework.domain.cms.request.QueryPageRequest;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.CommonCode;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.QueryResponseResult;<span class="hljs-keyword">import</span> com.xuecheng.framework.model.response.QueryResult;<span class="hljs-keyword">import</span> com.xuecheng.manage_cms.service.PageService;<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PathVariable;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<span class="hljs-keyword">import</span> java.util.ArrayList;<span class="hljs-keyword">import</span> java.util.List;<span class="hljs-meta">@RestController</span><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">"/cms/page"</span>)<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CmsPageController</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CmsPageControllerApi</span> </span>&#123;    <span class="hljs-meta">@Autowired</span>    PageService pageService;    <span class="hljs-meta">@Override</span>    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/list/&#123;page&#125;/&#123;size&#125;"</span>)    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResponseResult <span class="hljs-title">findList</span><span class="hljs-params">(@PathVariable(<span class="hljs-string">"page"</span>)</span> <span class="hljs-keyword">int</span> page, @<span class="hljs-title">PathVariable</span><span class="hljs-params">(<span class="hljs-string">"size"</span>)</span> <span class="hljs-keyword">int</span> size, QueryPageRequest queryPageRequest) </span>&#123;        <span class="hljs-keyword">return</span> pageService.findList(page,size,queryPageRequest);    &#125;&#125;</code></pre></div><h2 id="6-æ¥å£å¼€å‘è§„èŒƒ"><a href="#6-æ¥å£å¼€å‘è§„èŒƒ" class="headerlink" title="6.æ¥å£å¼€å‘è§„èŒƒ"></a>6.æ¥å£å¼€å‘è§„èŒƒ</h2><h3 id="Apiè¯·æ±‚åŠå“åº”è§„èŒƒ"><a href="#Apiè¯·æ±‚åŠå“åº”è§„èŒƒ" class="headerlink" title="Apiè¯·æ±‚åŠå“åº”è§„èŒƒ"></a>Apiè¯·æ±‚åŠå“åº”è§„èŒƒ</h3><p>ä¸ºäº†ä¸¥æ ¼æŒ‰ç…§æ¥å£è¿›è¡Œå¼€å‘ï¼Œæé«˜æ•ˆç‡ï¼Œå¯¹è¯·æ±‚åŠå“åº”æ ¼å¼è¿›è¡Œè§„èŒƒåŒ–ã€‚</p><ul><li><code>get</code> è¯·æ±‚æ—¶ï¼Œé‡‡ç”¨key/valueæ ¼å¼è¯·æ±‚ï¼ŒSpringMVCå¯é‡‡ç”¨åŸºæœ¬ç±»å‹çš„å˜é‡æ¥æ”¶ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨å¯¹è±¡æ¥æ”¶ã€‚</li><li><code>Post</code> è¯·æ±‚æ—¶ï¼Œå¯ä»¥æäº¤formè¡¨å•æ•°æ®ï¼ˆapplication/x-www-form-urlencodedï¼‰å’Œ <code>Json</code> æ•°æ®ï¼ˆContent-Type=application/jsonï¼‰ï¼Œæ–‡ä»¶ç­‰å¤šéƒ¨ä»¶ç±»å‹ï¼ˆmultipart/form-dataï¼‰ä¸‰ç§æ•°æ®æ ¼å¼ï¼ŒSpringMVCæ¥æ”¶Jsonæ•°æ®ä½¿ç”¨@RequestBodyæ³¨è§£è§£æè¯·æ±‚çš„jsonæ•°æ®ã€‚</li><li>å“åº”ç»“æœç»Ÿä¸€ä¿¡æ¯ä¸ºï¼šæ˜¯å¦æˆåŠŸã€æ“ä½œä»£ç ã€æç¤ºä¿¡æ¯åŠè‡ªå®šä¹‰æ•°æ®ã€‚</li><li>å“åº”ç»“æœç»Ÿä¸€æ ¼å¼ä¸º <code>json</code>ã€‚</li></ul><h3 id="Apiå®šä¹‰çº¦æŸ"><a href="#Apiå®šä¹‰çº¦æŸ" class="headerlink" title="Apiå®šä¹‰çº¦æŸ"></a>Apiå®šä¹‰çº¦æŸ</h3><p>Api å®šä¹‰ä½¿ç”¨SpringMVCæ¥å®Œæˆï¼Œç”±äºæ­¤æ¥å£åæœŸå°†ä½œä¸ºå¾®æœåŠ¡è¿œç¨‹è°ƒç”¨ä½¿ç”¨ï¼Œåœ¨å®šä¹‰æ¥å£æ—¶æœ‰å¦‚ä¸‹é™åˆ¶ï¼š</p><ul><li><code>@PathVariable</code> ç»Ÿä¸€æŒ‡å®šå‚æ•°åç§°ï¼Œå¦‚ï¼š<code>@PathVariable(&quot;id&quot;)</code></li><li><code>@RequestParam</code> ç»Ÿä¸€æŒ‡å®šå‚æ•°åç§°ï¼Œå¦‚ï¼š<code>@RequestParam(&quot;id&quot;)</code></li></ul><h1 id="äº”ã€Swagger-ç”Ÿæˆæ¥å£æ–‡æ¡£"><a href="#äº”ã€Swagger-ç”Ÿæˆæ¥å£æ–‡æ¡£" class="headerlink" title="äº”ã€Swagger ç”Ÿæˆæ¥å£æ–‡æ¡£"></a>äº”ã€Swagger ç”Ÿæˆæ¥å£æ–‡æ¡£</h1><h2 id="1-Swaggerä»‹ç»"><a href="#1-Swaggerä»‹ç»" class="headerlink" title="1. Swaggerä»‹ç»"></a>1. Swaggerä»‹ç»</h2><p>OpenAPIè§„èŒƒï¼ˆOpenAPI Specification ç®€ç§°OASï¼‰æ˜¯LinuxåŸºé‡‘ä¼šçš„ä¸€ä¸ªé¡¹ç›®ï¼Œè¯•å›¾é€šè¿‡å®šä¹‰ä¸€ç§ç”¨æ¥æè¿°APIæ ¼å¼æˆ–APIå®šä¹‰çš„è¯­è¨€ï¼Œæ¥è§„èŒƒRESTfulæœåŠ¡å¼€å‘è¿‡ç¨‹ï¼Œç›®å‰ç‰ˆæœ¬æ˜¯V3.0ï¼Œå¹¶ä¸”å·²ç»å‘å¸ƒå¹¶å¼€æºåœ¨githubä¸Šã€‚<a href="https://github.com/OAI/OpenAPI-Specification" target="_blank" rel="noopener">https://github.com/OAI/OpenAPI-Specification</a></p><p>Swaggeræ˜¯å…¨çƒæœ€å¤§çš„OpenAPIè§„èŒƒï¼ˆOASï¼‰APIå¼€å‘å·¥å…·æ¡†æ¶ï¼Œæ”¯æŒä»è®¾è®¡å’Œæ–‡æ¡£åˆ°æµ‹è¯•å’Œéƒ¨ç½²çš„æ•´ä¸ªAPIç”Ÿå‘½å‘¨æœŸçš„å¼€å‘ã€‚ (<a href="https://swagger.io/" target="_blank" rel="noopener">https://swagger.io/</a>)</p><p>Spring Boot å¯ä»¥é›†æˆSwaggerï¼Œç”ŸæˆSwaggeræ¥å£ï¼ŒSpring Bootæ˜¯Javaé¢†åŸŸçš„ç¥å™¨ï¼Œå®ƒæ˜¯Springé¡¹ç›®ä¸‹å¿«é€Ÿæ„å»ºé¡¹ç›®çš„æ¡†æ¶ã€‚</p><h2 id="2-å¼€å¯-Swagger"><a href="#2-å¼€å¯-Swagger" class="headerlink" title="2. å¼€å¯ Swagger"></a>2. å¼€å¯ Swagger</h2><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xuecheng.api.config;<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<span class="hljs-keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;<span class="hljs-keyword">import</span> springfox.documentation.builders.PathSelectors;<span class="hljs-keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;<span class="hljs-keyword">import</span> springfox.documentation.service.ApiInfo;<span class="hljs-keyword">import</span> springfox.documentation.spi.DocumentationType;<span class="hljs-keyword">import</span> springfox.documentation.spring.web.plugins.Docket;<span class="hljs-keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;<span class="hljs-comment">//</span><span class="hljs-meta">@Configuration</span><span class="hljs-meta">@EnableSwagger</span>2<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Swagger2Configuration</span> </span>&#123;    <span class="hljs-meta">@Bean</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">createRestApi</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.SWAGGER_2)                .apiInfo(apiInfo())                .select()                .apis(RequestHandlerSelectors.basePackage(<span class="hljs-string">"com.xuecheng"</span>))                .paths(PathSelectors.any())                .build();    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> ApiInfo <span class="hljs-title">apiInfo</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ApiInfoBuilder()                .title(<span class="hljs-string">"å­¦æˆç½‘apiæ–‡æ¡£"</span>)                .description(<span class="hljs-string">"å­¦æˆç½‘apiæ–‡æ¡£"</span>)<span class="hljs-comment">//                .termsOfServiceUrl("/")</span>                .version(<span class="hljs-string">"1.0"</span>)                .build();    &#125;&#125;</code></pre></div><p>å¼€å¯ <code>swagger</code> åï¼Œå®ƒä¼šè‡ªåŠ¨æ‰«æ <code>com.xuecheng</code> åŒ…ä¸‹æ‰€æœ‰æ ‡è®°äº† <code>@RestController</code> è¿™ä¸ªæ³¨è§£çš„ç±»ï¼Œæ ¹æ®è¿™ä¸ªç±»çš„æ–¹æ³•æ¥ç”Ÿæˆæ¥å£æ–‡æ¡£ã€‚</p><p>è¿è¡Œé¡¹ç›®ï¼Œè®¿é—® <a href="http://localhost:31001/swagger-ui.html" target="_blank" rel="noopener">http://localhost:31001/swagger-ui.html</a> å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšæ‰å®šä¹‰çš„è¿™ä¸ª controller</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday01/image4.png" srcset="/img/loading.gif" alt="image-20200317171117409.png"></p><h2 id="3-Swaggerå¸¸ç”¨æ³¨è§£"><a href="#3-Swaggerå¸¸ç”¨æ³¨è§£" class="headerlink" title="3. Swaggerå¸¸ç”¨æ³¨è§£"></a>3. Swaggerå¸¸ç”¨æ³¨è§£</h2><p>åœ¨Javaç±»ä¸­æ·»åŠ Swaggerçš„æ³¨è§£å³å¯ç”ŸæˆSwaggeræ¥å£ï¼Œå¸¸ç”¨Swaggeræ³¨è§£å¦‚ä¸‹ï¼š</p><ul><li>@Apiï¼šä¿®é¥°æ•´ä¸ªç±»ï¼Œæè¿°Controllerçš„ä½œç”¨ @ApiOperationï¼šæè¿°ä¸€ä¸ªç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ–è€…è¯´ä¸€ä¸ªæ¥å£</li><li>@ApiParamï¼šå•ä¸ªå‚æ•°æè¿° @ApiModelï¼šç”¨å¯¹è±¡æ¥æ¥æ”¶å‚æ•° @ApiModelPropertyï¼šç”¨å¯¹è±¡æ¥æ”¶å‚æ•°æ—¶ï¼Œæè¿°å¯¹è±¡çš„ä¸€ä¸ªå­—æ®µ</li><li>@ApiResponseï¼šHTTPå“åº”å…¶ä¸­1ä¸ªæè¿° @ApiResponsesï¼šHTTPå“åº”æ•´ä½“æè¿°</li><li>@ApiIgnoreï¼šä½¿ç”¨è¯¥æ³¨è§£å¿½ç•¥è¿™ä¸ªAPI @ApiError ï¼šå‘ç”Ÿé”™è¯¯è¿”å›çš„ä¿¡æ¯</li><li>@ApiImplicitParamï¼šä¸€ä¸ªè¯·æ±‚å‚æ•°</li><li>@ApiImplicitParamsï¼šå¤šä¸ªè¯·æ±‚å‚æ•°</li><li>@ApiImplicitParamå±æ€§ï¼š</li></ul><table><thead><tr><th>å±æ€§</th><th>å–å€¼</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>paramType</td><td>æŸ¥è¯¢å‚æ•°ç±»å‹</td><td></td></tr><tr><td>path</td><td>ä»¥åœ°å€çš„å½¢å¼æäº¤æ•°æ®</td><td></td></tr><tr><td>query</td><td>ç›´æ¥è·Ÿå‚æ•°å®Œæˆè‡ªåŠ¨æ˜ å°„èµ‹å€¼</td><td></td></tr><tr><td>body</td><td>ä»¥æµçš„å½¢å¼æäº¤ ä»…æ”¯æŒPOST</td><td></td></tr><tr><td>header</td><td>å‚æ•°åœ¨request headers é‡Œè¾¹æäº¤</td><td></td></tr><tr><td>form</td><td>ä»¥formè¡¨å•çš„å½¢å¼æäº¤ ä»…æ”¯æŒPOST</td><td></td></tr><tr><td>dataType</td><td>å‚æ•°çš„æ•°æ®ç±»å‹ åªä½œä¸ºæ ‡å¿—è¯´æ˜ï¼Œå¹¶æ²¡æœ‰å®é™…éªŒè¯</td><td></td></tr><tr><td>Long</td><td></td><td></td></tr><tr><td>String</td><td></td><td></td></tr><tr><td>name</td><td>æ¥æ”¶å‚æ•°å</td><td></td></tr><tr><td>value</td><td>æ¥æ”¶å‚æ•°çš„æ„ä¹‰æè¿°</td><td></td></tr><tr><td>required</td><td>å‚æ•°æ˜¯å¦å¿…å¡«</td><td></td></tr><tr><td>true</td><td>å¿…å¡«</td><td></td></tr><tr><td>false</td><td>éå¿…å¡«</td><td></td></tr><tr><td>defaultValue</td><td>é»˜è®¤å€¼</td><td></td></tr></tbody></table><h2 id="4-Swaggeræ¥å£å®šä¹‰"><a href="#4-Swaggeræ¥å£å®šä¹‰" class="headerlink" title="4. Swaggeræ¥å£å®šä¹‰"></a>4. Swaggeræ¥å£å®šä¹‰</h2><p>ä½¿ç”¨ swagger çš„å¸¸ç”¨æ³¨è§£æ¥æè¿°æ¥å£ä¿¡æ¯</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * åˆ†é¡µæŸ¥è¯¢æ¥å£</span><span class="hljs-comment"> */</span><span class="hljs-meta">@Api</span>(value=<span class="hljs-string">"cmsé¡µé¢ç®¡ç†æ¥å£"</span>,description = <span class="hljs-string">"cmsé¡µé¢ç®¡ç†æ¥å£ï¼Œæä¾›é¡µé¢çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥"</span>)<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CmsPageControllerApi</span> </span>&#123;    <span class="hljs-meta">@ApiOperation</span>(<span class="hljs-string">"åˆ†é¡µæŸ¥è¯¢é¡µé¢åˆ—è¡¨"</span>)    <span class="hljs-meta">@ApiImplicitParams</span>(&#123;        <span class="hljs-meta">@ApiImplicitParam</span>(name=<span class="hljs-string">"page"</span>,value = <span class="hljs-string">"é¡µç "</span>,required=<span class="hljs-keyword">true</span>,paramType=<span class="hljs-string">"path"</span>,dataType=<span class="hljs-string">"int"</span>),        <span class="hljs-meta">@ApiImplicitParam</span>(name=<span class="hljs-string">"size"</span>,value = <span class="hljs-string">"æ¯é¡µè®°å½•æ•°"</span>,required=<span class="hljs-keyword">true</span>,paramType=<span class="hljs-string">"path"</span>,dataType=<span class="hljs-string">"int"</span>)    &#125;)    <span class="hljs-function"><span class="hljs-keyword">public</span> QueryResponseResult <span class="hljs-title">findList</span><span class="hljs-params">(<span class="hljs-keyword">int</span> page, <span class="hljs-keyword">int</span> size, QueryPageRequest queryPageRequest)</span></span>;&#125;</code></pre></div><p>åœ¨QueryPageRequestç±»ä¸­ä½¿ç”¨æ³¨è§£ ApiModelProperty å¯¹å±æ€§æ³¨é‡Š</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QueryPageRequest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RequestData</span> </span>&#123;    <span class="hljs-comment">//ç«™ç‚¹id</span>    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"ç«™ç‚¹id"</span>)    <span class="hljs-keyword">private</span> String siteId;    <span class="hljs-comment">//é¡µé¢ID</span>    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"é¡µé¢ID"</span>)    <span class="hljs-keyword">private</span> String pageId;    <span class="hljs-comment">//é¡µé¢åç§°</span>    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"é¡µé¢åç§°"</span>)    <span class="hljs-keyword">private</span> String pageName;    <span class="hljs-comment">//é¡µé¢åˆ«å</span>    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"é¡µé¢åˆ«å"</span>)    <span class="hljs-keyword">private</span> String pageAliase;    <span class="hljs-comment">//æ¨¡ç‰ˆid</span>    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"æ¨¡ç‰ˆid"</span>)    <span class="hljs-keyword">private</span> String templateId;&#125;</code></pre></div><p>é‡å¯é¡¹ç›®ï¼Œè®¿é—® <a href="http://localhost:31001/swagger-ui.html" target="_blank" rel="noopener">http://localhost:31001/swagger-ui.html</a> ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ·»åŠ çš„æè¿°ä¿¡æ¯</p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday01/image5.png" srcset="/img/loading.gif" alt></p><h1 id="äº”ã€Postman-åŸºæœ¬ä½¿ç”¨"><a href="#äº”ã€Postman-åŸºæœ¬ä½¿ç”¨" class="headerlink" title="äº”ã€Postman åŸºæœ¬ä½¿ç”¨"></a>äº”ã€Postman åŸºæœ¬ä½¿ç”¨</h1><p><code>Postman</code> æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„httpæ¥å£æµ‹è¯•å·¥å…·ï¼Œä½¿ç”¨ <code>postman</code> å¯ä»¥å®Œæˆ <code>http</code> å„ç§è¯·æ±‚çš„åŠŸèƒ½æµ‹è¯•ã€‚</p><p>å®˜æ–¹åœ°å€ï¼š<a href="https://www.getpostman.com/" target="_blank" rel="noopener">https://www.getpostman.com/</a></p><p><img src="/2020/08/08/%E5%AD%A6%E6%88%90%E5%9C%A8%E7%BA%BFday01/image6.png" srcset="/img/loading.gif" alt></p>]]></content>
    
    
    <categories>
      
      <category>å­¦æˆåœ¨çº¿</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MongoDB</tag>
      
      <tag>Swagger</tag>
      
      <tag>Postman</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MongoDBå…¥é—¨</title>
    <link href="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/"/>
    <url>/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="MongoDBå…¥é—¨"><a href="#MongoDBå…¥é—¨" class="headerlink" title="MongoDBå…¥é—¨"></a>MongoDBå…¥é—¨</h1><h2 id="1-mongodbä»‹ç»"><a href="#1-mongodbä»‹ç»" class="headerlink" title="1.mongodbä»‹ç»"></a>1.mongodbä»‹ç»</h2><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/1.png" srcset="/img/loading.gif" alt></p><h2 id="2-ä¸‹è½½mongodb"><a href="#2-ä¸‹è½½mongodb" class="headerlink" title="2.ä¸‹è½½mongodb"></a>2.ä¸‹è½½mongodb</h2><p>typora-copy-images-to:mongodb_imgmongodbå®‰è£…1mongodbä»‹ç»2ä¸‹è½½mongodbMongoDBæä¾›äº†å¯ç”¨äº32ä½å’Œ64ä½ç³»ç»Ÿçš„é¢„ç¼–è¯‘äºŒè¿›åˆ¶åŒ…ï¼Œä½ å¯ä»¥ä»MongoDBå®˜ç½‘ä¸‹è½½å®‰è£…ã€‚å®˜æ–¹åœ°å€ï¼š<a href="https://www.mongodb.com/æœ¬æ•™ç¨‹ä¸‹è½½3.4ç‰ˆæœ¬http://downloads.mongodb.org/win32/mongodb-win32-x86_64-2008plus-ssl-v3.4-latest-signed.msi" target="_blank" rel="noopener">https://www.mongodb.com/æœ¬æ•™ç¨‹ä¸‹è½½3.4ç‰ˆæœ¬http://downloads.mongodb.org/win32/mongodb-win32-x86_64-2008plus-ssl-v3.4-latest-signed.msi</a></p><h2 id="3-å®‰è£…mongodb"><a href="#3-å®‰è£…mongodb" class="headerlink" title="3.å®‰è£…mongodb"></a>3.å®‰è£…mongodb</h2><p>åœ¨win7ç³»ç»Ÿå®‰è£…mongodbéœ€è¦vc++è¿è¡Œåº“ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¼šæç¤ºâ€œæ— æ³•å¯åŠ¨æ­¤ç¨‹åºï¼Œå› ä¸ºè®¡ç®—æœºä¸­ä¸¢å¤±VCRUNTIME140.dllâ€ã€‚å»ç½‘ä¸Šä¸‹è½½æˆ–ä½¿ç”¨360å®‰è£…ï¼š</p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/2.png" srcset="/img/loading.gif" alt></p><p>è¿è¡Œmongodb-win32-x86_64-2008plus-ssl-v3.4-latest-signed.msi</p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/3.png" srcset="/img/loading.gif" alt></p><p>é€‰æ‹©è‡ªå®šä¹‰è·¯å¾„</p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/4.png" srcset="/img/loading.gif" alt></p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/5.png" srcset="/img/loading.gif" alt></p><h2 id="4-å¯åŠ¨mongodb"><a href="#4-å¯åŠ¨mongodb" class="headerlink" title="4.å¯åŠ¨mongodb"></a>4.å¯åŠ¨mongodb</h2><p>åˆ›å»ºå‡ ä¸ªæ–‡ä»¶å¤¹å…·ä½“å¦‚ä¸‹ï¼šæ•°æ®åº“è·¯å¾„ï¼ˆdataç›®å½•ï¼‰ã€æ—¥å¿—è·¯å¾„ï¼ˆlogsç›®å½•ï¼‰å’Œæ—¥å¿—æ–‡ä»¶ï¼ˆmongo.logæ–‡ä»¶ï¼‰</p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/6.png" srcset="/img/loading.gif" alt></p><p>åˆ›å»ºé…ç½®æ–‡ä»¶mongo.confï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹:</p><div class="hljs"><pre><code class="hljs properties"><span class="hljs-comment">#æ•°æ®åº“è·¯å¾„</span><span class="hljs-attr">dbpath</span>=<span class="hljs-string">d:\MongoDB\Server\3.4\data</span><span class="hljs-comment">#æ—¥å¿—è¾“å‡ºæ–‡ä»¶è·¯å¾„</span><span class="hljs-attr">logpath</span>=<span class="hljs-string">d:\MongoDB\Server\3.4\logs\mongo.log</span><span class="hljs-comment">#é”™è¯¯æ—¥å¿—é‡‡ç”¨è¿½åŠ æ¨¡å¼</span><span class="hljs-attr">logappend</span>=<span class="hljs-string">true</span><span class="hljs-comment">#å¯ç”¨æ—¥å¿—æ–‡ä»¶ï¼Œé»˜è®¤å¯ç”¨</span><span class="hljs-attr">journal</span>=<span class="hljs-string">true</span><span class="hljs-comment">#è¿™ä¸ªé€‰é¡¹å¯ä»¥è¿‡æ»¤æ‰ä¸€äº›æ— ç”¨çš„æ—¥å¿—ä¿¡æ¯ï¼Œè‹¥éœ€è¦è°ƒè¯•ä½¿ç”¨è¯·è®¾ç½®ä¸ºfalse</span><span class="hljs-attr">quiet</span>=<span class="hljs-string">true</span><span class="hljs-comment">#ç«¯å£å·é»˜è®¤ä¸º27017</span><span class="hljs-attr">port</span>=<span class="hljs-string">27017</span></code></pre></div><p>æ³¨æ„å¦‚æœå‡ºç°æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œæˆ–è€…é‡åˆ°ç‰¹ç‚¹é”™è¯¯100æƒ…å†µ ç¬¬ä¸€ç§æƒ…å†µæ˜¯dbpathåæœ‰å¤šä½™ç©ºæ ¼ï¼Œç¬¬äºŒç§æƒ…å†µæ˜¯å…¶ä»–å‚æ•°åé¢å¸¦æœ‰ç©ºæ ¼ï¼ˆäº²æµ‹è¢«å‘</p><p>å®‰è£…MongoDBæœåŠ¡é€šè¿‡æ‰§è¡Œbin/mongod.exeï¼Œä½¿ç”¨â€“installé€‰é¡¹æ¥å®‰è£…æœåŠ¡ï¼Œä½¿ç”¨â€“configé€‰é¡¹æ¥æŒ‡å®šä¹‹å‰åˆ›å»ºçš„é…ç½®æ–‡ä»¶ã€‚cmdè¿›å…¥d:\MongoDB\Server\3.4\bin</p><div class="hljs"><pre><code class="hljs shell">mongod.exeâ€â€config"d:\MongoDB\Server\3.4\mongo.conf"â€â€install</code></pre></div><p>å¯åŠ¨MongoDBæœåŠ¡</p><div class="hljs"><pre><code class="hljs shell">net start MongoDB</code></pre></div><p>å…³é—­MongoDBæœåŠ¡</p><div class="hljs"><pre><code class="hljs shell">net stop MongoDB</code></pre></div><p>ç§»é™¤MongoDBæœåŠ¡</p><div class="hljs"><pre><code class="hljs shell">"d:\MongoDB\Server\3.4\bin\mongod.exe"â€â€remove</code></pre></div><p>å¯åŠ¨mongodbæœåŠ¡ï¼Œå‘½ä»¤æ‰§è¡Œåï¼Œæµè§ˆå™¨ä¸­è¾“å…¥<a href="http://127.0.0.1:27017" target="_blank" rel="noopener">http://127.0.0.1:27017</a></p><p>çœ‹åˆ°å¦‚ä¸‹ç•Œé¢å³è¯´æ˜å¯åŠ¨æˆåŠŸ</p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/7.png" srcset="/img/loading.gif" alt></p><h2 id="5-å®‰è£…studio3t"><a href="#5-å®‰è£…studio3t" class="headerlink" title="5.å®‰è£…studio3t"></a>5.å®‰è£…studio3t</h2><p>studio3tæ˜¯mongodbä¼˜ç§€çš„å®¢æˆ·ç«¯å·¥å…·(ç±»ä¼¼sqlyogæ“ä½œmysqlçš„å·¥å…·ï¼‰ã€‚å®˜æ–¹åœ°å€åœ¨<a href="https://studio3t.com/" target="_blank" rel="noopener">https://studio3t.com/</a></p><p>ä¸‹è½½æœ€æ–°ç‰ˆå³å¯</p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/8.png" srcset="/img/loading.gif" alt></p><p>ä¸‹è½½é»˜è®¤å®‰è£…åï¼Œä¼šæç¤ºéœ€è¦è´¦å·ç§˜å¯†ï¼Œå¯ç›´æ¥ç‚¹å‡»å®Œæˆï¼Œè·³è¿‡ é»˜è®¤ä¸ºè¯•ç”¨ç‰ˆ</p><p>åˆ›å»ºä¸€ä¸ªæ–°è¿æ¥ï¼š</p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/9.png" srcset="/img/loading.gif" alt></p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/10.png" srcset="/img/loading.gif" alt></p><p>å¡«å†™è¿æ¥ä¿¡æ¯ï¼šï¼ˆå¯ä¸éœ€è¦mangodbè´¦å·ç§˜å¯†ç›´æ¥è¿æ¥ï¼‰</p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/11.png" srcset="/img/loading.gif" alt></p><p>è¿æ¥æˆåŠŸï¼š</p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/12.png" srcset="/img/loading.gif" alt></p><h2 id="6-mongodbå…¥é—¨"><a href="#6-mongodbå…¥é—¨" class="headerlink" title="6.mongodbå…¥é—¨"></a>6.mongodbå…¥é—¨</h2><h3 id="6-1åŸºç¡€æ¦‚å¿µ"><a href="#6-1åŸºç¡€æ¦‚å¿µ" class="headerlink" title="6.1åŸºç¡€æ¦‚å¿µ"></a>6.1åŸºç¡€æ¦‚å¿µ</h3><p>åœ¨mongodbä¸­æ˜¯é€šè¿‡æ•°æ®åº“ã€é›†åˆã€æ–‡æ¡£çš„æ–¹å¼æ¥ç®¡ç†æ•°æ®ï¼Œä¸‹è¾¹æ˜¯mongodbä¸å…³ç³»æ•°æ®åº“çš„ä¸€äº›æ¦‚å¿µå¯¹æ¯”ï¼š</p><table><thead><tr><th align="center">SQLæœ¯è¯­/æ¦‚å¿µ</th><th align="center">MongoDBæœ¯è¯­/æ¦‚å¿µ</th><th align="left">è§£é‡Š/è¯´æ˜</th></tr></thead><tbody><tr><td align="center">database</td><td align="center">database</td><td align="left">æ•°æ®åº“</td></tr><tr><td align="center">table</td><td align="center">collection</td><td align="left">æ•°æ®åº“è¡¨/é›†åˆ</td></tr><tr><td align="center">row</td><td align="center">document</td><td align="left">æ•°æ®è®°å½•è¡Œ/æ–‡æ¡£</td></tr><tr><td align="center">column</td><td align="center">field</td><td align="left">æ•°æ®å­—æ®µ/åŸŸ</td></tr><tr><td align="center">index</td><td align="center">index</td><td align="left">ç´¢å¼•</td></tr><tr><td align="center">table joins</td><td align="center"></td><td align="left">è¡¨è¿æ¥ï¼ˆMongoDBä¸æ”¯æŒï¼‰</td></tr><tr><td align="center">primary key</td><td align="center">primary key</td><td align="left">ä¸»é”®,MongoDBè‡ªåŠ¨åœ¨æ¯ä¸ªé›†åˆä¸­æ·»åŠ _idçš„ä¸»é”®</td></tr></tbody></table><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/13.png" srcset="/img/loading.gif" alt></p><p>1ã€ä¸€ä¸ªmongodbå®ä¾‹å¯ä»¥åˆ›å»ºå¤šä¸ªæ•°æ®åº“</p><p>2ã€ä¸€ä¸ªæ•°æ®åº“å¯ä»¥åˆ›å»ºå¤šä¸ªé›†åˆ</p><p>3ã€ä¸€ä¸ªé›†åˆå¯ä»¥åŒ…æ‹¬å¤šä¸ªæ–‡æ¡£ã€‚</p><h3 id="6-2è¿æ¥mongodb"><a href="#6-2è¿æ¥mongodb" class="headerlink" title="6.2è¿æ¥mongodb"></a>6.2è¿æ¥mongodb</h3><p>mongodbçš„ä½¿ç”¨æ–¹å¼æ˜¯å®¢æˆ·æœåŠ¡å™¨æ¨¡å¼ï¼Œå³ä½¿ç”¨ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥mongodbæ•°æ®åº“ï¼ˆæœåŠ¡ç«¯ï¼‰ã€‚</p><p>1ã€å‘½ä»¤æ ¼å¼</p><div class="hljs"><pre><code class="hljs shell">mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]</code></pre></div><p>mongodb://å›ºå®šå‰ç¼€</p><p>usernameï¼šè´¦å·ï¼Œå¯ä¸å¡«</p><p>passwordï¼šå¯†ç ï¼Œå¯ä¸å¡«</p><p>hostï¼šä¸»æœºåæˆ–ipåœ°å€ï¼Œåªæœ‰hostä¸»æœºåä¸ºå¿…å¡«é¡¹ã€‚</p><p>portï¼šç«¯å£ï¼Œå¯ä¸å¡«ï¼Œé»˜è®¤27017</p><p>/databaseï¼šè¿æ¥æŸä¸€ä¸ªæ•°æ®åº“</p><p>?optionsï¼šè¿æ¥å‚æ•°ï¼Œkey/valueå¯¹</p><p>ä¾‹å­ï¼š</p><div class="hljs"><pre><code class="hljs shell">mongodb://localhostè¿æ¥æœ¬åœ°æ•°æ®åº“27017ç«¯å£mongodb://root:itcast@localhostä½¿ç”¨ç”¨æˆ·årootå¯†ç ä¸ºitcastè¿æ¥æœ¬åœ°æ•°æ®åº“27017ç«¯å£mongodb://localhost,localhost:27018,localhost:27019ï¼Œè¿æ¥ä¸‰å°ä¸»ä»æœåŠ¡å™¨ï¼Œç«¯å£ä¸º27017ã€27018ã€27019</code></pre></div><p>2ã€ä½¿ç”¨mongodbè‡ªå¸¦çš„javascriptshellï¼ˆmongo.exeï¼‰è¿æ¥</p><p>windowsç‰ˆæœ¬çš„mongodbå®‰è£…æˆåŠŸï¼Œåœ¨å®‰è£…ç›®å½•ä¸‹çš„binç›®å½•æœ‰mongo.exeå®¢æˆ·ç«¯ç¨‹åº</p><p>cmdçŠ¶æ€æ‰§è¡Œmongo.exe:</p><p><img src="/2020/08/06/MongoDB%E5%85%A5%E9%97%A8/14.png" srcset="/img/loading.gif" alt></p><p>æ­¤æ—¶å°±å¯ä»¥è¾“å…¥å‘½ä»¤æ¥æ“ä½œmongodbæ•°æ®åº“äº†ï¼Œjavascriptshellå¯ä»¥è¿è¡Œjavascriptç¨‹åºã€‚</p><p>3ã€ä½¿ç”¨studio3Tè¿æ¥</p><p>4ã€ä½¿ç”¨javaç¨‹åºè¿æ¥</p><p>è¯¦ç»†å‚æ•°ï¼š<a href="http://mongodb.github.io/mongo-java-driver/3.4/driver/tutorials/connect-to-mongodb/" target="_blank" rel="noopener">http://mongodb.github.io/mongo-java-driver/3.4/driver/tutorials/connect-to-mongodb/</a></p><p>æ·»åŠ ä¾èµ–ï¼š</p><div class="hljs"><pre><code class="hljs java">&lt;dependency&gt;&lt;groupId&gt;org.mongodb&lt;/groupId&gt;&lt;artifactId&gt;mongoâ€javaâ€driver&lt;/artifactId&gt;&lt;version&gt;3.4.3&lt;/version&gt;&lt;/dependency&gt;</code></pre></div><p>æµ‹è¯•ç¨‹åºï¼š</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testConnection</span><span class="hljs-params">()</span></span>&#123;    <span class="hljs-comment">//åˆ›å»ºmongodbå®¢æˆ·ç«¯</span>    MongoClientmongoClient=newMongoClient(<span class="hljs-string">"localhost"</span>,<span class="hljs-number">27017</span>);    <span class="hljs-comment">//æˆ–è€…é‡‡ç”¨è¿æ¥å­—ç¬¦ä¸²</span>    <span class="hljs-comment">//MongoClientURIconnectionString=newMongoClientURI("mongodb://root:root@localhost:27017");</span>    <span class="hljs-comment">//MongoClientmongoClient=newMongoClient(connectionString);</span>    <span class="hljs-comment">//è¿æ¥æ•°æ®åº“</span>    MongoDatabasedatabase=mongoClient.getDatabase(<span class="hljs-string">"test"</span>);    <span class="hljs-comment">//è¿æ¥collectionMongo</span>    Collection&lt;Document&gt;collection=database.getCollection(<span class="hljs-string">"student"</span>);    <span class="hljs-comment">//æŸ¥è¯¢ç¬¬ä¸€ä¸ªæ–‡æ¡£</span>    DocumentmyDoc=collection.find().first();    <span class="hljs-comment">//å¾—åˆ°æ–‡ä»¶å†…å®¹jsonä¸²</span>    Stringjson=myDoc.toJson();System.out.println(json);&#125;</code></pre></div><h3 id="6-3æ•°æ®åº“"><a href="#6-3æ•°æ®åº“" class="headerlink" title="6.3æ•°æ®åº“"></a>6.3æ•°æ®åº“</h3><p>1ã€æŸ¥è¯¢æ•°æ®åº“</p><p>showv dbs æŸ¥è¯¢å…¨éƒ¨æ•°æ®åº“</p><p>db æ˜¾ç¤ºå½“å‰æ•°æ®åº“</p><p>2ã€åˆ›å»ºæ•°æ®åº“å‘½ä»¤æ ¼å¼ï¼š</p><div class="hljs"><pre><code class="hljs shell">useDATABASE_NAME</code></pre></div><p>ä¾‹å­ï¼š</p><p>usetest02</p><p>æœ‰test02æ•°æ®åº“åˆ™åˆ‡æ¢åˆ°æ­¤æ•°æ®åº“ï¼Œæ²¡æœ‰åˆ™åˆ›å»º</p><p>æ³¨æ„ï¼š</p><p>æ–°åˆ›å»ºçš„æ•°æ®åº“ä¸æ˜¾ç¤ºï¼Œéœ€è¦è‡³å°‘åŒ…æ‹¬ä¸€ä¸ªé›†åˆã€‚</p><p>3ã€åˆ é™¤æ•°æ®åº“ï¼ˆæ…ç”¨ï¼ï¼ï¼ï¼‰</p><p>å‘½ä»¤æ ¼å¼ï¼š</p><div class="hljs"><pre><code class="hljs shell">db.dropDatabase()</code></pre></div><p>ä¾‹å­ï¼š</p><p>åˆ é™¤test02æ•°æ®åº“</p><p>å…ˆåˆ‡æ¢æ•°æ®åº“ï¼šusetest02</p><p>å†æ‰§è¡Œåˆ é™¤ï¼šdb.dropDatabase()</p><h3 id="6-4é›†åˆ"><a href="#6-4é›†åˆ" class="headerlink" title="6.4é›†åˆ"></a>6.4é›†åˆ</h3><p>é›†åˆç›¸å½“äºå…³ç³»æ•°æ®åº“ä¸­çš„è¡¨ï¼Œä¸€ä¸ªæ•°æ®åº“å¯ä»¥åˆ›å»ºå¤šä¸ªé›†åˆï¼Œä¸€ä¸ªé›†åˆæ˜¯å°†ç›¸åŒç±»å‹çš„æ–‡æ¡£ç®¡ç†èµ·æ¥ã€‚</p><p>1ã€åˆ›å»ºé›†åˆ</p><div class="hljs"><pre><code class="hljs shel">db.createCollection(name,options)name: æ–°åˆ›å»ºçš„é›†åˆåç§°options: åˆ›å»ºå‚æ•°</code></pre></div><p>2.åˆ é™¤é›†åˆ</p><div class="hljs"><pre><code class="hljs shell">db.collection.drop()ä¾‹å­ï¼šdb.student.drop() åˆ é™¤studenté›†åˆ</code></pre></div><h3 id="6-5æ–‡æ¡£"><a href="#6-5æ–‡æ¡£" class="headerlink" title="6.5æ–‡æ¡£"></a>6.5æ–‡æ¡£</h3><h4 id="6-5-1æ’å…¥æ–‡æ¡£"><a href="#6-5-1æ’å…¥æ–‡æ¡£" class="headerlink" title="6.5.1æ’å…¥æ–‡æ¡£"></a>6.5.1æ’å…¥æ–‡æ¡£</h4><p>mongodbä¸­æ–‡æ¡£çš„æ ¼å¼æ˜¯jsonæ ¼å¼ï¼Œä¸‹è¾¹å°±æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªkeyï¼š_idä¸»é”®å’Œname</p><div class="hljs"><pre><code class="hljs shell">&#123;"_id":ObjectId("5b2cc4bfa6a44812707739b5"),"name":"é»‘é©¬ç¨‹åºå‘˜"&#125;</code></pre></div><p>æ’å…¥å‘½ä»¤ï¼š</p><div class="hljs"><pre><code class="hljs shell">db.COLLECTION_NAME.insert(document)</code></pre></div><p>æ¯ä¸ªæ–‡æ¡£é»˜è®¤ä»¥_idä½œä¸ºä¸»é”®ï¼Œä¸»é”®é»˜è®¤ç±»å‹ä¸ºObjectIdï¼ˆå¯¹è±¡ç±»å‹ï¼‰ï¼Œmongodbä¼šè‡ªåŠ¨ç”Ÿæˆä¸»é”®å€¼ã€‚</p><p>ä¾‹å­ï¼š</p><div class="hljs"><pre><code class="hljs shell">db.student.insert(&#123;"name":"é»‘é©¬ç¨‹åºå‘˜","age":10&#125;)</code></pre></div><p>æ³¨æ„ï¼šåŒä¸€ä¸ªé›†åˆä¸­çš„æ–‡æ¡£çš„keyå¯ä»¥ä¸ç›¸åŒï¼ä½†æ˜¯å»ºè®®è®¾ç½®ä¸ºç›¸åŒçš„</p><h4 id="6-5-2æ›´æ–°æ–‡æ¡£"><a href="#6-5-2æ›´æ–°æ–‡æ¡£" class="headerlink" title="6.5.2æ›´æ–°æ–‡æ¡£"></a>6.5.2æ›´æ–°æ–‡æ¡£</h4><p>å‘½ä»¤æ ¼å¼ï¼š</p><div class="hljs"><pre><code class="hljs shell">db.collection.update(&lt;query&gt;,&lt;update&gt;,&lt;options&gt;)query:æŸ¥è¯¢æ¡ä»¶ï¼Œç›¸å½“äºsqlè¯­å¥çš„whereupdateï¼šæ›´æ–°æ–‡æ¡£å†…å®¹optionsï¼šé€‰é¡¹</code></pre></div><p>1ã€æ›¿æ¢æ–‡æ¡£</p><p>å°†ç¬¦åˆæ¡ä»¶â€nameâ€:â€åŒ—äº¬é»‘é©¬ç¨‹åºâ€çš„ç¬¬ä¸€ä¸ªæ–‡æ¡£æ›¿æ¢ä¸º{â€œnameâ€:â€åŒ—äº¬é»‘é©¬ç¨‹åºå‘˜â€,â€ageâ€:10}</p><div class="hljs"><pre><code class="hljs shell">db.student.update(&#123;"name":"é»‘é©¬ç¨‹åºå‘˜"&#125;,&#123;"name":"åŒ—äº¬é»‘é©¬ç¨‹åºå‘˜","age":10&#125;)</code></pre></div><p>2ã€$setä¿®æ”¹å™¨</p><p>ä½¿ç”¨$setä¿®æ”¹å™¨æŒ‡å®šè¦æ›´æ–°çš„keyï¼Œkeyä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™æ›´æ–°ã€‚</p><p>å°†ç¬¦åˆæ¡ä»¶â€nameâ€:â€åŒ—äº¬é»‘é©¬ç¨‹åºâ€çš„æ‰€æœ‰æ–‡æ¡£æ›´æ–°nameå’Œageçš„å€¼ã€‚</p><div class="hljs"><pre><code class="hljs shell">db.student.update(&#123;"name":"é»‘é©¬ç¨‹åºå‘˜"&#125;,&#123;$set:&#123;"name":"åŒ—äº¬é»‘é©¬ç¨‹åºå‘˜","age":10&#125;&#125;,&#123;multi:true&#125;)</code></pre></div><p>multiï¼šfalseè¡¨ç¤ºæ›´æ–°ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ–‡æ¡£ï¼Œtrueè¡¨ç¤ºæ›´æ–°æ‰€æœ‰åŒ¹é…çš„æ–‡æ¡£</p><h4 id="6-5-3åˆ é™¤æ–‡æ¡£"><a href="#6-5-3åˆ é™¤æ–‡æ¡£" class="headerlink" title="6.5.3åˆ é™¤æ–‡æ¡£"></a>6.5.3åˆ é™¤æ–‡æ¡£</h4><p>å‘½ä»¤æ ¼å¼ï¼š</p><div class="hljs"><pre><code class="hljs shell">db.student.remove(&lt;query&gt;)queryï¼šåˆ é™¤æ¡ä»¶ï¼Œç›¸å½“äºsqlè¯­å¥ä¸­çš„where</code></pre></div><p>1ã€åˆ é™¤æ‰€æœ‰æ–‡æ¡£</p><p>db.student.remove({})</p><p>2ã€åˆ é™¤ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£</p><p>db.student.remove({â€œnameâ€:â€é»‘é©¬ç¨‹åºå‘˜â€})</p><h4 id="6-5-4æŸ¥è¯¢æ–‡æ¡£"><a href="#6-5-4æŸ¥è¯¢æ–‡æ¡£" class="headerlink" title="6.5.4æŸ¥è¯¢æ–‡æ¡£"></a>6.5.4æŸ¥è¯¢æ–‡æ¡£</h4><p>å‘½ä»¤æ ¼å¼ï¼š</p><div class="hljs"><pre><code class="hljs shell">db.collection.find(query,projection)queryï¼šæŸ¥è¯¢æ¡ä»¶ï¼Œå¯ä¸å¡«projectionï¼šæŠ•å½±æŸ¥è¯¢keyï¼Œå¯ä¸å¡«</code></pre></div><p>1ã€æŸ¥è¯¢å…¨éƒ¨</p><div class="hljs"><pre><code class="hljs shell">db.student.find()</code></pre></div><p>2ã€æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„è®°å½•</p><p>æŸ¥è¯¢nameç­‰ä¸ºâ€é»‘é©¬ç¨‹åºå‘˜â€çš„æ–‡æ¡£ã€‚</p><div class="hljs"><pre><code class="hljs shell">db.student.find(&#123;"name":"é»‘é©¬ç¨‹åºå‘˜"&#125;)</code></pre></div><p>3ã€æŠ•å½±æŸ¥è¯¢</p><p>åªæ˜¾ç¤ºnameå’Œageä¸¤ä¸ªkeyï¼Œ_idä¸»é”®ä¸æ˜¾ç¤ºã€‚</p><div class="hljs"><pre><code class="hljs shell">db.student.find(&#123;"name":"é»‘é©¬ç¨‹åºå‘˜"&#125;,&#123;name:1,age:1,_id:0&#125;)</code></pre></div><h3 id="6-6ç”¨æˆ·"><a href="#6-6ç”¨æˆ·" class="headerlink" title="6.6ç”¨æˆ·"></a>6.6ç”¨æˆ·</h3><h4 id="6-6-1åˆ›å»ºç”¨æˆ·"><a href="#6-6-1åˆ›å»ºç”¨æˆ·" class="headerlink" title="6.6.1åˆ›å»ºç”¨æˆ·"></a>6.6.1åˆ›å»ºç”¨æˆ·</h4><p>è¯­æ³•æ ¼å¼ï¼š</p><div class="hljs"><pre><code class="hljs json">mongo&gt;db.createUser(    &#123;user:"&lt;name&gt;",     pwd:"&lt;cleartextpassword&gt;",customData:&#123;&lt;anyinformation&gt;&#125;,     roles:[         &#123;role:"&lt;role&gt;",db:"&lt;database&gt;"&#125;|"&lt;role&gt;",         ...     ]&#125;)</code></pre></div><p>ä¾‹å­ï¼š</p><p>åˆ›å»ºrootç”¨æˆ·ï¼Œè§’è‰²ä¸ºroot</p><div class="hljs"><pre><code class="hljs json">use admindb.createUser(    &#123;        user:"root",        pwd:"root",        roles:[&#123;role:"root",db:"admin"&#125;]    &#125;)</code></pre></div><p>å†…ç½®è§’è‰²å¦‚ä¸‹ï¼š</p><p>1.æ•°æ®åº“ç”¨æˆ·è§’è‰²ï¼šreadã€readWrite;</p><p>2.æ•°æ®åº“ç®¡ç†è§’è‰²ï¼šdbAdminã€dbOwnerã€userAdmin;</p><p>3.é›†ç¾¤ç®¡ç†è§’è‰²ï¼šclusterAdminã€clusterManagerã€clusterMonitorã€hostManagerï¼›</p><p>4.å¤‡ä»½æ¢å¤è§’è‰²ï¼šbackupã€restoreï¼›</p><p>5.æ‰€æœ‰æ•°æ®åº“è§’è‰²ï¼šreadAnyDatabaseã€readWriteAnyDatabaseã€userAdminAnyDatabaseã€dbAdminAnyDatabase</p><p>6.è¶…çº§ç”¨æˆ·è§’è‰²ï¼šroot</p><h4 id="6-6-2æŸ¥è¯¢ç”¨æˆ·"><a href="#6-6-2æŸ¥è¯¢ç”¨æˆ·" class="headerlink" title="6.6.2æŸ¥è¯¢ç”¨æˆ·"></a>6.6.2æŸ¥è¯¢ç”¨æˆ·</h4><p>æŸ¥è¯¢å½“å‰åº“ä¸‹çš„æ‰€æœ‰ç”¨æˆ·ï¼š</p><div class="hljs"><pre><code class="hljs shell">show users</code></pre></div><h4 id="6-6-3åˆ é™¤ç”¨æˆ·"><a href="#6-6-3åˆ é™¤ç”¨æˆ·" class="headerlink" title="6.6.3åˆ é™¤ç”¨æˆ·"></a>6.6.3åˆ é™¤ç”¨æˆ·</h4><p>è¯­æ³•æ ¼å¼ï¼š</p><div class="hljs"><pre><code class="hljs shell">db.dropUser("ç”¨æˆ·å")</code></pre></div><p>ä¾‹å­ï¼š</p><p>åˆ é™¤root1ç”¨æˆ·</p><div class="hljs"><pre><code class="hljs shell">db.dropUser("root1")</code></pre></div><h4 id="6-6-4ä¿®æ”¹ç”¨æˆ·"><a href="#6-6-4ä¿®æ”¹ç”¨æˆ·" class="headerlink" title="6.6.4ä¿®æ”¹ç”¨æˆ·"></a>6.6.4ä¿®æ”¹ç”¨æˆ·</h4><p>è¯­æ³•æ ¼å¼ï¼š</p><div class="hljs"><pre><code class="hljs json">db.updateUser(    "&lt;username&gt;",    &#123;customData:&#123;&lt;anyinformation&gt;&#125;,     roles:[         &#123;role:"&lt;role&gt;",db:"&lt;database&gt;"&#125;|"&lt;role&gt;",         ...     ],         pwd:"&lt;cleartextpassword&gt;"         &#125;,         writeConcern:&#123;&lt;writeconcern&gt;&#125;)</code></pre></div><p>ä¾‹å­:</p><p>ä¿®æ”¹rootç”¨æˆ·çš„è§’è‰²ä¸ºreadWriteAnyDatabase</p><div class="hljs"><pre><code class="hljs shell">use admindb.updateUser("root",&#123;roles:[&#123;role:"readWriteAnyDatabase",db:"admin"&#125;]&#125;)</code></pre></div><h4 id="6-6-5ä¿®æ”¹å¯†ç "><a href="#6-6-5ä¿®æ”¹å¯†ç " class="headerlink" title="6.6.5ä¿®æ”¹å¯†ç "></a>6.6.5ä¿®æ”¹å¯†ç </h4><p>è¯­æ³•æ ¼å¼ï¼š</p><div class="hljs"><pre><code class="hljs shell">db.changeUserPassword("username","newPasswd")</code></pre></div><p>ä¾‹å­ï¼š</p><p>ä¿®æ”¹rootç”¨æˆ·çš„å¯†ç ä¸º123</p><div class="hljs"><pre><code class="hljs shell">use admindb.changeUserPassword("root","123")</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>æ–°æ‰‹æ•™ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MongoDB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootè‡ªå®šä¹‰starter</title>
    <link href="/2020/08/04/SpringBoot%E8%87%AA%E5%AE%9A%E4%B9%89starter/"/>
    <url>/2020/08/04/SpringBoot%E8%87%AA%E5%AE%9A%E4%B9%89starter/</url>
    
    <content type="html"><![CDATA[<h1 id="è‡ªå®šä¹‰starter"><a href="#è‡ªå®šä¹‰starter" class="headerlink" title="è‡ªå®šä¹‰starter"></a>è‡ªå®šä¹‰starter</h1><p>starterï¼š</p><p>â€‹    1ã€è¿™ä¸ªåœºæ™¯éœ€è¦ä½¿ç”¨åˆ°çš„ä¾èµ–æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>â€‹    2ã€å¦‚ä½•ç¼–å†™è‡ªåŠ¨é…ç½®</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span>  <span class="hljs-comment">//æŒ‡å®šè¿™ä¸ªç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»</span><span class="hljs-meta">@ConditionalOnXXX</span>  <span class="hljs-comment">//åœ¨æŒ‡å®šæ¡ä»¶æˆç«‹çš„æƒ…å†µä¸‹è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆ</span><span class="hljs-meta">@AutoConfigureAfter</span>  <span class="hljs-comment">//æŒ‡å®šè‡ªåŠ¨é…ç½®ç±»çš„é¡ºåº</span><span class="hljs-meta">@Bean</span>  <span class="hljs-comment">//ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶</span><span class="hljs-meta">@ConfigurationPropertie</span>ç»“åˆç›¸å…³xxxPropertiesç±»æ¥ç»‘å®šç›¸å…³çš„é…ç½®<span class="hljs-meta">@EnableConfigurationProperties</span> <span class="hljs-comment">//è®©xxxPropertiesç”Ÿæ•ˆåŠ å…¥åˆ°å®¹å™¨ä¸­</span>è‡ªåŠ¨é…ç½®ç±»è¦èƒ½åŠ è½½å°†éœ€è¦å¯åŠ¨å°±åŠ è½½çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œé…ç½®åœ¨META-INF/spring.factoriesorg.springframework.boot.autoconfigure.EnableAutoConfiguration=\org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\</code></pre></div><p>â€‹    3ã€æ¨¡å¼ï¼š</p><p>å¯åŠ¨å™¨åªç”¨æ¥åšä¾èµ–å¯¼å…¥ï¼›</p><p>ä¸“é—¨æ¥å†™ä¸€ä¸ªè‡ªåŠ¨é…ç½®æ¨¡å—ï¼›</p><p>å¯åŠ¨å™¨ä¾èµ–è‡ªåŠ¨é…ç½®ï¼›åˆ«äººåªéœ€è¦å¼•å…¥å¯åŠ¨å™¨ï¼ˆstarterï¼‰</p><p>mybatis-spring-boot-starterï¼›è‡ªå®šä¹‰å¯åŠ¨å™¨å-spring-boot-starter</p><p>æ­¥éª¤ï¼š</p><h2 id="1ï¼‰ã€å¯åŠ¨å™¨æ¨¡å—"><a href="#1ï¼‰ã€å¯åŠ¨å™¨æ¨¡å—" class="headerlink" title="1ï¼‰ã€å¯åŠ¨å™¨æ¨¡å—"></a>1ï¼‰ã€å¯åŠ¨å™¨æ¨¡å—</h2><div class="hljs"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.atguigu.starter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>atguigu-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>    <span class="hljs-comment">&lt;!--å¯åŠ¨å™¨--&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>        <span class="hljs-comment">&lt;!--å¼•å…¥è‡ªåŠ¨é…ç½®æ¨¡å—--&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.atguigu.starter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>atguigu-spring-boot-starter-autoconfigurer<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span></code></pre></div><h2 id="2ï¼‰ã€è‡ªåŠ¨é…ç½®æ¨¡å—"><a href="#2ï¼‰ã€è‡ªåŠ¨é…ç½®æ¨¡å—" class="headerlink" title="2ï¼‰ã€è‡ªåŠ¨é…ç½®æ¨¡å—"></a>2ï¼‰ã€è‡ªåŠ¨é…ç½®æ¨¡å—</h2><div class="hljs"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><span class="hljs-tag">   <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.atguigu.starter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>atguigu-spring-boot-starter-autoconfigurer<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>jar<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>atguigu-spring-boot-starter-autoconfigurer<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>Demo project for Spring Boot<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.5.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span>   <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.reporting.outputEncoding</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span>   <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>      <span class="hljs-comment">&lt;!--å¼•å…¥spring-boot-starterï¼›æ‰€æœ‰starterçš„åŸºæœ¬é…ç½®--&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>   <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span></code></pre></div><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.starter;<span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;<span class="hljs-meta">@ConfigurationProperties</span>(prefix = <span class="hljs-string">"atguigu.hello"</span>)<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloProperties</span> </span>&#123;    <span class="hljs-keyword">private</span> String prefix;    <span class="hljs-keyword">private</span> String suffix;    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPrefix</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> prefix;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPrefix</span><span class="hljs-params">(String prefix)</span> </span>&#123;        <span class="hljs-keyword">this</span>.prefix = prefix;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getSuffix</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> suffix;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setSuffix</span><span class="hljs-params">(String suffix)</span> </span>&#123;        <span class="hljs-keyword">this</span>.suffix = suffix;    &#125;&#125;</code></pre></div><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.starter;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloService</span> </span>&#123;    HelloProperties helloProperties;    <span class="hljs-function"><span class="hljs-keyword">public</span> HelloProperties <span class="hljs-title">getHelloProperties</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> helloProperties;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setHelloProperties</span><span class="hljs-params">(HelloProperties helloProperties)</span> </span>&#123;        <span class="hljs-keyword">this</span>.helloProperties = helloProperties;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">sayHellAtguigu</span><span class="hljs-params">(String name)</span></span>&#123;        <span class="hljs-keyword">return</span> helloProperties.getPrefix()+<span class="hljs-string">"-"</span> +name + helloProperties.getSuffix();    &#125;&#125;</code></pre></div><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.starter;<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnWebApplication;<span class="hljs-keyword">import</span> org.springframework.boot.context.properties.EnableConfigurationProperties;<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<span class="hljs-meta">@Configuration</span><span class="hljs-meta">@ConditionalOnWebApplication</span> <span class="hljs-comment">//webåº”ç”¨æ‰ç”Ÿæ•ˆ</span><span class="hljs-meta">@EnableConfigurationProperties</span>(HelloProperties<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span><span class="hljs-class"><span class="hljs-title">public</span> <span class="hljs-title">class</span> <span class="hljs-title">HelloServiceAutoConfiguration</span> </span>&#123;    <span class="hljs-meta">@Autowired</span>    HelloProperties helloProperties;    <span class="hljs-meta">@Bean</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> HelloService <span class="hljs-title">helloService</span><span class="hljs-params">()</span></span>&#123;        HelloService service = <span class="hljs-keyword">new</span> HelloService();        service.setHelloProperties(helloProperties);        <span class="hljs-keyword">return</span> service;    &#125;&#125;</code></pre></div><h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
    
    
    <categories>
      
      <category>æ–°æ‰‹æ•™ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootå¯åŠ¨é…ç½®åŸç†</title>
    <link href="/2020/08/04/SpringBoot%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86/"/>
    <url>/2020/08/04/SpringBoot%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="å¯åŠ¨é…ç½®åŸç†"><a href="#å¯åŠ¨é…ç½®åŸç†" class="headerlink" title="å¯åŠ¨é…ç½®åŸç†"></a>å¯åŠ¨é…ç½®åŸç†</h1><p>å‡ ä¸ªé‡è¦çš„äº‹ä»¶å›è°ƒæœºåˆ¶</p><p>é…ç½®åœ¨META-INF/spring.factories</p><p><strong>ApplicationContextInitializer</strong></p><p><strong>SpringApplicationRunListener</strong></p><p>åªéœ€è¦æ”¾åœ¨iocå®¹å™¨ä¸­</p><p><strong>ApplicationRunner</strong></p><p><strong>CommandLineRunner</strong></p><p>å¯åŠ¨æµç¨‹ï¼š</p><h2 id="1ã€åˆ›å»ºSpringApplicationå¯¹è±¡"><a href="#1ã€åˆ›å»ºSpringApplicationå¯¹è±¡" class="headerlink" title="1ã€åˆ›å»ºSpringApplicationå¯¹è±¡"></a><strong>1ã€åˆ›å»ºSpringApplicationå¯¹è±¡</strong></h2><div class="hljs"><pre><code class="hljs java">initialize(sources);<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initialize</span><span class="hljs-params">(Object[] sources)</span> </span>&#123;    <span class="hljs-comment">//ä¿å­˜ä¸»é…ç½®ç±»</span>    <span class="hljs-keyword">if</span> (sources != <span class="hljs-keyword">null</span> &amp;&amp; sources.length &gt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">this</span>.sources.addAll(Arrays.asList(sources));    &#125;    <span class="hljs-comment">//åˆ¤æ–­å½“å‰æ˜¯å¦ä¸€ä¸ªwebåº”ç”¨</span>    <span class="hljs-keyword">this</span>.webEnvironment = deduceWebEnvironment();    <span class="hljs-comment">//ä»ç±»è·¯å¾„ä¸‹æ‰¾åˆ°META-INF/spring.factoriesé…ç½®çš„æ‰€æœ‰ApplicationContextInitializerï¼›ç„¶åä¿å­˜èµ·æ¥</span>    setInitializers((Collection) getSpringFactoriesInstances(        ApplicationContextInitializer<span class="hljs-class">.<span class="hljs-keyword">class</span>))</span>;    <span class="hljs-comment">//ä»ç±»è·¯å¾„ä¸‹æ‰¾åˆ°ETA-INF/spring.factoriesé…ç½®çš„æ‰€æœ‰ApplicationListener</span>    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener<span class="hljs-class">.<span class="hljs-keyword">class</span>))</span>;    <span class="hljs-comment">//ä»å¤šä¸ªé…ç½®ç±»ä¸­æ‰¾åˆ°æœ‰mainæ–¹æ³•çš„ä¸»é…ç½®ç±»</span>    <span class="hljs-keyword">this</span>.mainApplicationClass = deduceMainApplicationClass();&#125;</code></pre></div><p><img src="/2020/08/04/SpringBoot%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180306145727.png" srcset="/img/loading.gif" alt></p><p><img src="/2020/08/04/SpringBoot%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180306145855.png" srcset="/img/loading.gif" alt></p><h2 id="2ã€è¿è¡Œrunæ–¹æ³•"><a href="#2ã€è¿è¡Œrunæ–¹æ³•" class="headerlink" title="2ã€è¿è¡Œrunæ–¹æ³•"></a>2ã€è¿è¡Œrunæ–¹æ³•</h2><div class="hljs"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ConfigurableApplicationContext <span class="hljs-title">run</span><span class="hljs-params">(String... args)</span> </span>&#123;   StopWatch stopWatch = <span class="hljs-keyword">new</span> StopWatch();   stopWatch.start();   ConfigurableApplicationContext context = <span class="hljs-keyword">null</span>;   FailureAnalyzers analyzers = <span class="hljs-keyword">null</span>;   configureHeadlessProperty();       <span class="hljs-comment">//è·å–SpringApplicationRunListenersï¼›ä»ç±»è·¯å¾„ä¸‹META-INF/spring.factories</span>   SpringApplicationRunListeners listeners = getRunListeners(args);    <span class="hljs-comment">//å›è°ƒæ‰€æœ‰çš„è·å–SpringApplicationRunListener.starting()æ–¹æ³•</span>   listeners.starting();   <span class="hljs-keyword">try</span> &#123;       <span class="hljs-comment">//å°è£…å‘½ä»¤è¡Œå‚æ•°</span>      ApplicationArguments applicationArguments = <span class="hljs-keyword">new</span> DefaultApplicationArguments(            args);      <span class="hljs-comment">//å‡†å¤‡ç¯å¢ƒ</span>      ConfigurableEnvironment environment = prepareEnvironment(listeners,            applicationArguments);       <span class="hljs-comment">//åˆ›å»ºç¯å¢ƒå®Œæˆåå›è°ƒSpringApplicationRunListener.environmentPrepared()ï¼›è¡¨ç¤ºç¯å¢ƒå‡†å¤‡å®Œæˆ</span>             Banner printedBanner = printBanner(environment);              <span class="hljs-comment">//åˆ›å»ºApplicationContextï¼›å†³å®šåˆ›å»ºwebçš„iocè¿˜æ˜¯æ™®é€šçš„ioc</span>      context = createApplicationContext();             analyzers = <span class="hljs-keyword">new</span> FailureAnalyzers(context);       <span class="hljs-comment">//å‡†å¤‡ä¸Šä¸‹æ–‡ç¯å¢ƒ;å°†environmentä¿å­˜åˆ°iocä¸­ï¼›è€Œä¸”applyInitializers()ï¼›</span>       <span class="hljs-comment">//applyInitializers()ï¼šå›è°ƒä¹‹å‰ä¿å­˜çš„æ‰€æœ‰çš„ApplicationContextInitializerçš„initializeæ–¹æ³•</span>       <span class="hljs-comment">//å›è°ƒæ‰€æœ‰çš„SpringApplicationRunListenerçš„contextPrepared()ï¼›</span>       <span class="hljs-comment">//</span>      prepareContext(context, environment, listeners, applicationArguments,            printedBanner);       <span class="hljs-comment">//prepareContextè¿è¡Œå®Œæˆä»¥åå›è°ƒæ‰€æœ‰çš„SpringApplicationRunListenerçš„contextLoadedï¼ˆï¼‰ï¼›</span>              <span class="hljs-comment">//såˆ·æ–°å®¹å™¨ï¼›iocå®¹å™¨åˆå§‹åŒ–ï¼ˆå¦‚æœæ˜¯webåº”ç”¨è¿˜ä¼šåˆ›å»ºåµŒå…¥å¼çš„Tomcatï¼‰ï¼›Springæ³¨è§£ç‰ˆ</span>       <span class="hljs-comment">//æ‰«æï¼Œåˆ›å»ºï¼ŒåŠ è½½æ‰€æœ‰ç»„ä»¶çš„åœ°æ–¹ï¼›ï¼ˆé…ç½®ç±»ï¼Œç»„ä»¶ï¼Œè‡ªåŠ¨é…ç½®ï¼‰</span>      refreshContext(context);       <span class="hljs-comment">//ä»iocå®¹å™¨ä¸­è·å–æ‰€æœ‰çš„ApplicationRunnerå’ŒCommandLineRunnerè¿›è¡Œå›è°ƒ</span>       <span class="hljs-comment">//ApplicationRunnerå…ˆå›è°ƒï¼ŒCommandLineRunnerå†å›è°ƒ</span>      afterRefresh(context, applicationArguments);       <span class="hljs-comment">//æ‰€æœ‰çš„SpringApplicationRunListenerå›è°ƒfinishedæ–¹æ³•</span>      listeners.finished(context, <span class="hljs-keyword">null</span>);      stopWatch.stop();      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.logStartupInfo) &#123;         <span class="hljs-keyword">new</span> StartupInfoLogger(<span class="hljs-keyword">this</span>.mainApplicationClass)               .logStarted(getApplicationLog(), stopWatch);      &#125;       <span class="hljs-comment">//æ•´ä¸ªSpringBootåº”ç”¨å¯åŠ¨å®Œæˆä»¥åè¿”å›å¯åŠ¨çš„iocå®¹å™¨ï¼›</span>      <span class="hljs-keyword">return</span> context;   &#125;   <span class="hljs-keyword">catch</span> (Throwable ex) &#123;      handleRunFailure(context, listeners, analyzers, ex);      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(ex);   &#125;&#125;</code></pre></div><h2 id="3ã€äº‹ä»¶ç›‘å¬æœºåˆ¶"><a href="#3ã€äº‹ä»¶ç›‘å¬æœºåˆ¶" class="headerlink" title="3ã€äº‹ä»¶ç›‘å¬æœºåˆ¶"></a>3ã€äº‹ä»¶ç›‘å¬æœºåˆ¶</h2><p>é…ç½®åœ¨META-INF/spring.factories</p><p><strong>ApplicationContextInitializer</strong></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloApplicationContextInitializer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ApplicationContextInitializer</span>&lt;<span class="hljs-title">ConfigurableApplicationContext</span>&gt; </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initialize</span><span class="hljs-params">(ConfigurableApplicationContext applicationContext)</span> </span>&#123;        System.out.println(<span class="hljs-string">"ApplicationContextInitializer...initialize..."</span>+applicationContext);    &#125;&#125;</code></pre></div><p><strong>SpringApplicationRunListener</strong></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloSpringApplicationRunListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">SpringApplicationRunListener</span> </span>&#123;    <span class="hljs-comment">//å¿…é¡»æœ‰çš„æ„é€ å™¨</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HelloSpringApplicationRunListener</span><span class="hljs-params">(SpringApplication application, String[] args)</span></span>&#123;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">starting</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"SpringApplicationRunListener...starting..."</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">environmentPrepared</span><span class="hljs-params">(ConfigurableEnvironment environment)</span> </span>&#123;        Object o = environment.getSystemProperties().get(<span class="hljs-string">"os.name"</span>);        System.out.println(<span class="hljs-string">"SpringApplicationRunListener...environmentPrepared.."</span>+o);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextPrepared</span><span class="hljs-params">(ConfigurableApplicationContext context)</span> </span>&#123;        System.out.println(<span class="hljs-string">"SpringApplicationRunListener...contextPrepared..."</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextLoaded</span><span class="hljs-params">(ConfigurableApplicationContext context)</span> </span>&#123;        System.out.println(<span class="hljs-string">"SpringApplicationRunListener...contextLoaded..."</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">finished</span><span class="hljs-params">(ConfigurableApplicationContext context, Throwable exception)</span> </span>&#123;        System.out.println(<span class="hljs-string">"SpringApplicationRunListener...finished..."</span>);    &#125;&#125;</code></pre></div><p>é…ç½®ï¼ˆMETA-INF/spring.factoriesï¼‰</p><div class="hljs"><pre><code class="hljs properties"><span class="hljs-meta">org.springframework.context.ApplicationContextInitializer</span>=<span class="hljs-string">\</span><span class="hljs-attr">com.atguigu.springboot.listener.HelloApplicationContextInitializer</span><span class="hljs-meta">org.springframework.boot.SpringApplicationRunListener</span>=<span class="hljs-string">\</span><span class="hljs-attr">com.atguigu.springboot.listener.HelloSpringApplicationRunListener</span></code></pre></div><p>åªéœ€è¦æ”¾åœ¨iocå®¹å™¨ä¸­</p><p><strong>ApplicationRunner</strong></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloApplicationRunner</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ApplicationRunner</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">(ApplicationArguments args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;        System.out.println(<span class="hljs-string">"ApplicationRunner...run...."</span>);    &#125;&#125;</code></pre></div><p><strong>CommandLineRunner</strong></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloCommandLineRunner</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CommandLineRunner</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">(String... args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;        System.out.println(<span class="hljs-string">"CommandLineRunner...run..."</span>+ Arrays.asList(args));    &#125;&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>æºç åˆ†æ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootä¸æ•°æ®è®¿é—®</title>
    <link href="/2020/08/04/SpringBoot%E4%B8%8E%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE/"/>
    <url>/2020/08/04/SpringBoot%E4%B8%8E%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="SpringBootä¸æ•°æ®è®¿é—®"><a href="#SpringBootä¸æ•°æ®è®¿é—®" class="headerlink" title="SpringBootä¸æ•°æ®è®¿é—®"></a>SpringBootä¸æ•°æ®è®¿é—®</h1><h2 id="1ã€JDBC"><a href="#1ã€JDBC" class="headerlink" title="1ã€JDBC"></a>1ã€JDBC</h2><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre></div><div class="hljs"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span>  <span class="hljs-attr">datasource:</span>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.15.22:3306/jdbc</span>    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.jdbc.Driver</span></code></pre></div><p>æ•ˆæœï¼š</p><p>â€‹    é»˜è®¤æ˜¯ç”¨org.apache.tomcat.jdbc.pool.DataSourceä½œä¸ºæ•°æ®æºï¼›</p><p>â€‹    æ•°æ®æºçš„ç›¸å…³é…ç½®éƒ½åœ¨DataSourcePropertiesé‡Œé¢ï¼›</p><p>è‡ªåŠ¨é…ç½®åŸç†ï¼š</p><p>org.springframework.boot.autoconfigure.jdbcï¼š</p><p>1ã€å‚è€ƒDataSourceConfigurationï¼Œæ ¹æ®é…ç½®åˆ›å»ºæ•°æ®æºï¼Œé»˜è®¤ä½¿ç”¨Tomcatè¿æ¥æ± ï¼›å¯ä»¥ä½¿ç”¨spring.datasource.typeæŒ‡å®šè‡ªå®šä¹‰çš„æ•°æ®æºç±»å‹ï¼›</p><p>2ã€SpringBooté»˜è®¤å¯ä»¥æ”¯æŒï¼›</p><div class="hljs"><pre><code class="hljs css"><span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.tomcat</span><span class="hljs-selector-class">.jdbc</span><span class="hljs-selector-class">.pool</span><span class="hljs-selector-class">.DataSource</span>ã€<span class="hljs-selector-tag">HikariDataSource</span>ã€<span class="hljs-selector-tag">BasicDataSource</span>ã€</code></pre></div><p>3ã€è‡ªå®šä¹‰æ•°æ®æºç±»å‹</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * Generic DataSource configuration.</span><span class="hljs-comment"> */</span><span class="hljs-meta">@ConditionalOnMissingBean</span>(DataSource<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span><span class="hljs-class">@<span class="hljs-title">ConditionalOnProperty</span>(<span class="hljs-title">name</span> </span>= <span class="hljs-string">"spring.datasource.type"</span>)<span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Generic</span> </span>&#123;   <span class="hljs-meta">@Bean</span>   <span class="hljs-function"><span class="hljs-keyword">public</span> DataSource <span class="hljs-title">dataSource</span><span class="hljs-params">(DataSourceProperties properties)</span> </span>&#123;       <span class="hljs-comment">//ä½¿ç”¨DataSourceBuilderåˆ›å»ºæ•°æ®æºï¼Œåˆ©ç”¨åå°„åˆ›å»ºå“åº”typeçš„æ•°æ®æºï¼Œå¹¶ä¸”ç»‘å®šç›¸å…³å±æ€§</span>      <span class="hljs-keyword">return</span> properties.initializeDataSourceBuilder().build();   &#125;&#125;</code></pre></div><p>4ã€<strong>DataSourceInitializerï¼šApplicationListener</strong>ï¼›</p><p>â€‹    ä½œç”¨ï¼š</p><p>â€‹        1ï¼‰ã€runSchemaScripts();è¿è¡Œå»ºè¡¨è¯­å¥ï¼›</p><p>â€‹        2ï¼‰ã€runDataScripts();è¿è¡Œæ’å…¥æ•°æ®çš„sqlè¯­å¥ï¼›</p><p>é»˜è®¤åªéœ€è¦å°†æ–‡ä»¶å‘½åä¸ºï¼š</p><div class="hljs"><pre><code class="hljs properties"><span class="hljs-attr">schema-*.sqlã€data-*.sql</span><span class="hljs-attr">é»˜è®¤è§„åˆ™ï¼šschema.sqlï¼Œschema-all.sqlï¼›</span><span class="hljs-meta">å¯ä»¥ä½¿ç”¨</span>   <span class="hljs-string"></span><span class="hljs-attr">schema</span>:<span class="hljs-string"></span>      <span class="hljs-meta">-</span> <span class="hljs-string">classpath:department.sql</span>      <span class="hljs-attr">æŒ‡å®šä½ç½®</span></code></pre></div><p>5ã€æ“ä½œæ•°æ®åº“ï¼šè‡ªåŠ¨é…ç½®äº†JdbcTemplateæ“ä½œæ•°æ®åº“</p><h2 id="2ã€æ•´åˆDruidæ•°æ®æº"><a href="#2ã€æ•´åˆDruidæ•°æ®æº" class="headerlink" title="2ã€æ•´åˆDruidæ•°æ®æº"></a>2ã€æ•´åˆDruidæ•°æ®æº</h2><div class="hljs"><pre><code class="hljs java">å¯¼å…¥druidæ•°æ®æº<span class="hljs-meta">@Configuration</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DruidConfig</span> </span>&#123;    <span class="hljs-meta">@ConfigurationProperties</span>(prefix = <span class="hljs-string">"spring.datasource"</span>)    <span class="hljs-meta">@Bean</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> DataSource <span class="hljs-title">druid</span><span class="hljs-params">()</span></span>&#123;       <span class="hljs-keyword">return</span>  <span class="hljs-keyword">new</span> DruidDataSource();    &#125;    <span class="hljs-comment">//é…ç½®Druidçš„ç›‘æ§</span>    <span class="hljs-comment">//1ã€é…ç½®ä¸€ä¸ªç®¡ç†åå°çš„Servlet</span>    <span class="hljs-meta">@Bean</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> ServletRegistrationBean <span class="hljs-title">statViewServlet</span><span class="hljs-params">()</span></span>&#123;        ServletRegistrationBean bean = <span class="hljs-keyword">new</span> ServletRegistrationBean(<span class="hljs-keyword">new</span> StatViewServlet(), <span class="hljs-string">"/druid/*"</span>);        Map&lt;String,String&gt; initParams = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();        initParams.put(<span class="hljs-string">"loginUsername"</span>,<span class="hljs-string">"admin"</span>);        initParams.put(<span class="hljs-string">"loginPassword"</span>,<span class="hljs-string">"123456"</span>);        initParams.put(<span class="hljs-string">"allow"</span>,<span class="hljs-string">""</span>);<span class="hljs-comment">//é»˜è®¤å°±æ˜¯å…è®¸æ‰€æœ‰è®¿é—®</span>        initParams.put(<span class="hljs-string">"deny"</span>,<span class="hljs-string">"192.168.15.21"</span>);        bean.setInitParameters(initParams);        <span class="hljs-keyword">return</span> bean;    &#125;    <span class="hljs-comment">//2ã€é…ç½®ä¸€ä¸ªwebç›‘æ§çš„filter</span>    <span class="hljs-meta">@Bean</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> FilterRegistrationBean <span class="hljs-title">webStatFilter</span><span class="hljs-params">()</span></span>&#123;        FilterRegistrationBean bean = <span class="hljs-keyword">new</span> FilterRegistrationBean();        bean.setFilter(<span class="hljs-keyword">new</span> WebStatFilter());        Map&lt;String,String&gt; initParams = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();        initParams.put(<span class="hljs-string">"exclusions"</span>,<span class="hljs-string">"*.js,*.css,/druid/*"</span>);        bean.setInitParameters(initParams);        bean.setUrlPatterns(Arrays.asList(<span class="hljs-string">"/*"</span>));        <span class="hljs-keyword">return</span>  bean;    &#125;&#125;</code></pre></div><h2 id="3ã€æ•´åˆMyBatis"><a href="#3ã€æ•´åˆMyBatis" class="headerlink" title="3ã€æ•´åˆMyBatis"></a>3ã€æ•´åˆMyBatis</h2><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre></div><p><img src="/2020/08/04/SpringBoot%E4%B8%8E%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180305194443.png" srcset="/img/loading.gif" alt></p><p>æ­¥éª¤ï¼š</p><p>â€‹    1ï¼‰ã€é…ç½®æ•°æ®æºç›¸å…³å±æ€§ï¼ˆè§ä¸Šä¸€èŠ‚Druidï¼‰</p><p>â€‹    2ï¼‰ã€ç»™æ•°æ®åº“å»ºè¡¨</p><p>â€‹    3ï¼‰ã€åˆ›å»ºJavaBean</p><h3 id="4ï¼‰ã€æ³¨è§£ç‰ˆ"><a href="#4ï¼‰ã€æ³¨è§£ç‰ˆ" class="headerlink" title="4ï¼‰ã€æ³¨è§£ç‰ˆ"></a>4ï¼‰ã€æ³¨è§£ç‰ˆ</h3><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//æŒ‡å®šè¿™æ˜¯ä¸€ä¸ªæ“ä½œæ•°æ®åº“çš„mapper</span><span class="hljs-meta">@Mapper</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">DepartmentMapper</span> </span>&#123;    <span class="hljs-meta">@Select</span>(<span class="hljs-string">"select * from department where id=#&#123;id&#125;"</span>)    <span class="hljs-function"><span class="hljs-keyword">public</span> Department <span class="hljs-title">getDeptById</span><span class="hljs-params">(Integer id)</span></span>;    <span class="hljs-meta">@Delete</span>(<span class="hljs-string">"delete from department where id=#&#123;id&#125;"</span>)    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">deleteDeptById</span><span class="hljs-params">(Integer id)</span></span>;    <span class="hljs-meta">@Options</span>(useGeneratedKeys = <span class="hljs-keyword">true</span>,keyProperty = <span class="hljs-string">"id"</span>)    <span class="hljs-meta">@Insert</span>(<span class="hljs-string">"insert into department(departmentName) values(#&#123;departmentName&#125;)"</span>)    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">insertDept</span><span class="hljs-params">(Department department)</span></span>;    <span class="hljs-meta">@Update</span>(<span class="hljs-string">"update department set departmentName=#&#123;departmentName&#125; where id=#&#123;id&#125;"</span>)    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">updateDept</span><span class="hljs-params">(Department department)</span></span>;&#125;</code></pre></div><p>é—®é¢˜ï¼š</p><p>è‡ªå®šä¹‰MyBatisçš„é…ç½®è§„åˆ™ï¼›ç»™å®¹å™¨ä¸­æ·»åŠ ä¸€ä¸ªConfigurationCustomizerï¼›</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@org</span>.springframework.context.annotation.Configuration<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBatisConfig</span> </span>&#123;    <span class="hljs-meta">@Bean</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> ConfigurationCustomizer <span class="hljs-title">configurationCustomizer</span><span class="hljs-params">()</span></span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConfigurationCustomizer()&#123;            <span class="hljs-meta">@Override</span>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">customize</span><span class="hljs-params">(Configuration configuration)</span> </span>&#123;                configuration.setMapUnderscoreToCamelCase(<span class="hljs-keyword">true</span>);            &#125;        &#125;;    &#125;&#125;</code></pre></div><div class="hljs"><pre><code class="hljs java">ä½¿ç”¨MapperScanæ‰¹é‡æ‰«ææ‰€æœ‰çš„Mapperæ¥å£ï¼›<span class="hljs-meta">@MapperScan</span>(value = <span class="hljs-string">"com.atguigu.springboot.mapper"</span>)<span class="hljs-meta">@SpringBootApplication</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringBoot06DataMybatisApplication</span> </span>&#123;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;SpringApplication.run(SpringBoot06DataMybatisApplication<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">args</span>)</span>;&#125;&#125;</code></pre></div><h3 id="5ï¼‰ã€é…ç½®æ–‡ä»¶ç‰ˆ"><a href="#5ï¼‰ã€é…ç½®æ–‡ä»¶ç‰ˆ" class="headerlink" title="5ï¼‰ã€é…ç½®æ–‡ä»¶ç‰ˆ"></a>5ï¼‰ã€é…ç½®æ–‡ä»¶ç‰ˆ</h3><div class="hljs"><pre><code class="hljs yaml"><span class="hljs-attr">mybatis:</span>  <span class="hljs-attr">config-location:</span> <span class="hljs-string">classpath:mybatis/mybatis-config.xml</span> <span class="hljs-string">æŒ‡å®šå…¨å±€é…ç½®æ–‡ä»¶çš„ä½ç½®</span>  <span class="hljs-attr">mapper-locations:</span> <span class="hljs-string">classpath:mybatis/mapper/*.xml</span>  <span class="hljs-string">æŒ‡å®šsqlæ˜ å°„æ–‡ä»¶çš„ä½ç½®</span></code></pre></div><p>æ›´å¤šä½¿ç”¨å‚ç…§</p><p><a href="http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/" target="_blank" rel="noopener">http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/</a></p><h2 id="4ã€æ•´åˆSpringData-JPA"><a href="#4ã€æ•´åˆSpringData-JPA" class="headerlink" title="4ã€æ•´åˆSpringData JPA"></a>4ã€æ•´åˆSpringData JPA</h2><h3 id="1ï¼‰ã€SpringDataç®€ä»‹"><a href="#1ï¼‰ã€SpringDataç®€ä»‹" class="headerlink" title="1ï¼‰ã€SpringDataç®€ä»‹"></a>1ï¼‰ã€SpringDataç®€ä»‹</h3><p><img src="/2020/08/04/SpringBoot%E4%B8%8E%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180306105412.png" srcset="/img/loading.gif" alt></p><h3 id="2ï¼‰ã€æ•´åˆSpringData-JPA"><a href="#2ï¼‰ã€æ•´åˆSpringData-JPA" class="headerlink" title="2ï¼‰ã€æ•´åˆSpringData JPA"></a>2ï¼‰ã€æ•´åˆSpringData JPA</h3><p>JPA:ORMï¼ˆObject Relational Mappingï¼‰ï¼›</p><p>1ï¼‰ã€ç¼–å†™ä¸€ä¸ªå®ä½“ç±»ï¼ˆbeanï¼‰å’Œæ•°æ®è¡¨è¿›è¡Œæ˜ å°„ï¼Œå¹¶ä¸”é…ç½®å¥½æ˜ å°„å…³ç³»ï¼›</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//ä½¿ç”¨JPAæ³¨è§£é…ç½®æ˜ å°„å…³ç³»</span><span class="hljs-meta">@Entity</span> <span class="hljs-comment">//å‘Šè¯‰JPAè¿™æ˜¯ä¸€ä¸ªå®ä½“ç±»ï¼ˆå’Œæ•°æ®è¡¨æ˜ å°„çš„ç±»ï¼‰</span><span class="hljs-meta">@Table</span>(name = <span class="hljs-string">"tbl_user"</span>) <span class="hljs-comment">//@Tableæ¥æŒ‡å®šå’Œå“ªä¸ªæ•°æ®è¡¨å¯¹åº”;å¦‚æœçœç•¥é»˜è®¤è¡¨åå°±æ˜¯userï¼›</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;    <span class="hljs-meta">@Id</span> <span class="hljs-comment">//è¿™æ˜¯ä¸€ä¸ªä¸»é”®</span>    <span class="hljs-meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)<span class="hljs-comment">//è‡ªå¢ä¸»é”®</span>    <span class="hljs-keyword">private</span> Integer id;    <span class="hljs-meta">@Column</span>(name = <span class="hljs-string">"last_name"</span>,length = <span class="hljs-number">50</span>) <span class="hljs-comment">//è¿™æ˜¯å’Œæ•°æ®è¡¨å¯¹åº”çš„ä¸€ä¸ªåˆ—</span>    <span class="hljs-keyword">private</span> String lastName;    <span class="hljs-meta">@Column</span> <span class="hljs-comment">//çœç•¥é»˜è®¤åˆ—åå°±æ˜¯å±æ€§å</span>    <span class="hljs-keyword">private</span> String email;</code></pre></div><p>2ï¼‰ã€ç¼–å†™ä¸€ä¸ªDaoæ¥å£æ¥æ“ä½œå®ä½“ç±»å¯¹åº”çš„æ•°æ®è¡¨ï¼ˆRepositoryï¼‰</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//ç»§æ‰¿JpaRepositoryæ¥å®Œæˆå¯¹æ•°æ®åº“çš„æ“ä½œ</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">JpaRepository</span>&lt;<span class="hljs-title">User</span>,<span class="hljs-title">Integer</span>&gt; </span>&#123;&#125;</code></pre></div><p>3ï¼‰ã€åŸºæœ¬çš„é…ç½®JpaProperties</p><div class="hljs"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span>   <span class="hljs-attr">jpa:</span>    <span class="hljs-attr">hibernate:</span><span class="hljs-comment">#     æ›´æ–°æˆ–è€…åˆ›å»ºæ•°æ®è¡¨ç»“æ„</span>      <span class="hljs-attr">ddl-auto:</span> <span class="hljs-string">update</span><span class="hljs-comment">#    æ§åˆ¶å°æ˜¾ç¤ºSQL</span>    <span class="hljs-attr">show-sql:</span> <span class="hljs-literal">true</span></code></pre></div><h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
    
    
    <categories>
      
      <category>æ–°æ‰‹æ•™ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
      <tag>MyBatis</tag>
      
      <tag>JDBC</tag>
      
      <tag>SpringData JPA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dockerå…¥é—¨</title>
    <link href="/2020/08/03/Docker%E5%85%A5%E9%97%A8/"/>
    <url>/2020/08/03/Docker%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h2 id="1ã€ç®€ä»‹"><a href="#1ã€ç®€ä»‹" class="headerlink" title="1ã€ç®€ä»‹"></a>1ã€ç®€ä»‹</h2><p><strong>Docker</strong>æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼›æ˜¯ä¸€ä¸ªè½»é‡çº§å®¹å™¨æŠ€æœ¯ï¼›</p><p>Dockeræ”¯æŒå°†è½¯ä»¶ç¼–è¯‘æˆä¸€ä¸ªé•œåƒï¼›ç„¶ååœ¨é•œåƒä¸­å„ç§è½¯ä»¶åšå¥½é…ç½®ï¼Œå°†é•œåƒå‘å¸ƒå‡ºå»ï¼Œå…¶ä»–ä½¿ç”¨è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªé•œåƒï¼›</p><p>è¿è¡Œä¸­çš„è¿™ä¸ªé•œåƒç§°ä¸ºå®¹å™¨ï¼Œå®¹å™¨å¯åŠ¨æ˜¯éå¸¸å¿«é€Ÿçš„ã€‚</p><p><img src="/2020/08/03/Docker%E5%85%A5%E9%97%A8/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180303145450.png" srcset="/img/loading.gif" alt></p><p><img src="/2020/08/03/Docker%E5%85%A5%E9%97%A8/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180303145531.png" srcset="/img/loading.gif" alt></p><h2 id="2ã€æ ¸å¿ƒæ¦‚å¿µ"><a href="#2ã€æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="2ã€æ ¸å¿ƒæ¦‚å¿µ"></a>2ã€æ ¸å¿ƒæ¦‚å¿µ</h2><p>dockerä¸»æœº(Host)ï¼šå®‰è£…äº†Dockerç¨‹åºçš„æœºå™¨ï¼ˆDockerç›´æ¥å®‰è£…åœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šï¼‰ï¼›</p><p>dockerå®¢æˆ·ç«¯(Client)ï¼šè¿æ¥dockerä¸»æœºè¿›è¡Œæ“ä½œï¼›</p><p>dockerä»“åº“(Registry)ï¼šç”¨æ¥ä¿å­˜å„ç§æ‰“åŒ…å¥½çš„è½¯ä»¶é•œåƒï¼›</p><p>dockeré•œåƒ(Images)ï¼šè½¯ä»¶æ‰“åŒ…å¥½çš„é•œåƒï¼›æ”¾åœ¨dockerä»“åº“ä¸­ï¼›</p><p>dockerå®¹å™¨(Container)ï¼šé•œåƒå¯åŠ¨åçš„å®ä¾‹ç§°ä¸ºä¸€ä¸ªå®¹å™¨ï¼›å®¹å™¨æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨</p><p><img src="/2020/08/03/Docker%E5%85%A5%E9%97%A8/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180303165113.png" srcset="/img/loading.gif" alt></p><p>ä½¿ç”¨Dockerçš„æ­¥éª¤ï¼š</p><p>1ï¼‰ã€å®‰è£…Docker</p><p>2ï¼‰ã€å»Dockerä»“åº“æ‰¾åˆ°è¿™ä¸ªè½¯ä»¶å¯¹åº”çš„é•œåƒï¼›</p><p>3ï¼‰ã€ä½¿ç”¨Dockerè¿è¡Œè¿™ä¸ªé•œåƒï¼Œè¿™ä¸ªé•œåƒå°±ä¼šç”Ÿæˆä¸€ä¸ªDockerå®¹å™¨ï¼›</p><p>4ï¼‰ã€å¯¹å®¹å™¨çš„å¯åŠ¨åœæ­¢å°±æ˜¯å¯¹è½¯ä»¶çš„å¯åŠ¨åœæ­¢ï¼›</p><h2 id="3ã€å®‰è£…Docker"><a href="#3ã€å®‰è£…Docker" class="headerlink" title="3ã€å®‰è£…Docker"></a>3ã€å®‰è£…Docker</h2><h4 id="1ï¼‰ã€å®‰è£…linuxè™šæ‹Ÿæœº"><a href="#1ï¼‰ã€å®‰è£…linuxè™šæ‹Ÿæœº" class="headerlink" title="1ï¼‰ã€å®‰è£…linuxè™šæ‹Ÿæœº"></a>1ï¼‰ã€å®‰è£…linuxè™šæ‹Ÿæœº</h4><p>â€‹    1ï¼‰ã€VMWareã€VirtualBoxï¼ˆå®‰è£…ï¼‰ï¼›</p><p>â€‹    2ï¼‰ã€å¯¼å…¥è™šæ‹Ÿæœºæ–‡ä»¶centos7-atguigu.ovaï¼›</p><p>â€‹    3ï¼‰ã€åŒå‡»å¯åŠ¨linuxè™šæ‹Ÿæœº;ä½¿ç”¨  root/ 123456ç™»é™†</p><p>â€‹    4ï¼‰ã€ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥linuxæœåŠ¡å™¨è¿›è¡Œå‘½ä»¤æ“ä½œï¼›</p><p>â€‹    5ï¼‰ã€è®¾ç½®è™šæ‹Ÿæœºç½‘ç»œï¼›</p><p>â€‹        æ¡¥æ¥ç½‘ç»œ===é€‰å¥½ç½‘å¡====æ¥å…¥ç½‘çº¿ï¼›</p><p>â€‹    6ï¼‰ã€è®¾ç½®å¥½ç½‘ç»œä»¥åä½¿ç”¨å‘½ä»¤é‡å¯è™šæ‹Ÿæœºçš„ç½‘ç»œ</p><div class="hljs"><pre><code class="hljs shell">service network restart</code></pre></div><p>â€‹    7ï¼‰ã€æŸ¥çœ‹linuxçš„ipåœ°å€</p><div class="hljs"><pre><code class="hljs shell">ip addr</code></pre></div><p>â€‹    8ï¼‰ã€ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥linuxï¼›</p><h4 id="2ï¼‰ã€åœ¨linuxè™šæ‹Ÿæœºä¸Šå®‰è£…docker"><a href="#2ï¼‰ã€åœ¨linuxè™šæ‹Ÿæœºä¸Šå®‰è£…docker" class="headerlink" title="2ï¼‰ã€åœ¨linuxè™šæ‹Ÿæœºä¸Šå®‰è£…docker"></a>2ï¼‰ã€åœ¨linuxè™šæ‹Ÿæœºä¸Šå®‰è£…docker</h4><p>æ­¥éª¤ï¼š</p><div class="hljs"><pre><code class="hljs shell">1ã€æ£€æŸ¥å†…æ ¸ç‰ˆæœ¬ï¼Œå¿…é¡»æ˜¯3.10åŠä»¥ä¸Šuname -r2ã€å®‰è£…dockeryum install docker3ã€è¾“å…¥yç¡®è®¤å®‰è£…4ã€å¯åŠ¨docker[root@localhost ~]# systemctl start docker[root@localhost ~]# docker -vDocker version 1.12.6, build 3e8e77d/1.12.65ã€å¼€æœºå¯åŠ¨docker[root@localhost ~]# systemctl enable dockerCreated symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.6ã€åœæ­¢dockersystemctl stop docker</code></pre></div><h2 id="4ã€Dockerå¸¸ç”¨å‘½ä»¤-amp-æ“ä½œ"><a href="#4ã€Dockerå¸¸ç”¨å‘½ä»¤-amp-æ“ä½œ" class="headerlink" title="4ã€Dockerå¸¸ç”¨å‘½ä»¤&amp;æ“ä½œ"></a>4ã€Dockerå¸¸ç”¨å‘½ä»¤&amp;æ“ä½œ</h2><h3 id="1ï¼‰é•œåƒæ“ä½œ"><a href="#1ï¼‰é•œåƒæ“ä½œ" class="headerlink" title="1ï¼‰é•œåƒæ“ä½œ"></a>1ï¼‰é•œåƒæ“ä½œ</h3><table><thead><tr><th>æ“ä½œ</th><th>å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ£€ç´¢</td><td>docker  search å…³é”®å­—  egï¼šdocker  search redis</td><td>æˆ‘ä»¬ç»å¸¸å»docker  hubä¸Šæ£€ç´¢é•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚é•œåƒçš„TAGã€‚</td></tr><tr><td>æ‹‰å–</td><td>docker pull é•œåƒå:tag</td><td>:tagæ˜¯å¯é€‰çš„ï¼Œtagè¡¨ç¤ºæ ‡ç­¾ï¼Œå¤šä¸ºè½¯ä»¶çš„ç‰ˆæœ¬ï¼Œé»˜è®¤æ˜¯latest</td></tr><tr><td>åˆ—è¡¨</td><td>docker images</td><td>æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°é•œåƒ</td></tr><tr><td>åˆ é™¤</td><td>docker rmi image-id</td><td>åˆ é™¤æŒ‡å®šçš„æœ¬åœ°é•œåƒ</td></tr></tbody></table><p><a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a></p><h3 id="2ï¼‰å®¹å™¨æ“ä½œ"><a href="#2ï¼‰å®¹å™¨æ“ä½œ" class="headerlink" title="2ï¼‰å®¹å™¨æ“ä½œ"></a>2ï¼‰å®¹å™¨æ“ä½œ</h3><p>è½¯ä»¶é•œåƒï¼ˆQQå®‰è£…ç¨‹åºï¼‰â€”-è¿è¡Œé•œåƒâ€”-äº§ç”Ÿä¸€ä¸ªå®¹å™¨ï¼ˆæ­£åœ¨è¿è¡Œçš„è½¯ä»¶ï¼Œè¿è¡Œçš„QQï¼‰ï¼›</p><p>æ­¥éª¤ï¼š</p><div class="hljs"><pre><code class="hljs shell">1ã€æœç´¢é•œåƒ[root@localhost ~]# docker search tomcat2ã€æ‹‰å–é•œåƒ[root@localhost ~]# docker pull tomcat3ã€æ ¹æ®é•œåƒå¯åŠ¨å®¹å™¨docker run --name mytomcat -d tomcat:latest4ã€docker ps  æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨5ã€ åœæ­¢è¿è¡Œä¸­çš„å®¹å™¨docker stop  å®¹å™¨çš„id6ã€æŸ¥çœ‹æ‰€æœ‰çš„å®¹å™¨docker ps -a7ã€å¯åŠ¨å®¹å™¨docker start å®¹å™¨id8ã€åˆ é™¤ä¸€ä¸ªå®¹å™¨ docker rm å®¹å™¨id9ã€å¯åŠ¨ä¸€ä¸ªåšäº†ç«¯å£æ˜ å°„çš„tomcat[root@localhost ~]# docker run -d -p 8888:8080 tomcat-dï¼šåå°è¿è¡Œ-p: å°†ä¸»æœºçš„ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„ä¸€ä¸ªç«¯å£    ä¸»æœºç«¯å£:å®¹å™¨å†…éƒ¨çš„ç«¯å£10ã€ä¸ºäº†æ¼”ç¤ºç®€å•å…³é—­äº†linuxçš„é˜²ç«å¢™service firewalld status ï¼›æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€service firewalld stopï¼šå…³é—­é˜²ç«å¢™11ã€æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—docker logs container-name/container-idæ›´å¤šå‘½ä»¤å‚çœ‹https://docs.docker.com/engine/reference/commandline/docker/å¯ä»¥å‚è€ƒæ¯ä¸€ä¸ªé•œåƒçš„æ–‡æ¡£</code></pre></div><h3 id="3ï¼‰å®‰è£…MySQLç¤ºä¾‹"><a href="#3ï¼‰å®‰è£…MySQLç¤ºä¾‹" class="headerlink" title="3ï¼‰å®‰è£…MySQLç¤ºä¾‹"></a>3ï¼‰å®‰è£…MySQLç¤ºä¾‹</h3><div class="hljs"><pre><code class="hljs shell">docker pull mysql</code></pre></div><p>é”™è¯¯çš„å¯åŠ¨</p><div class="hljs"><pre><code class="hljs shell">[root@localhost ~]# docker run --name mysql01 -d mysql42f09819908bb72dd99ae19e792e0a5d03c48638421fa64cce5f8ba0f40f5846mysqlé€€å‡ºäº†[root@localhost ~]# docker ps -aCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                           PORTS               NAMES42f09819908b        mysql               "docker-entrypoint.sh"   34 seconds ago      Exited (1) 33 seconds ago                            mysql01538bde63e500        tomcat              "catalina.sh run"        About an hour ago   Exited (143) About an hour ago                       compassionate_goldstinec4f1ac60b3fc        tomcat              "catalina.sh run"        About an hour ago   Exited (143) About an hour ago                       lonely_fermi81ec743a5271        tomcat              "catalina.sh run"        About an hour ago   Exited (143) About an hour ago                       sick_ramanujan//é”™è¯¯æ—¥å¿—[root@localhost ~]# docker logs 42f09819908berror: database is uninitialized and password option is not specified   You need to specify one of MYSQL_ROOT_PASSWORD, MYSQL_ALLOW_EMPTY_PASSWORD and MYSQL_RANDOM_ROOT_PASSWORDï¼›è¿™ä¸ªä¸‰ä¸ªå‚æ•°å¿…é¡»æŒ‡å®šä¸€ä¸ª</code></pre></div><p>æ­£ç¡®çš„å¯åŠ¨</p><div class="hljs"><pre><code class="hljs shell">[root@localhost ~]# docker run --name mysql01 -e MYSQL_ROOT_PASSWORD=123456 -d mysqlb874c56bec49fb43024b3805ab51e9097da779f2f572c22c695305dedd684c5f[root@localhost ~]# docker psCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMESb874c56bec49        mysql               "docker-entrypoint.sh"   4 seconds ago       Up 3 seconds        3306/tcp            mysql01</code></pre></div><p>åšäº†ç«¯å£æ˜ å°„</p><div class="hljs"><pre><code class="hljs shell">[root@localhost ~]# docker run -p 3306:3306 --name mysql02 -e MYSQL_ROOT_PASSWORD=123456 -d mysqlad10e4bc5c6a0f61cbad43898de71d366117d120e39db651844c0e73863b9434[root@localhost ~]# docker psCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMESad10e4bc5c6a        mysql               "docker-entrypoint.sh"   4 seconds ago       Up 2 seconds        0.0.0.0:3306-&gt;3306/tcp   mysql02</code></pre></div><p>å‡ ä¸ªå…¶ä»–çš„é«˜çº§æ“ä½œ</p><div class="hljs"><pre><code class="hljs routeros">docker <span class="hljs-builtin-name">run</span> --name mysql03 -v /conf/mysql:/etc/mysql/conf.d -e <span class="hljs-attribute">MYSQL_ROOT_PASSWORD</span>=my-secret-pw -d mysql:tagæŠŠä¸»æœºçš„/conf/mysqlæ–‡ä»¶å¤¹æŒ‚è½½åˆ° mysqldockerå®¹å™¨çš„/etc/mysql/conf.dæ–‡ä»¶å¤¹é‡Œé¢æ”¹mysqlçš„é…ç½®æ–‡ä»¶å°±åªéœ€è¦æŠŠmysqlé…ç½®æ–‡ä»¶æ”¾åœ¨è‡ªå®šä¹‰çš„æ–‡ä»¶å¤¹ä¸‹ï¼ˆ/conf/mysqlï¼‰docker <span class="hljs-builtin-name">run</span> --name some-mysql -e <span class="hljs-attribute">MYSQL_ROOT_PASSWORD</span>=my-secret-pw -d mysql:tag <span class="hljs-attribute">--character-set-server</span>=utf8mb4 <span class="hljs-attribute">--collation-server</span>=utf8mb4_unicode_ciæŒ‡å®šmysqlçš„ä¸€äº›é…ç½®å‚æ•°</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>æ–°æ‰‹æ•™ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é…ç½®åµŒå…¥å¼Servletå®¹å™¨</title>
    <link href="/2020/08/03/SpringBoot%E9%85%8D%E7%BD%AE%E5%B5%8C%E5%85%A5%E5%BC%8FServlet%E5%AE%B9%E5%99%A8/"/>
    <url>/2020/08/03/SpringBoot%E9%85%8D%E7%BD%AE%E5%B5%8C%E5%85%A5%E5%BC%8FServlet%E5%AE%B9%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="é…ç½®åµŒå…¥å¼Servletå®¹å™¨"><a href="#é…ç½®åµŒå…¥å¼Servletå®¹å™¨" class="headerlink" title="é…ç½®åµŒå…¥å¼Servletå®¹å™¨"></a>é…ç½®åµŒå…¥å¼Servletå®¹å™¨</h1><p>SpringBooté»˜è®¤ä½¿ç”¨Tomcatä½œä¸ºåµŒå…¥å¼çš„Servletå®¹å™¨ï¼›</p><p><img src="/2020/08/03/SpringBoot%E9%85%8D%E7%BD%AE%E5%B5%8C%E5%85%A5%E5%BC%8FServlet%E5%AE%B9%E5%99%A8/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180301142915.png" srcset="/img/loading.gif" alt></p><p>é—®é¢˜ï¼Ÿ</p><h3 id="ä¸€ã€å¦‚ä½•å®šåˆ¶å’Œä¿®æ”¹Servletå®¹å™¨çš„ç›¸å…³é…ç½®"><a href="#ä¸€ã€å¦‚ä½•å®šåˆ¶å’Œä¿®æ”¹Servletå®¹å™¨çš„ç›¸å…³é…ç½®" class="headerlink" title="ä¸€ã€å¦‚ä½•å®šåˆ¶å’Œä¿®æ”¹Servletå®¹å™¨çš„ç›¸å…³é…ç½®"></a>ä¸€ã€å¦‚ä½•å®šåˆ¶å’Œä¿®æ”¹Servletå®¹å™¨çš„ç›¸å…³é…ç½®</h3><p>1ã€ä¿®æ”¹å’Œserveræœ‰å…³çš„é…ç½®ï¼ˆServerPropertiesã€ä¹Ÿæ˜¯EmbeddedServletContainerCustomizerã€‘ï¼‰ï¼›</p><div class="hljs"><pre><code class="hljs properties"><span class="hljs-meta">server.port</span>=<span class="hljs-string">8081</span><span class="hljs-meta">server.context-path</span>=<span class="hljs-string">/crud</span><span class="hljs-meta">server.tomcat.uri-encoding</span>=<span class="hljs-string">UTF-8</span><span class="hljs-attr">//é€šç”¨çš„Servletå®¹å™¨è®¾ç½®</span><span class="hljs-attr">server.xxx</span><span class="hljs-attr">//Tomcatçš„è®¾ç½®</span><span class="hljs-attr">server.tomcat.xxx</span></code></pre></div><p>2ã€ç¼–å†™ä¸€ä¸ª<strong>EmbeddedServletContainerCustomizer</strong>ï¼šåµŒå…¥å¼çš„Servletå®¹å™¨çš„å®šåˆ¶å™¨ï¼›æ¥ä¿®æ”¹Servletå®¹å™¨çš„é…ç½®</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span>  <span class="hljs-comment">//ä¸€å®šè¦å°†è¿™ä¸ªå®šåˆ¶å™¨åŠ å…¥åˆ°å®¹å™¨ä¸­</span><span class="hljs-function"><span class="hljs-keyword">public</span> EmbeddedServletContainerCustomizer <span class="hljs-title">embeddedServletContainerCustomizer</span><span class="hljs-params">()</span></span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> EmbeddedServletContainerCustomizer() &#123;        <span class="hljs-comment">//å®šåˆ¶åµŒå…¥å¼çš„Servletå®¹å™¨ç›¸å…³çš„è§„åˆ™</span>        <span class="hljs-meta">@Override</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">customize</span><span class="hljs-params">(ConfigurableEmbeddedServletContainer container)</span> </span>&#123;            container.setPort(<span class="hljs-number">8083</span>);        &#125;    &#125;;&#125;</code></pre></div><h3 id="äºŒã€æ³¨å†ŒServletä¸‰å¤§ç»„ä»¶ã€Servletã€Filterã€Listenerã€‘"><a href="#äºŒã€æ³¨å†ŒServletä¸‰å¤§ç»„ä»¶ã€Servletã€Filterã€Listenerã€‘" class="headerlink" title="äºŒã€æ³¨å†ŒServletä¸‰å¤§ç»„ä»¶ã€Servletã€Filterã€Listenerã€‘"></a>äºŒã€æ³¨å†ŒServletä¸‰å¤§ç»„ä»¶ã€Servletã€Filterã€Listenerã€‘</h3><p>ç”±äºSpringBooté»˜è®¤æ˜¯ä»¥jaråŒ…çš„æ–¹å¼å¯åŠ¨åµŒå…¥å¼çš„Servletå®¹å™¨æ¥å¯åŠ¨SpringBootçš„webåº”ç”¨ï¼Œæ²¡æœ‰web.xmlæ–‡ä»¶ã€‚</p><p>æ³¨å†Œä¸‰å¤§ç»„ä»¶ç”¨ä»¥ä¸‹æ–¹å¼</p><p>ServletRegistrationBean</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//æ³¨å†Œä¸‰å¤§ç»„ä»¶</span><span class="hljs-meta">@Bean</span><span class="hljs-function"><span class="hljs-keyword">public</span> ServletRegistrationBean <span class="hljs-title">myServlet</span><span class="hljs-params">()</span></span>&#123;    ServletRegistrationBean registrationBean = <span class="hljs-keyword">new</span> ServletRegistrationBean(<span class="hljs-keyword">new</span> MyServlet(),<span class="hljs-string">"/myServlet"</span>);    <span class="hljs-keyword">return</span> registrationBean;&#125;</code></pre></div><p>FilterRegistrationBean</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><span class="hljs-function"><span class="hljs-keyword">public</span> FilterRegistrationBean <span class="hljs-title">myFilter</span><span class="hljs-params">()</span></span>&#123;    FilterRegistrationBean registrationBean = <span class="hljs-keyword">new</span> FilterRegistrationBean();    registrationBean.setFilter(<span class="hljs-keyword">new</span> MyFilter());    registrationBean.setUrlPatterns(Arrays.asList(<span class="hljs-string">"/hello"</span>,<span class="hljs-string">"/myServlet"</span>));    <span class="hljs-keyword">return</span> registrationBean;&#125;</code></pre></div><p>ServletListenerRegistrationBean</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><span class="hljs-function"><span class="hljs-keyword">public</span> ServletListenerRegistrationBean <span class="hljs-title">myListener</span><span class="hljs-params">()</span></span>&#123;    ServletListenerRegistrationBean&lt;MyListener&gt; registrationBean = <span class="hljs-keyword">new</span> ServletListenerRegistrationBean&lt;&gt;(<span class="hljs-keyword">new</span> MyListener());    <span class="hljs-keyword">return</span> registrationBean;&#125;</code></pre></div><p>SpringBootå¸®æˆ‘ä»¬è‡ªåŠ¨SpringMVCçš„æ—¶å€™ï¼Œè‡ªåŠ¨çš„æ³¨å†ŒSpringMVCçš„å‰ç«¯æ§åˆ¶å™¨ï¼›DIspatcherServletï¼›</p><p>DispatcherServletAutoConfigurationä¸­ï¼š</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span>(name = DEFAULT_DISPATCHER_SERVLET_REGISTRATION_BEAN_NAME)<span class="hljs-meta">@ConditionalOnBean</span>(value = DispatcherServlet<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">name</span> </span>= DEFAULT_DISPATCHER_SERVLET_BEAN_NAME)<span class="hljs-function"><span class="hljs-keyword">public</span> ServletRegistrationBean <span class="hljs-title">dispatcherServletRegistration</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">      DispatcherServlet dispatcherServlet)</span> </span>&#123;   ServletRegistrationBean registration = <span class="hljs-keyword">new</span> ServletRegistrationBean(         dispatcherServlet, <span class="hljs-keyword">this</span>.serverProperties.getServletMapping());    <span class="hljs-comment">//é»˜è®¤æ‹¦æˆªï¼š /  æ‰€æœ‰è¯·æ±‚ï¼›åŒ…é™æ€èµ„æºï¼Œä½†æ˜¯ä¸æ‹¦æˆªjspè¯·æ±‚ï¼›   /*ä¼šæ‹¦æˆªjsp</span>    <span class="hljs-comment">//å¯ä»¥é€šè¿‡server.servletPathæ¥ä¿®æ”¹SpringMVCå‰ç«¯æ§åˆ¶å™¨é»˜è®¤æ‹¦æˆªçš„è¯·æ±‚è·¯å¾„</span>       registration.setName(DEFAULT_DISPATCHER_SERVLET_BEAN_NAME);   registration.setLoadOnStartup(         <span class="hljs-keyword">this</span>.webMvcProperties.getServlet().getLoadOnStartup());   <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.multipartConfig != <span class="hljs-keyword">null</span>) &#123;      registration.setMultipartConfig(<span class="hljs-keyword">this</span>.multipartConfig);   &#125;   <span class="hljs-keyword">return</span> registration;&#125;</code></pre></div><p>2ï¼‰ã€SpringBootèƒ½ä¸èƒ½æ”¯æŒå…¶ä»–çš„Servletå®¹å™¨ï¼›</p><h3 id="ä¸‰ã€æ›¿æ¢ä¸ºå…¶ä»–åµŒå…¥å¼Servletå®¹å™¨"><a href="#ä¸‰ã€æ›¿æ¢ä¸ºå…¶ä»–åµŒå…¥å¼Servletå®¹å™¨" class="headerlink" title="ä¸‰ã€æ›¿æ¢ä¸ºå…¶ä»–åµŒå…¥å¼Servletå®¹å™¨"></a>ä¸‰ã€æ›¿æ¢ä¸ºå…¶ä»–åµŒå…¥å¼Servletå®¹å™¨</h3><p><img src="/2020/08/03/SpringBoot%E9%85%8D%E7%BD%AE%E5%B5%8C%E5%85%A5%E5%BC%8FServlet%E5%AE%B9%E5%99%A8/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180302114401.png" srcset="/img/loading.gif" alt></p><p>é»˜è®¤æ”¯æŒï¼š</p><p>Tomcatï¼ˆé»˜è®¤ä½¿ç”¨ï¼‰</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>   å¼•å…¥webæ¨¡å—é»˜è®¤å°±æ˜¯ä½¿ç”¨åµŒå…¥å¼çš„Tomcatä½œä¸ºServletå®¹å™¨ï¼›<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre></div><p>Jetty</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å¼•å…¥webæ¨¡å— --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span>   <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-comment">&lt;!--å¼•å…¥å…¶ä»–çš„Servletå®¹å™¨--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre></div><p>Undertow</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å¼•å…¥webæ¨¡å— --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span>   <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-comment">&lt;!--å¼•å…¥å…¶ä»–çš„Servletå®¹å™¨--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-undertow<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre></div><h3 id="å››ã€åµŒå…¥å¼Servletå®¹å™¨è‡ªåŠ¨é…ç½®åŸç†ï¼›"><a href="#å››ã€åµŒå…¥å¼Servletå®¹å™¨è‡ªåŠ¨é…ç½®åŸç†ï¼›" class="headerlink" title="å››ã€åµŒå…¥å¼Servletå®¹å™¨è‡ªåŠ¨é…ç½®åŸç†ï¼›"></a>å››ã€åµŒå…¥å¼Servletå®¹å™¨è‡ªåŠ¨é…ç½®åŸç†ï¼›</h3><p>EmbeddedServletContainerAutoConfigurationï¼šåµŒå…¥å¼çš„Servletå®¹å™¨è‡ªåŠ¨é…ç½®ï¼Ÿ</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@AutoConfigureOrder</span>(Ordered.HIGHEST_PRECEDENCE)<span class="hljs-meta">@Configuration</span><span class="hljs-meta">@ConditionalOnWebApplication</span><span class="hljs-meta">@Import</span>(BeanPostProcessorsRegistrar<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span><span class="hljs-class">//å¯¼å…¥<span class="hljs-title">BeanPostProcessorsRegistrar</span>ï¼š<span class="hljs-title">Spring</span>æ³¨è§£ç‰ˆï¼›ç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€äº›ç»„ä»¶</span><span class="hljs-class">//å¯¼å…¥äº†<span class="hljs-title">EmbeddedServletContainerCustomizerBeanPostProcessor</span>ï¼š</span><span class="hljs-class">//åç½®å¤„ç†å™¨ï¼š<span class="hljs-title">bean</span>åˆå§‹åŒ–å‰åï¼ˆåˆ›å»ºå®Œå¯¹è±¡ï¼Œè¿˜æ²¡èµ‹å€¼èµ‹å€¼ï¼‰æ‰§è¡Œåˆå§‹åŒ–å·¥ä½œ</span><span class="hljs-class"><span class="hljs-title">public</span> <span class="hljs-title">class</span> <span class="hljs-title">EmbeddedServletContainerAutoConfiguration</span> </span>&#123;        <span class="hljs-meta">@Configuration</span><span class="hljs-meta">@ConditionalOnClass</span>(&#123; Servlet<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">Tomcat</span>.<span class="hljs-title">class</span> &#125;)//åˆ¤æ–­å½“å‰æ˜¯å¦å¼•å…¥äº†<span class="hljs-title">Tomcat</span>ä¾èµ–ï¼›</span><span class="hljs-class">@<span class="hljs-title">ConditionalOnMissingBean</span>(<span class="hljs-title">value</span> </span>= EmbeddedServletContainerFactory<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">search</span> </span>= SearchStrategy.CURRENT)<span class="hljs-comment">//åˆ¤æ–­å½“å‰å®¹å™¨æ²¡æœ‰ç”¨æˆ·è‡ªå·±å®šä¹‰EmbeddedServletContainerFactoryï¼šåµŒå…¥å¼çš„Servletå®¹å™¨å·¥å‚ï¼›ä½œç”¨ï¼šåˆ›å»ºåµŒå…¥å¼çš„Servletå®¹å™¨</span><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmbeddedTomcat</span> </span>&#123;<span class="hljs-meta">@Bean</span><span class="hljs-function"><span class="hljs-keyword">public</span> TomcatEmbeddedServletContainerFactory <span class="hljs-title">tomcatEmbeddedServletContainerFactory</span><span class="hljs-params">()</span> </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TomcatEmbeddedServletContainerFactory();&#125;&#125;        <span class="hljs-comment">/**</span><span class="hljs-comment"> * Nested configuration if Jetty is being used.</span><span class="hljs-comment"> */</span><span class="hljs-meta">@Configuration</span><span class="hljs-meta">@ConditionalOnClass</span>(&#123; Servlet<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">Server</span>.<span class="hljs-title">class</span>, <span class="hljs-title">Loader</span>.<span class="hljs-title">class</span>,</span><span class="hljs-class"><span class="hljs-title">WebAppContext</span>.<span class="hljs-title">class</span> &#125;)</span><span class="hljs-class">@<span class="hljs-title">ConditionalOnMissingBean</span>(<span class="hljs-title">value</span> </span>= EmbeddedServletContainerFactory<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">search</span> </span>= SearchStrategy.CURRENT)<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmbeddedJetty</span> </span>&#123;<span class="hljs-meta">@Bean</span><span class="hljs-function"><span class="hljs-keyword">public</span> JettyEmbeddedServletContainerFactory <span class="hljs-title">jettyEmbeddedServletContainerFactory</span><span class="hljs-params">()</span> </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JettyEmbeddedServletContainerFactory();&#125;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * Nested configuration if Undertow is being used.</span><span class="hljs-comment"> */</span><span class="hljs-meta">@Configuration</span><span class="hljs-meta">@ConditionalOnClass</span>(&#123; Servlet<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">Undertow</span>.<span class="hljs-title">class</span>, <span class="hljs-title">SslClientAuthMode</span>.<span class="hljs-title">class</span> &#125;)</span><span class="hljs-class">@<span class="hljs-title">ConditionalOnMissingBean</span>(<span class="hljs-title">value</span> </span>= EmbeddedServletContainerFactory<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">search</span> </span>= SearchStrategy.CURRENT)<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmbeddedUndertow</span> </span>&#123;<span class="hljs-meta">@Bean</span><span class="hljs-function"><span class="hljs-keyword">public</span> UndertowEmbeddedServletContainerFactory <span class="hljs-title">undertowEmbeddedServletContainerFactory</span><span class="hljs-params">()</span> </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UndertowEmbeddedServletContainerFactory();&#125;&#125;</code></pre></div><p>1ï¼‰ã€EmbeddedServletContainerFactoryï¼ˆåµŒå…¥å¼Servletå®¹å™¨å·¥å‚ï¼‰</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">EmbeddedServletContainerFactory</span> </span>&#123;   <span class="hljs-comment">//è·å–åµŒå…¥å¼çš„Servletå®¹å™¨</span>   <span class="hljs-function">EmbeddedServletContainer <span class="hljs-title">getEmbeddedServletContainer</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">         ServletContextInitializer... initializers)</span></span>;&#125;</code></pre></div><p><img src="/2020/08/03/SpringBoot%E9%85%8D%E7%BD%AE%E5%B5%8C%E5%85%A5%E5%BC%8FServlet%E5%AE%B9%E5%99%A8/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180302144910.png" srcset="/img/loading.gif" alt></p><p><img src="/2020/08/03/SpringBoot%E9%85%8D%E7%BD%AE%E5%B5%8C%E5%85%A5%E5%BC%8FServlet%E5%AE%B9%E5%99%A8/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180302221835.png" srcset="/img/loading.gif" alt></p><p>3ï¼‰ã€ä»¥<strong>TomcatEmbeddedServletContainerFactory</strong>ä¸ºä¾‹</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><span class="hljs-function"><span class="hljs-keyword">public</span> EmbeddedServletContainer <span class="hljs-title">getEmbeddedServletContainer</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">      ServletContextInitializer... initializers)</span> </span>&#123;    <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªTomcat</span>   Tomcat tomcat = <span class="hljs-keyword">new</span> Tomcat();        <span class="hljs-comment">//é…ç½®Tomcatçš„åŸºæœ¬ç¯èŠ‚</span>   File baseDir = (<span class="hljs-keyword">this</span>.baseDirectory != <span class="hljs-keyword">null</span> ? <span class="hljs-keyword">this</span>.baseDirectory         : createTempDir(<span class="hljs-string">"tomcat"</span>));   tomcat.setBaseDir(baseDir.getAbsolutePath());   Connector connector = <span class="hljs-keyword">new</span> Connector(<span class="hljs-keyword">this</span>.protocol);   tomcat.getService().addConnector(connector);   customizeConnector(connector);   tomcat.setConnector(connector);   tomcat.getHost().setAutoDeploy(<span class="hljs-keyword">false</span>);   configureEngine(tomcat.getEngine());   <span class="hljs-keyword">for</span> (Connector additionalConnector : <span class="hljs-keyword">this</span>.additionalTomcatConnectors) &#123;      tomcat.getService().addConnector(additionalConnector);   &#125;   prepareContext(tomcat.getHost(), initializers);        <span class="hljs-comment">//å°†é…ç½®å¥½çš„Tomcatä¼ å…¥è¿›å»ï¼Œè¿”å›ä¸€ä¸ªEmbeddedServletContainerï¼›å¹¶ä¸”å¯åŠ¨TomcatæœåŠ¡å™¨</span>   <span class="hljs-keyword">return</span> getTomcatEmbeddedServletContainer(tomcat);&#125;</code></pre></div><p>4ï¼‰ã€æˆ‘ä»¬å¯¹åµŒå…¥å¼å®¹å™¨çš„é…ç½®ä¿®æ”¹æ˜¯æ€ä¹ˆç”Ÿæ•ˆï¼Ÿ</p><div class="hljs"><pre><code class="hljs plain">ServerPropertiesã€EmbeddedServletContainerCustomizer</code></pre></div><p><strong>EmbeddedServletContainerCustomizer</strong>ï¼šå®šåˆ¶å™¨å¸®æˆ‘ä»¬ä¿®æ”¹äº†Servletå®¹å™¨çš„é…ç½®ï¼Ÿ</p><p>æ€ä¹ˆä¿®æ”¹çš„åŸç†ï¼Ÿ</p><p>5ï¼‰ã€å®¹å™¨ä¸­å¯¼å…¥äº†<strong>EmbeddedServletContainerCustomizerBeanPostProcessor</strong></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//åˆå§‹åŒ–ä¹‹å‰</span><span class="hljs-meta">@Override</span><span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">postProcessBeforeInitialization</span><span class="hljs-params">(Object bean, String beanName)</span></span><span class="hljs-function">      <span class="hljs-keyword">throws</span> BeansException </span>&#123;    <span class="hljs-comment">//å¦‚æœå½“å‰åˆå§‹åŒ–çš„æ˜¯ä¸€ä¸ªConfigurableEmbeddedServletContainerç±»å‹çš„ç»„ä»¶</span>   <span class="hljs-keyword">if</span> (bean <span class="hljs-keyword">instanceof</span> ConfigurableEmbeddedServletContainer) &#123;       <span class="hljs-comment">//</span>      postProcessBeforeInitialization((ConfigurableEmbeddedServletContainer) bean);   &#125;   <span class="hljs-keyword">return</span> bean;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postProcessBeforeInitialization</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">ConfigurableEmbeddedServletContainer bean)</span> </span>&#123;    <span class="hljs-comment">//è·å–æ‰€æœ‰çš„å®šåˆ¶å™¨ï¼Œè°ƒç”¨æ¯ä¸€ä¸ªå®šåˆ¶å™¨çš„customizeæ–¹æ³•æ¥ç»™Servletå®¹å™¨è¿›è¡Œå±æ€§èµ‹å€¼ï¼›</span>    <span class="hljs-keyword">for</span> (EmbeddedServletContainerCustomizer customizer : getCustomizers()) &#123;        customizer.customize(bean);    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> Collection&lt;EmbeddedServletContainerCustomizer&gt; <span class="hljs-title">getCustomizers</span><span class="hljs-params">()</span> </span>&#123;    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.customizers == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-comment">// Look up does not include the parent context</span>        <span class="hljs-keyword">this</span>.customizers = <span class="hljs-keyword">new</span> ArrayList&lt;EmbeddedServletContainerCustomizer&gt;(            <span class="hljs-keyword">this</span>.beanFactory            <span class="hljs-comment">//ä»å®¹å™¨ä¸­è·å–æ‰€æœ‰è¿™è‘›ç±»å‹çš„ç»„ä»¶ï¼šEmbeddedServletContainerCustomizer</span>            <span class="hljs-comment">//å®šåˆ¶Servletå®¹å™¨ï¼Œç»™å®¹å™¨ä¸­å¯ä»¥æ·»åŠ ä¸€ä¸ªEmbeddedServletContainerCustomizerç±»å‹çš„ç»„ä»¶</span>            .getBeansOfType(EmbeddedServletContainerCustomizer<span class="hljs-class">.<span class="hljs-keyword">class</span>,</span><span class="hljs-class">                            <span class="hljs-title">false</span>, <span class="hljs-title">false</span>)</span><span class="hljs-class">            .<span class="hljs-title">values</span>())</span>;        Collections.sort(<span class="hljs-keyword">this</span>.customizers, AnnotationAwareOrderComparator.INSTANCE);        <span class="hljs-keyword">this</span>.customizers = Collections.unmodifiableList(<span class="hljs-keyword">this</span>.customizers);    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.customizers;&#125;ServerPropertiesä¹Ÿæ˜¯å®šåˆ¶å™¨</code></pre></div><p>æ­¥éª¤ï¼š</p><p>1ï¼‰ã€SpringBootæ ¹æ®å¯¼å…¥çš„ä¾èµ–æƒ…å†µï¼Œç»™å®¹å™¨ä¸­æ·»åŠ ç›¸åº”çš„EmbeddedServletContainerFactoryã€TomcatEmbeddedServletContainerFactoryã€‘</p><p>2ï¼‰ã€å®¹å™¨ä¸­æŸä¸ªç»„ä»¶è¦åˆ›å»ºå¯¹è±¡å°±ä¼šæƒŠåŠ¨åç½®å¤„ç†å™¨ï¼›EmbeddedServletContainerCustomizerBeanPostProcessorï¼›</p><p>åªè¦æ˜¯åµŒå…¥å¼çš„Servletå®¹å™¨å·¥å‚ï¼Œåç½®å¤„ç†å™¨å°±å·¥ä½œï¼›</p><p>3ï¼‰ã€åç½®å¤„ç†å™¨ï¼Œä»å®¹å™¨ä¸­è·å–æ‰€æœ‰çš„<strong>EmbeddedServletContainerCustomizer</strong>ï¼Œè°ƒç”¨å®šåˆ¶å™¨çš„å®šåˆ¶æ–¹æ³•</p><h3 id="äº”ã€åµŒå…¥å¼Servletå®¹å™¨å¯åŠ¨åŸç†ï¼›"><a href="#äº”ã€åµŒå…¥å¼Servletå®¹å™¨å¯åŠ¨åŸç†ï¼›" class="headerlink" title="äº”ã€åµŒå…¥å¼Servletå®¹å™¨å¯åŠ¨åŸç†ï¼›"></a>äº”ã€åµŒå…¥å¼Servletå®¹å™¨å¯åŠ¨åŸç†ï¼›</h3><p>ä»€ä¹ˆæ—¶å€™åˆ›å»ºåµŒå…¥å¼çš„Servletå®¹å™¨å·¥å‚ï¼Ÿä»€ä¹ˆæ—¶å€™è·å–åµŒå…¥å¼çš„Servletå®¹å™¨å¹¶å¯åŠ¨Tomcatï¼›</p><p>è·å–åµŒå…¥å¼çš„Servletå®¹å™¨å·¥å‚ï¼š</p><p>1ï¼‰ã€SpringBootåº”ç”¨å¯åŠ¨è¿è¡Œrunæ–¹æ³•</p><p>2ï¼‰ã€refreshContext(context);SpringBootåˆ·æ–°IOCå®¹å™¨ã€åˆ›å»ºIOCå®¹å™¨å¯¹è±¡ï¼Œå¹¶åˆå§‹åŒ–å®¹å™¨ï¼Œåˆ›å»ºå®¹å™¨ä¸­çš„æ¯ä¸€ä¸ªç»„ä»¶ã€‘ï¼›å¦‚æœæ˜¯webåº”ç”¨åˆ›å»º<strong>AnnotationConfigEmbeddedWebApplicationContext</strong>ï¼Œå¦åˆ™ï¼š<strong>AnnotationConfigApplicationContext</strong></p><p>3ï¼‰ã€refresh(context);<strong>åˆ·æ–°åˆšæ‰åˆ›å»ºå¥½çš„iocå®¹å™¨ï¼›</strong></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">refresh</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> BeansException, IllegalStateException </span>&#123;   <span class="hljs-keyword">synchronized</span> (<span class="hljs-keyword">this</span>.startupShutdownMonitor) &#123;      <span class="hljs-comment">// Prepare this context for refreshing.</span>      prepareRefresh();      <span class="hljs-comment">// Tell the subclass to refresh the internal bean factory.</span>      ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();      <span class="hljs-comment">// Prepare the bean factory for use in this context.</span>      prepareBeanFactory(beanFactory);      <span class="hljs-keyword">try</span> &#123;         <span class="hljs-comment">// Allows post-processing of the bean factory in context subclasses.</span>         postProcessBeanFactory(beanFactory);         <span class="hljs-comment">// Invoke factory processors registered as beans in the context.</span>         invokeBeanFactoryPostProcessors(beanFactory);         <span class="hljs-comment">// Register bean processors that intercept bean creation.</span>         registerBeanPostProcessors(beanFactory);         <span class="hljs-comment">// Initialize message source for this context.</span>         initMessageSource();         <span class="hljs-comment">// Initialize event multicaster for this context.</span>         initApplicationEventMulticaster();         <span class="hljs-comment">// Initialize other special beans in specific context subclasses.</span>         onRefresh();         <span class="hljs-comment">// Check for listener beans and register them.</span>         registerListeners();         <span class="hljs-comment">// Instantiate all remaining (non-lazy-init) singletons.</span>         finishBeanFactoryInitialization(beanFactory);         <span class="hljs-comment">// Last step: publish corresponding event.</span>         finishRefresh();      &#125;      <span class="hljs-keyword">catch</span> (BeansException ex) &#123;         <span class="hljs-keyword">if</span> (logger.isWarnEnabled()) &#123;            logger.warn(<span class="hljs-string">"Exception encountered during context initialization - "</span> +                  <span class="hljs-string">"cancelling refresh attempt: "</span> + ex);         &#125;         <span class="hljs-comment">// Destroy already created singletons to avoid dangling resources.</span>         destroyBeans();         <span class="hljs-comment">// Reset 'active' flag.</span>         cancelRefresh(ex);         <span class="hljs-comment">// Propagate exception to caller.</span>         <span class="hljs-keyword">throw</span> ex;      &#125;      <span class="hljs-keyword">finally</span> &#123;         <span class="hljs-comment">// Reset common introspection caches in Spring's core, since we</span>         <span class="hljs-comment">// might not ever need metadata for singleton beans anymore...</span>         resetCommonCaches();      &#125;   &#125;&#125;</code></pre></div><p>4ï¼‰ã€  onRefresh(); webçš„iocå®¹å™¨é‡å†™äº†onRefreshæ–¹æ³•</p><p>5ï¼‰ã€webiocå®¹å™¨ä¼šåˆ›å»ºåµŒå…¥å¼çš„Servletå®¹å™¨ï¼›<strong>createEmbeddedServletContainer</strong>();</p><p><strong>6ï¼‰ã€è·å–åµŒå…¥å¼çš„Servletå®¹å™¨å·¥å‚ï¼š</strong></p><p>EmbeddedServletContainerFactory containerFactory = getEmbeddedServletContainerFactory();</p><p>â€‹    ä»iocå®¹å™¨ä¸­è·å–EmbeddedServletContainerFactory ç»„ä»¶ï¼›<strong>TomcatEmbeddedServletContainerFactory</strong>åˆ›å»ºå¯¹è±¡ï¼Œåç½®å¤„ç†å™¨ä¸€çœ‹æ˜¯è¿™ä¸ªå¯¹è±¡ï¼Œå°±è·å–æ‰€æœ‰çš„å®šåˆ¶å™¨æ¥å…ˆå®šåˆ¶Servletå®¹å™¨çš„ç›¸å…³é…ç½®ï¼›</p><p>7ï¼‰ã€<strong>ä½¿ç”¨å®¹å™¨å·¥å‚è·å–åµŒå…¥å¼çš„Servletå®¹å™¨</strong>ï¼šthis.embeddedServletContainer = containerFactory      .getEmbeddedServletContainer(getSelfInitializer());</p><p>8ï¼‰ã€åµŒå…¥å¼çš„Servletå®¹å™¨åˆ›å»ºå¯¹è±¡å¹¶å¯åŠ¨Servletå®¹å™¨ï¼›</p><p><strong>å…ˆå¯åŠ¨åµŒå…¥å¼çš„Servletå®¹å™¨ï¼Œå†å°†iocå®¹å™¨ä¸­å‰©ä¸‹æ²¡æœ‰åˆ›å»ºå‡ºçš„å¯¹è±¡è·å–å‡ºæ¥ï¼›</strong></p><p><strong>==IOCå®¹å™¨å¯åŠ¨åˆ›å»ºåµŒå…¥å¼çš„Servletå®¹å™¨==</strong></p>]]></content>
    
    
    <categories>
      
      <category>æºç åˆ†æ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
      <tag>Servlet</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Setæ¥å£åº•å±‚å®ç°ç±»</title>
    <link href="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/"/>
    <url>/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<h1 id="Setæ¥å£åº•å±‚å®ç°ç±»"><a href="#Setæ¥å£åº•å±‚å®ç°ç±»" class="headerlink" title="Setæ¥å£åº•å±‚å®ç°ç±»"></a>Setæ¥å£åº•å±‚å®ç°ç±»</h1><h1 id="ä¸€ã€Setæ¥å£ç»§æ‰¿å…³ç³»"><a href="#ä¸€ã€Setæ¥å£ç»§æ‰¿å…³ç³»" class="headerlink" title="ä¸€ã€Setæ¥å£ç»§æ‰¿å…³ç³»"></a>ä¸€ã€Setæ¥å£ç»§æ‰¿å…³ç³»</h1><p>å­˜å‚¨çš„æ•°æ®ç‰¹ç‚¹ï¼šæ— åºçš„ã€ä¸å¯é‡å¤çš„å…ƒç´ </p><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1595656190066.png" srcset="/img/loading.gif" alt></p><p>|â€”-Setæ¥å£ï¼šå­˜å‚¨æ— åºçš„ã€ä¸å¯é‡å¤çš„æ•°æ®   â€“&gt;é«˜ä¸­è®²çš„â€œé›†åˆâ€</p><ul><li>|â€”-HashSetï¼šä½œä¸ºSetæ¥å£çš„ä¸»è¦å®ç°ç±»ï¼›çº¿ç¨‹ä¸å®‰å…¨çš„ï¼›å¯ä»¥å­˜å‚¨nullå€¼</li><li>|â€”-LinkedHashSetï¼šä½œä¸ºHashSetçš„å­ç±»ï¼›éå†å…¶å†…éƒ¨æ•°æ®æ—¶ï¼Œå¯ä»¥æŒ‰ç…§æ·»åŠ çš„é¡ºåºéå†åœ¨æ·»åŠ æ•°æ®çš„åŒæ—¶ï¼Œæ¯ä¸ªæ•°æ®è¿˜ç»´æŠ¤äº†ä¸¤ä¸ªå¼•ç”¨ï¼Œè®°å½•æ­¤æ•°æ®å‰ä¸€ä¸ªæ•°æ®å’Œåä¸€ä¸ªæ•°æ®ã€‚                   å¯¹äºé¢‘ç¹çš„éå†æ“ä½œï¼ŒLinkedHashSetæ•ˆç‡é«˜äºHashSet.</li><li>|â€”-TreeSetï¼šå¯ä»¥ç…§æ·»åŠ å¯¹è±¡çš„æŒ‡å®šå±æ€§ï¼Œè¿›è¡Œæ’åºã€‚</li></ul><h1 id="äºŒã€HashSet"><a href="#äºŒã€HashSet" class="headerlink" title="äºŒã€HashSet"></a>äºŒã€HashSet</h1><h2 id="1-ç»§æ‰¿æƒ…å†µ"><a href="#1-ç»§æ‰¿æƒ…å†µ" class="headerlink" title="1.ç»§æ‰¿æƒ…å†µ"></a>1.ç»§æ‰¿æƒ…å†µ</h2><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1595656458260.png" srcset="/img/loading.gif" alt></p><p>å¯ä»¥çœ‹åˆ°æ˜¯ç›´æ¥å®ç°äº†Setæ¥å£ï¼Œå’Œé—´æ¥ç»§æ‰¿äº†Collectionæ¥å£</p><h2 id="2-åˆ›å»ºHashSet"><a href="#2-åˆ›å»ºHashSet" class="headerlink" title="2.åˆ›å»ºHashSet"></a>2.åˆ›å»ºHashSet</h2><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/abcsd.png" srcset="/img/loading.gif" alt></p><p>debugè·Ÿè¿›æºä»£ç </p><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1.png" srcset="/img/loading.gif" alt></p><p>å¯ä»¥çœ‹åˆ°ç©ºå‚æ„é€ å™¨é‡Œnewäº†ä¸€ä¸ªHashMapå‡ºæ¥</p><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/2.png" srcset="/img/loading.gif" alt="59565709297"></p><p>è€ŒHashMapåˆå§‹åŒ–äº†ä¸€ä¸ªåŠ è½½å› å­çš„å¸¸é‡ï¼Œè¿™é‡Œç”±äºæ˜¯mapå†…å®¹ä¸å¤šåšç»†è®²</p><p> å®é™…ä¸ŠHashSetå®ç°Setæ¥å£ï¼Œç”±å“ˆå¸Œè¡¨ï¼ˆå®é™…ä¸Šæ˜¯ä¸€ä¸ªHashMapå®ä¾‹ï¼‰æ”¯æŒã€‚å®ƒä¸ä¿è¯set çš„è¿­ä»£é¡ºåºï¼›ç‰¹åˆ«æ˜¯å®ƒä¸ä¿è¯è¯¥é¡ºåºæ’ä¹…ä¸å˜ï¼Œæ­¤ç±»å…è®¸ä½¿ç”¨nullå…ƒç´ ã€‚ </p><p>åœ¨HashSetä¸­ï¼Œå…ƒç´ éƒ½å­˜åˆ°HashMapé”®å€¼å¯¹çš„Keyä¸Šé¢ï¼Œè€ŒValueæ—¶æœ‰ä¸€ä¸ªç»Ÿä¸€çš„å€¼<code>private static final Object PRESENT = new Object();</code>ï¼Œ(å®šä¹‰ä¸€ä¸ªè™šæ‹Ÿçš„Objectå¯¹è±¡ä½œä¸ºHashMapçš„valueï¼Œå°†æ­¤å¯¹è±¡å®šä¹‰ä¸ºstatic finalã€‚) åœ¨æ·»åŠ æ•°æ®æ—¶å°±èƒ½è§‚å¯Ÿåˆ°ã€‚</p><h2 id="3-æ·»åŠ æ•°æ®"><a href="#3-æ·»åŠ æ•°æ®" class="headerlink" title="3.æ·»åŠ æ•°æ®"></a>3.æ·»åŠ æ•°æ®</h2><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/3.png" srcset="/img/loading.gif" alt></p><p>è·Ÿè¿› é¦–å…ˆæ˜¯ä¸€ä¸ªè‡ªåŠ¨è£…ç®±</p><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/4.png" srcset="/img/loading.gif" alt></p><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/5.png" srcset="/img/loading.gif" alt></p><div class="hljs"><pre><code class="hljs java">è€ŒPRESENTå°±æ˜¯åˆšæ‰æåŠåˆ°çš„å›ºå®šçš„valueå€¼ å®ç°äº†åŒåˆ—å˜å•åˆ—<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Object PRESENT = <span class="hljs-keyword">new</span> Object();</code></pre></div><p>æ¥ä¸‹æ¥çš„putå°±æ˜¯mapçš„æ“ä½œäº†</p><h2 id="4-ä¸å¯é‡å¤æ€§å’Œæ— åºæ€§"><a href="#4-ä¸å¯é‡å¤æ€§å’Œæ— åºæ€§" class="headerlink" title="4.ä¸å¯é‡å¤æ€§å’Œæ— åºæ€§"></a>4.ä¸å¯é‡å¤æ€§å’Œæ— åºæ€§</h2><p>HashSetçš„ä¿©å¤§ç‰¹ç‚¹</p><div class="hljs"><pre><code>1. æ— åºæ€§ï¼šä¸ç­‰äºéšæœºæ€§ã€‚å­˜å‚¨çš„æ•°æ®åœ¨åº•å±‚æ•°ç»„ä¸­å¹¶éç…§æ•°ç»„ç´¢å¼•çš„é¡ºåºæ·»åŠ ï¼Œè€Œæ˜¯æ ¹æ®æ•°æ®çš„å“ˆå¸Œå€¼å†³å®šçš„ã€‚    2. ä¸å¯é‡å¤æ€§ï¼šä¿è¯æ·»åŠ çš„å…ƒç´ ç…§equals()åˆ¤æ–­æ—¶ï¼Œä¸èƒ½è¿”å›true.å³ï¼šç›¸åŒçš„å…ƒç´ åªèƒ½æ·»åŠ ä¸€ä¸ªã€‚</code></pre></div><p>åœ¨è¿›è¡Œæµ‹è¯•è¿‡ç¨‹ä¸­ æˆ‘å‘ç°é¿å…ä¸äº†å»åˆ°mapçš„æºç ï¼Œç”±äºå¤ªè¿‡å¤æ‚ å°½é‡ç”¨å¤§ç™½è¯è¯´æ˜ç™½ï¼Œmapä¼šå•ç‹¬å‡ºä¸€ç¯‡</p><p>åœ¨jdk7å’Œä¹‹å‰ åº•å±‚ä½¿ç”¨çš„æ˜¯æ•°ç»„åŠ é“¾è¡¨ï¼Œåœ¨jdk8åä½¿ç”¨çš„æ˜¯æ•°ç»„åŠ é“¾è¡¨åŠ çº¢é»‘æ ‘ã€‚</p><p>å› ä¸ºæˆ‘ä»¬çŸ¥é“mapçš„keyæ˜¯ä¸å…è®¸çš„é‡å¤çš„ï¼Œå¦‚æœæœ‰é‡å¤çš„keyå€¼å°±ä¼šæŠŠmapçš„keyå’Œvalueè¿›è¡Œæ›´æ–°æ“ä½œï¼Œè¿™ä¸€æ¥å°±è¯´çš„é€šäº†ï¼ŒHashSetå°±æ˜¯é™åˆ¶äº†mapçš„åŠŸèƒ½ï¼Œè®©mapçš„valueå€¼å›ºå®šä¸ºå¸¸é‡ï¼Œåªä½¿ç”¨keyå»æ“ä½œï¼Œæ‰€ä»¥è¯´HashSetä¸å…è®¸æœ‰é‡å¤çš„å€¼ï¼Œå…¶å®ä¹Ÿæ˜¯è¿™ä¸ªæ–°çš„å€¼æŠŠåŸæ¥çš„å€¼ç»™æ›¿æ¢æ‰äº†</p><p><strong>è€Œæ— åºæ€§ï¼Œè¦é‡å­˜æ”¾çš„æ–¹å¼è¯´èµ·ã€‚ï¼ˆæ³¨æ„ï¼Œå­˜è¿›HashSetçš„å¯¹è±¡ä¸€å®šè¦é‡å†™HashCodeå’Œequalsæ–¹æ³•ï¼‰</strong></p><p>æˆ‘ä»¬å‘HashSetä¸­æ·»åŠ å…ƒç´ a,é¦–å…ˆè°ƒç”¨å…ƒç´ aæ‰€åœ¨ç±»çš„hashCode()æ–¹æ³•ï¼Œè®¡ç®—å…ƒç´ açš„å“ˆå¸Œå€¼ï¼Œ<br>        æ­¤å“ˆå¸Œå€¼æ¥ç€é€šè¿‡æŸç§ç®—æ³•è®¡ç®—å‡ºåœ¨HashSetåº•å±‚æ•°ç»„ä¸­çš„å­˜æ”¾ä½ç½®ï¼ˆå³ä¸ºï¼šç´¢å¼•ä½ç½®ï¼Œåˆ¤æ–­<br>        æ•°ç»„æ­¤ä½ç½®ä¸Šæ˜¯å¦å·²ç»å…ƒç´ ï¼‰ï¼š</p><p>  æ­¤æ—¶æœ‰ä¿©ç§æƒ…å†µï¼š  </p><p>â€‹        1.å¦‚æœæ­¤ä½ç½®ä¸Šæ²¡å…¶ä»–å…ƒç´ ï¼Œåˆ™å…ƒç´ aæ·»åŠ æˆåŠŸã€‚ â€”&gt;æ’å…¥æˆåŠŸæƒ…å†µ1<br>               2.å¦‚æœæ­¤ä½ç½®ä¸Šå…¶ä»–å…ƒç´ b(æˆ–ä»¥é“¾è¡¨å½¢å¼å­˜åœ¨çš„å¤šä¸ªå…ƒç´ ï¼Œåˆ™æ¯”è¾ƒå…ƒç´ aä¸å…ƒç´ bçš„hashå€¼ï¼š</p><p>æ­¤æ—¶åˆæœ‰ä¿©ç§æƒ…å†µï¼š</p><p>â€‹                1.å¦‚æœhashå€¼ä¸ç›¸åŒï¼Œåˆ™å…ƒç´ aæ·»åŠ æˆåŠŸã€‚â€”&gt;æˆåŠŸæƒ…å†µ2<br>                2.å¦‚æœhashå€¼ç›¸åŒï¼Œè¿›è€Œéœ€è¦è°ƒç”¨å…ƒç´ aæ‰€åœ¨ç±»çš„equals()æ–¹æ³•ï¼š</p><p>æ­¤æ—¶è¿˜æ˜¯æœ‰ä¿©ç§æƒ…å†µï¼š</p><p>â€‹               1.equals()è¿”å›true,å…ƒç´ aæ·»åŠ å¤±è´¥<br>               2.equals()è¿”å›false,åˆ™å…ƒç´ aæ·»åŠ æˆåŠŸã€‚â€”&gt;æˆåŠŸæƒ…å†µ3</p><p>â€‹    å¯¹äºæ·»åŠ æˆåŠŸçš„æƒ…å†µ2å’Œæƒ…å†µ3è€Œè¨€ï¼šå…ƒç´ a ä¸å·²ç»å­˜åœ¨æŒ‡å®šç´¢å¼•ä½ç½®ä¸Šæ•°æ®ä»¥é“¾è¡¨çš„æ–¹å¼å­˜å‚¨ã€‚</p><p>â€‹    </p><p>ï¼ˆé“¾è¡¨æŒ‡å‘åŒºåˆ«â†“ï¼‰</p><p>jdk 7 :å…ƒç´ aæ”¾åˆ°æ•°ç»„ä¸­ï¼ŒæŒ‡å‘åŸæ¥çš„å…ƒç´ ã€‚<br>jdk 8 :åŸæ¥çš„å…ƒç´ åœ¨æ•°ç»„ä¸­ï¼ŒæŒ‡å‘å…ƒç´ a</p><p>æ­¤æ—¶åŒå­¦ä»¬è‚¯å®šä¼šæœ‰ç–‘é—®ï¼Œå¦‚æœHashCodeç›¸åŒéš¾é“ä¼šå‡ºç°equalsä¸åŒçš„æƒ…å†µå˜›ï¼Ÿï¼ˆè¿˜çœŸä¼šå¾…ä¼šè´´å‡ºä¼˜ç§€ä»£ç ï¼‰</p><p>ç”±äºåœ¨æ•°ç»„ å’Œ é“¾è¡¨ å’Œ çº¢é»‘æ ‘ çš„æ•°æ®ç»“æ„æœ‰ç‚¹æŠ½è±¡ ä¸‹é¢å‡ å‰¯å›¾å¯ä»¥å½¢è±¡çœ‹åˆ°HashSetæ·»åŠ æ—¶å…¨è¿‡ç¨‹</p><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/6.png" srcset="/img/loading.gif" alt></p><p>æƒ…å†µ2ï¼š</p><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/7.png" srcset="/img/loading.gif" alt></p><p>æƒ…å†µ3ï¼š</p><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/8.png" srcset="/img/loading.gif" alt></p><p>è¿™é‡Œæ²¡æœ‰ç”¨åˆ°çº¢é»‘æ ‘ï¼Œæ˜¯å› ä¸ºåŠ å…¥çº¢é»‘æ ‘æ˜¯è®©éå†ç­‰æ“ä½œé€Ÿåº¦å˜å¿«ï¼Œå…·ä½“çš„æ–¹å¼ä¸ºï¼Œåœ¨æ•°ç»„æŸä¸€ä¸ªä½ç½®ä¸Šçš„é“¾è¡¨çš„å±‚æ•°åˆ°8å±‚æˆ–æ€»æ•°é‡å¤šäº64ä¸ªæ—¶ï¼Œé“¾è¡¨é‡æ–°æ‰“æ•£ï¼Œæ”¹ä¸ºä½¿ç”¨æ ‘ç»“æ„ï¼Œå½“ç„¶æ ‘ç»“æ„çš„å¤´è¿˜æ˜¯æ•°ç»„ï¼Œå˜æˆä¸€é¢—é¢—å€’ç€çš„æ ‘ã€‚</p><h2 id="5-æ·»åŠ ä»£ç "><a href="#5-æ·»åŠ ä»£ç " class="headerlink" title="5.æ·»åŠ ä»£ç "></a>5.æ·»åŠ ä»£ç </h2><div class="hljs"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span></span>&#123;        Integer num;        String name;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Person</span><span class="hljs-params">(Integer num, String name)</span> </span>&#123;            <span class="hljs-keyword">this</span>.num = num;            <span class="hljs-keyword">this</span>.name = name;        &#125;        <span class="hljs-meta">@Override</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">return</span> <span class="hljs-string">"Person&#123;"</span> +                    <span class="hljs-string">"num="</span> + num +                    <span class="hljs-string">", name='"</span> + name + <span class="hljs-string">'\''</span> +                    <span class="hljs-string">'&#125;'</span>;        &#125;        <span class="hljs-meta">@Override</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span><span class="hljs-params">(Object o)</span> </span>&#123;            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> == o) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            <span class="hljs-keyword">if</span> (!(o <span class="hljs-keyword">instanceof</span> Person)) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            Person person = (Person) o;            <span class="hljs-keyword">return</span> Objects.equals(num, person.num) &amp;&amp;                    Objects.equals(name, person.name);        &#125;        <span class="hljs-meta">@Override</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">return</span> Objects.hash(num, name);        &#125;    &#125;    <span class="hljs-meta">@Test</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test1</span><span class="hljs-params">()</span></span>&#123;        HashSet set = <span class="hljs-keyword">new</span> HashSet();        Person p1 = <span class="hljs-keyword">new</span> Person(<span class="hljs-number">1002</span>,<span class="hljs-string">"AA"</span>);        Person p2 = <span class="hljs-keyword">new</span> Person(<span class="hljs-number">1002</span>,<span class="hljs-string">"BB"</span>);        set.add(p1);        set.add(p2);        System.out.println(set);        p1.name = <span class="hljs-string">"CC"</span>;        set.remove(p1);        System.out.println(set);        set.add(<span class="hljs-keyword">new</span> Person(<span class="hljs-number">1002</span>,<span class="hljs-string">"CC"</span>));        System.out.println(set);        set.add(<span class="hljs-keyword">new</span> Person(<span class="hljs-number">1002</span>,<span class="hljs-string">"AA"</span>));        System.out.println(set);    &#125;</code></pre></div><p>è¿è¡Œtest1ä¸­ä»£ç ç»“æœä¸ºï¼š</p><div class="hljs"><pre><code class="hljs java">[Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'AA'</span>&#125;, Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'BB'</span>&#125;][Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'CC'</span>&#125;, Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'BB'</span>&#125;][Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'CC'</span>&#125;, Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'BB'</span>&#125;, Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'CC'</span>&#125;][Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'CC'</span>&#125;, Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'BB'</span>&#125;, Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'CC'</span>&#125;, Person&#123;num=<span class="hljs-number">1002</span>, name=<span class="hljs-string">'AA'</span>&#125;]</code></pre></div><p>æ˜¯ä¸æ˜¯å¾ˆè¯¡å¼‚ï¼Ÿå…¶å®å½’æ ¹ç»“åº•è¿˜æ˜¯é‚£ä¸‰ç§æƒ…å†µ</p><h1 id="ä¸‰ã€LinkedHashSet"><a href="#ä¸‰ã€LinkedHashSet" class="headerlink" title="ä¸‰ã€LinkedHashSet"></a>ä¸‰ã€LinkedHashSet</h1><h2 id="1-ç»§æ‰¿æƒ…å†µ-1"><a href="#1-ç»§æ‰¿æƒ…å†µ-1" class="headerlink" title="1.ç»§æ‰¿æƒ…å†µ"></a>1.ç»§æ‰¿æƒ…å†µ</h2><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/9.png" srcset="/img/loading.gif" alt></p><h2 id="2-ä¼˜åŠ£"><a href="#2-ä¼˜åŠ£" class="headerlink" title="2.ä¼˜åŠ£"></a>2.ä¼˜åŠ£</h2><p>LinkedHashSet ä¸ HashSet åŒºåˆ«åœ¨äº LinkedHashSet éå†å…¶å†…éƒ¨æ•°æ®æ—¶ï¼Œå¯ä»¥æŒ‰ç…§æ·»åŠ çš„é¡ºåºéå†ï¼Œåœ¨æ·»åŠ æ•°æ®çš„åŒæ—¶ï¼Œæ¯ä¸ªæ•°æ®è¿˜ç»´æŠ¤äº†ä¸¤ä¸ªå¼•ç”¨ï¼Œè®°å½•æ­¤æ•°æ®å‰ä¸€ä¸ªæ•°æ®å’Œåä¸€ä¸ªæ•°æ®ã€‚ </p><p>ç‰¹æ€§å°±å‰©ä¸å¯é‡å¤æ€§äº†</p><p>å¯¹äºé¢‘ç¹çš„éå†æ“ä½œï¼ŒLinkedHashSetæ•ˆç‡é«˜äºHashSet</p><h1 id="å››ã€TreeSet"><a href="#å››ã€TreeSet" class="headerlink" title="å››ã€TreeSet"></a>å››ã€TreeSet</h1><h2 id="1-ç»§æ‰¿æƒ…å†µ-2"><a href="#1-ç»§æ‰¿æƒ…å†µ-2" class="headerlink" title="1.ç»§æ‰¿æƒ…å†µ"></a>1.ç»§æ‰¿æƒ…å†µ</h2><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/10.png" srcset="/img/loading.gif" alt></p><p>TreeSetä¸å¤ªä¸€æ ·ï¼Œå®ƒæ˜¯å¯ä»¥å°†æ•°æ®æŒ‰ç…§ä¸€å®šçš„æ’åˆ—é¡ºåºè¿›è¡Œè¾“å‡ºã€‚æœ‰ä¿©ç§æ–¹å¼ï¼ˆå®šåˆ¶æ’åºï¼Œè‡ªç„¶æ’åºï¼‰</p><h2 id="2-è‡ªç„¶æ’åº"><a href="#2-è‡ªç„¶æ’åº" class="headerlink" title="2.è‡ªç„¶æ’åº"></a>2.è‡ªç„¶æ’åº</h2><p>è‡ªç„¶æ’åºå°±æ˜¯å¯¹è±¡å®ç°äº†Comparableæ¥å£</p><p><img src="/2020/07/25/Set%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/11.png" srcset="/img/loading.gif" alt></p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒSetæ˜¯æ— åºçš„ï¼Œä½†æ˜¯ç”¨TreeSetçš„æ•°æ®å°±æ˜¯æœ‰åºçš„ï¼Œé‚£åŸºæœ¬æ•°æ®ç±»å‹ä¸ºä»€ä¹ˆå­˜è¿›å»å°±ä¼šå˜æœ‰åºå‘¢ï¼Ÿ</p><p>å…¶å®è¿™é‡Œæœ‰ä¸€ä¸ªè‡ªåŠ¨è£…ç®±çš„è¿‡ç¨‹åœ¨Integerä¸­å°±å®ç°äº†è¿™ä¸ªæ¥å£</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Integer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Number</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Comparable</span>&lt;<span class="hljs-title">Integer</span>&gt; </span>&#123;         åœ¨é‡Œé¢é‡å†™äº†compareTo     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compareTo</span><span class="hljs-params">(Integer anotherInteger)</span> </span>&#123;        <span class="hljs-keyword">return</span> compare(<span class="hljs-keyword">this</span>.value, anotherInteger.value);    &#125;     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compare</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;        <span class="hljs-keyword">return</span> (x &lt; y) ? -<span class="hljs-number">1</span> : ((x == y) ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>);    &#125;    ä»¥åè¦æƒ³æ”¾åœ¨TreeSetå®ç°æ’åºçš„å¯¹è±¡ å…ˆè¦è‡ªå·±é‡å†™compareToæ–¹æ³•ï¼Œç”¨è‡ªå·±çš„æ’åˆ—æ–¹å¼æ‰èƒ½ç”Ÿæ•ˆ</code></pre></div><h2 id="3-å®šåˆ¶æ’åº"><a href="#3-å®šåˆ¶æ’åº" class="headerlink" title="3.å®šåˆ¶æ’åº"></a>3.å®šåˆ¶æ’åº</h2><p>å¾€å¾€åœ¨å¾ˆå¤šæ—¶å€™ï¼Œè‡ªç„¶æ’åºæ ¹æœ¬ä¸èƒ½ç”¨ï¼Œå› ä¸ºä¸èƒ½å»æ›´æ”¹æºä»£ç ï¼Œæ‰€ä»¥æœ‰å¦ä¸€ç§æ–¹æ³•ï¼Œå¸®åŠ©æˆ‘ä»¬å®šåˆ¶æ’åºçš„é¡ºåº</p><p>è¿™ç§æ–¹æ³•å°±æ˜¯ç»™TreeSetæ„é€ å™¨ä¸­ç»™ä¸€ä¸ªComparatorå¯¹è±¡ï¼Œåœ¨Comparatorå¯¹è±¡ä¸­é‡å†™compareæ–¹æ³•ï¼Œå®šåˆ¶è‡ªå·±éœ€è¦çš„æ’åˆ—è§„åˆ™</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Test</span>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span></span>&#123;       Comparator com = <span class="hljs-keyword">new</span> Comparator() &#123;           <span class="hljs-comment">//ç…§å¹´é¾„ä»å°åˆ°å¤§æ’åˆ—</span>           <span class="hljs-meta">@Override</span>           <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compare</span><span class="hljs-params">(Object o1, Object o2)</span> </span>&#123;               <span class="hljs-keyword">if</span>(o1 <span class="hljs-keyword">instanceof</span> User &amp;&amp; o2 <span class="hljs-keyword">instanceof</span> User)&#123;                   User u1 = (User)o1;                   User u2 = (User)o2;                   <span class="hljs-keyword">return</span> Integer.compare(u1.getAge(),u2.getAge());               &#125;<span class="hljs-keyword">else</span>&#123;                   <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"è¾“å…¥çš„æ•°æ®ç±»å‹ä¸åŒ¹é…"</span>);               &#125;           &#125;       &#125;;       TreeSet set = <span class="hljs-keyword">new</span> TreeSet(com);       set.add(<span class="hljs-keyword">new</span> User(<span class="hljs-string">"Tom"</span>,<span class="hljs-number">12</span>));       set.add(<span class="hljs-keyword">new</span> User(<span class="hljs-string">"Jerry"</span>,<span class="hljs-number">32</span>));       set.add(<span class="hljs-keyword">new</span> User(<span class="hljs-string">"Jim"</span>,<span class="hljs-number">2</span>));       set.add(<span class="hljs-keyword">new</span> User(<span class="hljs-string">"Mike"</span>,<span class="hljs-number">65</span>));       set.add(<span class="hljs-keyword">new</span> User(<span class="hljs-string">"Mary"</span>,<span class="hljs-number">33</span>));       set.add(<span class="hljs-keyword">new</span> User(<span class="hljs-string">"Jack"</span>,<span class="hljs-number">33</span>));       set.add(<span class="hljs-keyword">new</span> User(<span class="hljs-string">"Jack"</span>,<span class="hljs-number">56</span>));       Iterator iterator = set.iterator();       <span class="hljs-keyword">while</span>(iterator.hasNext())&#123;           System.out.println(iterator.next());       &#125;   &#125;</code></pre></div><p>ä¸€èˆ¬æ¥è¯´å¦‚æœæŸä¸ªå¯¹è±¡ä¸éœ€è¦ç»å¸¸ä½¿ç”¨æ’åºï¼Œåˆ™ä½¿ç”¨å®šåˆ¶æ’åºå°±è¡Œï¼Œå› ä¸ºå¯ä»¥ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼ï¼Œä¸€æ¬¡æ€§çš„æ’åºï¼Œè€Œä½¿ç”¨è‡ªç„¶æ’åºåˆ™æ˜¯ä¸€ç›´ç»‘å®šç€æ’åºè§„åˆ™ï¼Œä¸çµæ´»ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æºç åˆ†æ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Set</tag>
      
      <tag>HashSet</tag>
      
      <tag>LinkedHashSet</tag>
      
      <tag>TreeSet</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Listæ¥å£åº•å±‚å®ç°ç±»</title>
    <link href="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/"/>
    <url>/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<h1 id="Listæ¥å£åº•å±‚å®ç°ç±»"><a href="#Listæ¥å£åº•å±‚å®ç°ç±»" class="headerlink" title="Listæ¥å£åº•å±‚å®ç°ç±»"></a>Listæ¥å£åº•å±‚å®ç°ç±»</h1><h2 id="ä¸€ã€javaé›†åˆç±»åˆ†ç±»"><a href="#ä¸€ã€javaé›†åˆç±»åˆ†ç±»" class="headerlink" title="ä¸€ã€javaé›†åˆç±»åˆ†ç±»"></a>ä¸€ã€javaé›†åˆç±»åˆ†ç±»</h2><p>javaé›†åˆæ¡†æ¶åˆ†ä¸ºä¿©ç§ï¼Œå•åˆ—é›†åˆæ¡†æ¶Collectionï¼Œå’ŒåŒåˆ—é›†åˆæ¡†æ¶Map</p><h3 id="1-å•åˆ—é›†åˆæ¡†æ¶ç»“æ„"><a href="#1-å•åˆ—é›†åˆæ¡†æ¶ç»“æ„" class="headerlink" title="1.å•åˆ—é›†åˆæ¡†æ¶ç»“æ„"></a>1.å•åˆ—é›†åˆæ¡†æ¶ç»“æ„</h3><p>Collectionæ¥å£ï¼šå•åˆ—é›†åˆï¼Œç”¨æ¥å­˜å‚¨ä¸€ä¸ªä¸€ä¸ªçš„å¯¹è±¡</p><ul><li>|â€”-Listæ¥å£ï¼šå­˜å‚¨åºçš„ã€å¯é‡å¤çš„æ•°æ®ã€‚  â€“&gt;â€œåŠ¨æ€â€æ•°ç»„<ul><li>|â€”-ArrayListã€LinkedListã€Vector<br>â€‹</li></ul></li><li>|â€”-Setæ¥å£ï¼šå­˜å‚¨æ— åºçš„ã€ä¸å¯é‡å¤çš„æ•°æ®   â€“&gt;é«˜ä¸­è®²çš„â€œé›†åˆâ€<ul><li>|â€”-HashSetã€LinkedHashSetã€TreeSet</li></ul></li></ul><p>æœ¬æ–‡å°†å¯¹Listæ¥å£è¿›è¡Œè§£æ</p><p>å¯¹åº”å›¾ç¤ºï¼š</p><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1592968971414.png" srcset="/img/loading.gif" alt="å•åˆ—é›†åˆæ¡†æ¶"></p><p><strong>å®çº¿ä¸ºç›´æ¥ç»§æ‰¿æˆ–å®ç°ï¼Œè™šçº¿ä¸ºé—´æ¥ç»§æ‰¿æˆ–å®ç°</strong></p><h2 id="äºŒã€ArrayList"><a href="#äºŒã€ArrayList" class="headerlink" title="äºŒã€ArrayList"></a>äºŒã€ArrayList</h2><h3 id="1-jdk1-7çš„æƒ…å†µ"><a href="#1-jdk1-7çš„æƒ…å†µ" class="headerlink" title="1.jdk1.7çš„æƒ…å†µ"></a>1.jdk1.7çš„æƒ…å†µ</h3><p>â€‹    ArrayList list = new ArrayList();//åº•å±‚åˆ›å»ºäº†é•¿åº¦æ˜¯10çš„Object[]æ•°ç»„elementData</p><ul><li><p>list.add(123);//elementData[0] = new Integer(123);</p></li><li><p>list.add(11);//å¦‚æœæ­¤æ¬¡çš„æ·»åŠ å¯¼è‡´åº•å±‚elementDataæ•°ç»„å®¹é‡ä¸å¤Ÿï¼Œåˆ™æ‰©å®¹ã€‚</p></li><li><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰©å®¹ä¸ºåŸæ¥çš„å®¹é‡çš„1.5å€ï¼ŒåŒæ—¶éœ€è¦å°†åŸæœ‰æ•°ç»„ä¸­çš„æ•°æ®å¤åˆ¶åˆ°æ–°çš„æ•°ç»„ä¸­ã€‚</p></li><li><p>ç»“è®ºï¼šå»ºè®®å¼€å‘ä¸­ä½¿ç”¨å¸¦å‚çš„æ„é€ å™¨ï¼šArrayList list = new ArrayList(int capacity)</p><p>â€‹</p></li></ul><h3 id="2-jdk1-8çš„æƒ…å†µ"><a href="#2-jdk1-8çš„æƒ…å†µ" class="headerlink" title="2.jdk1.8çš„æƒ…å†µ"></a>2.jdk1.8çš„æƒ…å†µ</h3><p>â€‹    ç”±äºç°ä¸»æµå¼€å‘éƒ½æ˜¯1.8ç‰ˆæœ¬çš„jdkï¼Œæ‰€æœ‰ä»¥ä¸‹å¯¹ArrayListè¿›è¡Œæ·±å…¥è§£è¯»</p><h3 id="3-ç»§æ‰¿æƒ…å†µ"><a href="#3-ç»§æ‰¿æƒ…å†µ" class="headerlink" title="3.ç»§æ‰¿æƒ…å†µ"></a>3.ç»§æ‰¿æƒ…å†µ</h3><p>ä½¿ç”¨ideaè‡ªå¸¦çš„å¯è§†åŒ–å·¥å…·æŸ¥çœ‹ç»§æ‰¿ä¸å®ç°æƒ…å†µï¼Œå¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ArrayListé—´æ¥çš„å®ç°äº†Collectionæ¥å£</p><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1592969473(1).jpg" srcset="/img/loading.gif" alt="ç»§æ‰¿æƒ…å†µ"></p><h3 id="4-åˆ›å»ºArrayList"><a href="#4-åˆ›å»ºArrayList" class="headerlink" title="4.åˆ›å»ºArrayList"></a>4.åˆ›å»ºArrayList</h3><p>â€‹    æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹åˆ›å»ºä¸€ä¸ªArrayListå®¹å™¨ä¼šå‘ç”Ÿä»€ä¹ˆ</p><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1592969867(1).jpg" srcset="/img/loading.gif" alt="åˆ›å»ºArrayList"></p><p>å½“æˆ‘ç”¨debugåˆ›å»ºä¸€ä¸ªarrayListæ—¶ è¿”å›çš„æ˜¯ä¸€ä¸ªç©ºçš„ï¼Œé•¿åº¦ä¸º0çš„æ•°ç»„</p><p>æˆ‘ä»¬è·Ÿè¿›å»æ„é€ å‡½æ•°</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ArrayList</span><span class="hljs-params">()</span> </span>&#123;    <span class="hljs-keyword">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;&#125;</code></pre></div><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">transient</span> Object[] elementData; <span class="hljs-comment">//ä¸€ä¸ªæ˜¯Object[]å¯¹è±¡,transientå…³é”®è¯æ˜¯æŒ‡è¯¥å¯¹è±¡ä¸éœ€è¦è¢«åºåˆ—åŒ–</span><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;<span class="hljs-comment">//ä¸€ä¸ªç©ºçš„Object[]å¯¹è±¡</span></code></pre></div><p>ä¸jdk7ç‰ˆæœ¬çš„åŒºåˆ«æ˜¯ jdk7åˆ›å»ºåå°±åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º10çš„æ•°ç»„ï¼Œä½†jdk8å¹¶æ²¡æœ‰ï¼Œæ›´åŠ èŠ‚çœå†…å­˜</p><h3 id="5-æ·»åŠ æ•°æ®"><a href="#5-æ·»åŠ æ•°æ®" class="headerlink" title="5.æ·»åŠ æ•°æ®"></a>5.æ·»åŠ æ•°æ®</h3><div class="hljs"><pre><code class="hljs java">arrayList.add(<span class="hljs-number">123</span>);</code></pre></div><p>æˆ‘ä»¬ç”¨debugè·Ÿè¿›æºç </p><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1592970609(1).jpg" srcset="/img/loading.gif" alt></p><p>å› ä¸ºå­˜å…¥123æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªè‡ªåŠ¨è£…ç®±çš„è¿‡ç¨‹ï¼ˆè£…æ¢ä¸ºIntegerç±»å‹ï¼‰</p><p>åé¢å°±æ˜¯è¿›å…¥addæ–¹æ³•</p><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1592973839(1).jpg" srcset="/img/loading.gif" alt></p><p>sizeé»˜è®¤åˆå§‹åŒ–ä¸º0ï¼Œè¿›å…¥ensureCapacityInternalæ–¹æ³•</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ensureCapacityInternal</span><span class="hljs-params">(<span class="hljs-keyword">int</span> minCapacity)</span> </span>&#123;        <span class="hljs-keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;            minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);            <span class="hljs-comment">//maxæ–¹æ³•å–ä¿©ä¸ªå‚æ•°æœ€å¤§çš„ä¸€ä¸ªï¼ˆè¿™é‡ŒDEFAULT_CAPACITYä¸º10ï¼‰ï¼Œå°†æœ€å¤§çš„å€¼èµ‹ç»™minCapacity</span>        &#125;        ensureExplicitCapacity(minCapacity);    &#125;è¿›å…¥ensureExplicitCapacity(minCapacity)æ–¹æ³•<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ensureExplicitCapacity</span><span class="hljs-params">(<span class="hljs-keyword">int</span> minCapacity)</span> </span>&#123;        modCount++;<span class="hljs-comment">//é»˜è®¤ä¸º0 </span>        <span class="hljs-comment">// overflow-conscious code</span>        <span class="hljs-keyword">if</span> (minCapacity - elementData.length &gt; <span class="hljs-number">0</span>)<span class="hljs-comment">//åˆ¤æ–­æœ€å°å®¹é‡å‡å»åŸæ•°ç»„é•¿åº¦æ˜¯å¦å¤§äº0</span>            grow(minCapacity);    &#125;   è¿›å…¥grow(minCapacity)æ–¹æ³• <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">grow</span><span class="hljs-params">(<span class="hljs-keyword">int</span> minCapacity)</span> </span>&#123;        <span class="hljs-comment">// overflow-conscious code</span>        <span class="hljs-keyword">int</span> oldCapacity = elementData.length;<span class="hljs-comment">//è®°å½•è€å®¹é‡é•¿åº¦ æ­¤æ—¶elementDataé•¿åº¦ä¸º0</span>        <span class="hljs-keyword">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class="hljs-number">1</span>);<span class="hljs-comment">//å®šä¹‰æ–°å®¹é‡å€¼ï¼Œè€å®¹é‡é•¿åº¦å³ç§»ä¸€ä½ååŠ å†ä¸Šè€å®¹é‡é•¿åº¦ï¼Œè€Œå³ç§»ä¸€ä½æ˜¯å–æ•°å€¼çš„ä¸€åŠï¼Œè¿™é‡Œå°±å†³å®šäº†ArrayListä»¥åè¿›è¡Œæ‰©å®¹éƒ½æ˜¯å¯¹åŸæ•°ç»„æ‰©å®¹1.5å€</span>        <span class="hljs-keyword">if</span> (newCapacity - minCapacity &lt; <span class="hljs-number">0</span>)<span class="hljs-comment">//0 - 10 å°äº0 æ‰€æœ‰è¿›å…¥ </span>            newCapacity = minCapacity;<span class="hljs-comment">//æ–°å®¹é‡é•¿åº¦å°±ä¸º10</span>        <span class="hljs-keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="hljs-number">0</span>) <span class="hljs-comment">//åˆ¤æ–­æ­¤å®¹é‡ä¼šä¸ä¼šè¶…è¿‡æœ€å¤§é•¿åº¦ï¼ˆInteger.MAX_VALUE - 8ï¼‰</span>            newCapacity = hugeCapacity(minCapacity);        <span class="hljs-comment">// minCapacity is usually close to size, so this is a win:</span>        elementData = Arrays.copyOf(elementData, newCapacity);<span class="hljs-comment">//è°ƒç”¨Arrayså·¥å…·ç±»ï¼Œå¯¹æ•°ç»„è¿›è¡Œæ‰©å®¹ï¼ŒåŸç†ä¸ºå°†æ—§æ•°ç»„æ•°æ®å¤åˆ¶åˆ°æ–°æ•°ç»„</span>    &#125;</code></pre></div><h2 id="ä¸‰ã€LinkedList"><a href="#ä¸‰ã€LinkedList" class="headerlink" title="ä¸‰ã€LinkedList"></a>ä¸‰ã€LinkedList</h2><h3 id="1-ç»§æ‰¿æƒ…å†µ"><a href="#1-ç»§æ‰¿æƒ…å†µ" class="headerlink" title="1.ç»§æ‰¿æƒ…å†µ"></a>1.ç»§æ‰¿æƒ…å†µ</h3><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1592975059(1).jpg" srcset="/img/loading.gif" alt></p><p>å¯ä»¥çœ‹åˆ°ä¸ä»…é—´æ¥çš„å®ç°äº†Listæ¥å£ï¼Œè¿˜é—´æ¥çš„å®ç°äº†é˜Ÿåˆ—Queueçš„æ¥å£</p><h3 id="2-åˆ›å»ºLinkedList"><a href="#2-åˆ›å»ºLinkedList" class="headerlink" title="2.åˆ›å»ºLinkedList"></a>2.åˆ›å»ºLinkedList</h3><div class="hljs"><pre><code class="hljs java">LinkedList linkedList = <span class="hljs-keyword">new</span> LinkedList();</code></pre></div><p>é€šè¿‡newçš„æ–¹å¼åªæ˜¯åˆå§‹åŒ–LinkedListå®¹å™¨ï¼Œåº•å±‚åŒå‘é“¾è¡¨ç»“æ„è¿˜æœªåˆ›å»ºã€‚LinkedList Nodeç±»å‹çš„firstå’Œlastå±æ€§ï¼Œé»˜è®¤ä¸ºnull</p><h3 id="3-æ·»åŠ æ•°æ®"><a href="#3-æ·»åŠ æ•°æ®" class="headerlink" title="3.æ·»åŠ æ•°æ®"></a>3.æ·»åŠ æ•°æ®</h3><div class="hljs"><pre><code class="hljs java">linkedList.add(<span class="hljs-number">123</span>);</code></pre></div><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1592975703(1).jpg" srcset="/img/loading.gif" alt></p><p>è¿›å…¥linkLastä¸­</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//åœ¨linkedListé‡Œé¢æœ‰firstå’Œlastå±æ€§</span><span class="hljs-keyword">transient</span> Node&lt;E&gt; first;<span class="hljs-keyword">transient</span> Node&lt;E&gt; last;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">linkLast</span><span class="hljs-params">(E e)</span> </span>&#123;    <span class="hljs-keyword">final</span> Node&lt;E&gt; l = last; <span class="hljs-comment">//å°†åŸæ–™çš„lastå¯¹è±¡èµ‹å€¼ç»™l</span>    <span class="hljs-keyword">final</span> Node&lt;E&gt; newNode = <span class="hljs-keyword">new</span> Node&lt;&gt;(l, e, <span class="hljs-keyword">null</span>);<span class="hljs-comment">//Nodeä¸ºä¸€ä¸ªé™æ€å†…éƒ¨ç±» åœ¨ä¸‹é¢ï¼šä½œç”¨æ˜¯åˆå§‹åŒ–Nodeå¯¹è±¡ï¼ˆé“¾è¡¨å¯¹è±¡ï¼Œprevä¸ºå¤´æŒ‡é’ˆï¼Œnextä¸ºå°¾æŒ‡é’ˆï¼Œelementä¸ºæ•°æ®ï¼‰</span>    last = newNode;<span class="hljs-comment">//å°†æœ‰æ•°æ®çš„newNodeèµ‹å€¼ç»™last</span>    <span class="hljs-keyword">if</span> (l == <span class="hljs-keyword">null</span>)<span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯</span>        first = newNode;<span class="hljs-comment">//å°†NewNodeç›´æ¥èµ‹å€¼ç»™å°¾èŠ‚ç‚¹</span>    <span class="hljs-keyword">else</span>        l.next = newNode;<span class="hljs-comment">//ä¸æ˜¯çš„è¯ã€‚å°†èŠ‚ç‚¹æ·»åŠ åˆ°l.next ç›¸å½“äºå°†é“¾è¡¨è¿æ¥èµ·æ¥</span>    size++;    modCount++;&#125;<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span>&lt;<span class="hljs-title">E</span>&gt; </span>&#123;        E item;        Node&lt;E&gt; next;        Node&lt;E&gt; prev;        Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;            <span class="hljs-keyword">this</span>.item = element;            <span class="hljs-keyword">this</span>.next = next;            <span class="hljs-keyword">this</span>.prev = prev;        &#125;    &#125;</code></pre></div><h2 id="å››ã€Vector"><a href="#å››ã€Vector" class="headerlink" title="å››ã€Vector"></a>å››ã€Vector</h2><p>jdk7å’Œjdk8ä¸­é€šè¿‡Vector()æ„é€ å™¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œåº•å±‚éƒ½åˆ›å»ºäº†é•¿åº¦ä¸º10çš„æ•°ç»„ã€‚<br>åœ¨æ‰©å®¹æ–¹é¢ï¼Œé»˜è®¤æ‰©å®¹ä¸ºåŸæ¥çš„æ•°ç»„é•¿åº¦çš„2å€ã€‚</p><h3 id="1-ç»§æ‰¿æƒ…å†µ-1"><a href="#1-ç»§æ‰¿æƒ…å†µ-1" class="headerlink" title="1.ç»§æ‰¿æƒ…å†µ"></a>1.ç»§æ‰¿æƒ…å†µ</h3><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1593002715(1).png" srcset="/img/loading.gif" alt></p><h3 id="2-åˆ›å»ºVector"><a href="#2-åˆ›å»ºVector" class="headerlink" title="2.åˆ›å»ºVector"></a>2.åˆ›å»ºVector</h3><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1593002840(1).jpg" srcset="/img/loading.gif" alt></p><p>è®©æˆ‘ä»¬è·Ÿè¿›å»æ„é€ å‡½æ•°</p><div class="hljs"><pre><code class="hljs java"> <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Vector</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">this</span>(<span class="hljs-number">10</span>);    &#125;å†å¾€ä¸‹è·Ÿï¼Œè°ƒç”¨ä¸€ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Vector</span><span class="hljs-params">(<span class="hljs-keyword">int</span> initialCapacity)</span> </span>&#123;        <span class="hljs-keyword">this</span>(initialCapacity, <span class="hljs-number">0</span>);    &#125;    å†å¾€ä¸‹è·Ÿï¼Œè°ƒç”¨å‡‰å‚æ•°çš„æ„é€ å‡½æ•°<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Vector</span><span class="hljs-params">(<span class="hljs-keyword">int</span> initialCapacity, <span class="hljs-keyword">int</span> capacityIncrement)</span> </span>&#123;        <span class="hljs-keyword">super</span>();<span class="hljs-comment">//æ˜¾ç¤ºè°ƒç”¨çˆ¶æ„é€ å‡½æ•°</span>        <span class="hljs-keyword">if</span> (initialCapacity &lt; <span class="hljs-number">0</span>)<span class="hljs-comment">//ä¸º0å°±æŠ¥é”™ï¼Œå‚æ•°ä¼ è¿›æ¥ä¸º10</span>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"Illegal Capacity: "</span>+                                               initialCapacity);        <span class="hljs-keyword">this</span>.elementData = <span class="hljs-keyword">new</span> Object[initialCapacity]; <span class="hljs-comment">//åˆ›å»ºå¹¶åˆå§‹åŒ–äº†å¯¹è±¡æ•°ç»„</span>        <span class="hljs-keyword">this</span>.capacityIncrement = capacityIncrement;    &#125;    ä¸Šé¢ä¿©ä¸ªå±æ€§å®šä¹‰å¦‚ä¸‹ï¼š<span class="hljs-keyword">protected</span> Object[] elementData;<span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> elementCount;</code></pre></div><p>æ­¤ç‰ˆæœ¬ä¸ºjdk8ï¼Œjdk7çš„Vectorä¹Ÿæ˜¯åˆ›å»ºä¸€ä¸ªVectorå®¹å™¨å°±é»˜è®¤åˆå§‹åŒ–é•¿åº¦ä¸º0ï¼Œä¸jdk7çš„ArrayListä¸€æ ·ï¼Œä½†æ˜¯äººå®¶å¼€å‘è€…å¯¹ArrayListè¿›è¡Œäº†æ”¹è¿›ï¼Œä½¿ç”¨æ‡’åŠ è½½ï¼Œå¯èƒ½Vectorè¦è¢«æ”¾å¼ƒäº†å§ï¼ï¼</p><p>æ¥ä¸‹æ¥è®²ä¸ºä»€ä¹ˆä¼šæ”¾å¼ƒVector</p><h3 id="3-æ·»åŠ æ•°æ®-1"><a href="#3-æ·»åŠ æ•°æ®-1" class="headerlink" title="3.æ·»åŠ æ•°æ®"></a>3.æ·»åŠ æ•°æ®</h3><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1593003620(1).jpg" srcset="/img/loading.gif" alt></p><p>æ¥ä¸‹æ¥è·Ÿè¿›æºç </p><p><img src="/2020/06/24/List%E6%8E%A5%E5%8F%A3%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E7%B1%BB/1593003749(1).jpg" srcset="/img/loading.gif" alt></p><p>elementCounté»˜è®¤ä¸º0ã€‚</p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªensureCapacityHelperæ–¹æ³•ï¼Œæ­¤æ–¹æ³•æ˜¯æ ¡éªŒé•¿åº¦æ˜¯å¦è¶³å¤Ÿï¼Œå¹¶å»æ‰©å®¹çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ensureCapacityHelper</span><span class="hljs-params">(<span class="hljs-keyword">int</span> minCapacity)</span> </span>&#123;    <span class="hljs-comment">// overflow-conscious code</span>    <span class="hljs-keyword">if</span> (minCapacity - elementData.length &gt; <span class="hljs-number">0</span>)        grow(minCapacity);<span class="hljs-comment">//æ‰©å®¹æ–¹æ³•</span>&#125;</code></pre></div><p>ä½†æ­¤å¤„å› ä¸ºé»˜è®¤åˆå§‹åŒ–é•¿åº¦ä¸º10ï¼Œæ‰€ä»¥è¿™é‡Œä¸ä¼šæœ‰æ‰©å®¹çš„éœ€æ±‚ã€‚</p><p>ç¨ç­‰ï¼Vectorä¸æ˜¯æŒºå¥½çš„å˜›ï¼Œä¸ºä»€ä¹ˆè¦æ”¾å¼ƒä»–ï¼Ÿï¼Ÿå› ä¸ºâ€¦</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(E e)</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> E <span class="hljs-title">remove</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">containsAll</span><span class="hljs-params">(Collection&lt;?&gt; c)</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">addAll</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, Collection&lt;? extends E&gt; c)</span></span></code></pre></div><p>å› ä¸ºä»–çš„æ–¹æ³•ä¸Šå…¨åŠ äº†synchronizedï¼ŒåŠ ä¸Šè¿™ä¸ªå­—æ®µä»–å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„æ–¹æ³•ï¼Œè€Œä»–çš„å…¨éƒ¨æ–¹æ³•éƒ½æ˜¯çº¿ç¨‹å®‰å…¨æ–¹æ³•ï¼Œåˆä¼—æ‰€å‘¨çŸ¥ï¼Œçº¿ç¨‹å®‰å…¨æ•ˆç‡å¤§å¤§å‡ä½ï¼Œæ‰€ä»¥è¿å¼€å‘jdkäººå‘˜éƒ½æ‡’å¾—æ•‘ä»–ï¼Œæ¯•ç«Ÿï¼Œå‡ºç°äº†æ›´å¥½çš„äººï¼Œè€æƒ…äººå…¨å¿˜æ‰äº†~</p><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>ä¸Šè¿°ä»‹ç»äº†Listæ¥å£çš„å…¨éƒ¨å®ç°ç±»ï¼Œå¦‚æœæ•°æ®ä¸éœ€è¦çº¿ç¨‹å®‰å…¨ï¼Œåˆ™ä¸è¦å»è€ƒè™‘ä½¿ç”¨Vectorï¼Œè€Œå› ä¸ºArrayListå’ŒLinkedListåº•å±‚å®ç°åŸç†ä¸åŒï¼Œä»–ä»¬ä½¿ç”¨çš„åœ°æ–¹ä¹Ÿæœ‰æ‰€ä¸åŒï¼ŒArrayListåº•å±‚ä½¿ç”¨çš„æ˜¯æ•°ç»„å®ç°ï¼Œå› æ­¤åœ¨éœ€è¦é¢‘ç¹çš„æ’å…¥å’Œåˆ é™¤æ•°æ®æ—¶æ•ˆç‡ä¼šå¤§å¤§å‡ä½ï¼Œè€Œæ•°ç»„æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯æœ‰ä¸‹æ ‡ï¼Œä¸‹æ ‡æœ€ç›´æ¥å¥½çš„å¥½å¤„å°±æ˜¯æŸ¥è¯¢é€Ÿåº¦éå¸¸çš„å¿«ï¼Œè€ŒLinkedListåº•å±‚ä½¿ç”¨çš„æ˜¯åŒå‘é“¾è¡¨å®ç°ï¼Œæ‰€ä»¥åœ¨é¢‘ç¹çš„æ’å…¥å’Œåˆ é™¤æ•°æ®æ—¶ï¼Œæœ‰è¶…é«˜æ€§èƒ½çš„è¡¨ç°ï¼Œä½†æ˜¯åœ¨æŸ¥è¯¢çš„é€Ÿåº¦è¿œè¿œæ¯”ä¸ä¸ŠArrayListã€‚</p><p>è®°é‡ç‚¹ï¼šArrayListæ•°ç»„å®ç°ï¼Œæ¯æ¬¡æ‰©å®¹1.5å€ï¼Œä½¿ç”¨æ‡’åŠ è½½ï¼Œé¦–æ¬¡æ‰©å®¹é•¿åº¦ä¸º10</p><p>â€‹        LinkedListåŒå‘é“¾è¡¨å®ç°</p>]]></content>
    
    
    <categories>
      
      <category>æºç åˆ†æ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>List</tag>
      
      <tag>ArrayList</tag>
      
      <tag>LinkedList</tag>
      
      <tag>Vector</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBoot-SpringMVCè‡ªåŠ¨é…ç½®</title>
    <link href="/2020/06/24/SpringBoot-SpringMVC%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE/"/>
    <url>/2020/06/24/SpringBoot-SpringMVC%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="SpringMVCè‡ªåŠ¨é…ç½®"><a href="#SpringMVCè‡ªåŠ¨é…ç½®" class="headerlink" title="SpringMVCè‡ªåŠ¨é…ç½®"></a>SpringMVCè‡ªåŠ¨é…ç½®</h2><p><a href="https://docs.spring.io/spring-boot/docs/1.5.10.RELEASE/reference/htmlsingle/#boot-features-developing-web-applications" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/1.5.10.RELEASE/reference/htmlsingle/#boot-features-developing-web-applications</a></p><h3 id="1-Spring-MVC-auto-configuration"><a href="#1-Spring-MVC-auto-configuration" class="headerlink" title="1. Spring MVC auto-configuration"></a>1. Spring MVC auto-configuration</h3><p>Spring Boot è‡ªåŠ¨é…ç½®å¥½äº†SpringMVC</p><p>ä»¥ä¸‹æ˜¯SpringBootå¯¹SpringMVCçš„é»˜è®¤é…ç½®:<strong>==ï¼ˆWebMvcAutoConfigurationï¼‰==</strong></p><ul><li><p>Inclusion of <code>ContentNegotiatingViewResolver</code> and <code>BeanNameViewResolver</code> beans.</p><ul><li>è‡ªåŠ¨é…ç½®äº†ViewResolverï¼ˆè§†å›¾è§£æå™¨ï¼šæ ¹æ®æ–¹æ³•çš„è¿”å›å€¼å¾—åˆ°è§†å›¾å¯¹è±¡ï¼ˆViewï¼‰ï¼Œè§†å›¾å¯¹è±¡å†³å®šå¦‚ä½•æ¸²æŸ“ï¼ˆè½¬å‘ï¼Ÿé‡å®šå‘ï¼Ÿï¼‰ï¼‰</li><li>ContentNegotiatingViewResolverï¼šç»„åˆæ‰€æœ‰çš„è§†å›¾è§£æå™¨çš„ï¼›</li><li>==å¦‚ä½•å®šåˆ¶ï¼šæˆ‘ä»¬å¯ä»¥è‡ªå·±ç»™å®¹å™¨ä¸­æ·»åŠ ä¸€ä¸ªè§†å›¾è§£æå™¨ï¼›è‡ªåŠ¨çš„å°†å…¶ç»„åˆè¿›æ¥ï¼›==</li></ul></li><li><p>Support for serving static resources, including support for WebJars (see below).é™æ€èµ„æºæ–‡ä»¶å¤¹è·¯å¾„,webjars</p></li><li><p>Static <code>index.html</code> support. é™æ€é¦–é¡µè®¿é—®</p></li><li><p>Custom <code>Favicon</code> support (see below).  favicon.ico</p><p>â€‹</p></li><li><p>è‡ªåŠ¨æ³¨å†Œäº† of <code>Converter</code>, <code>GenericConverter</code>, <code>Formatter</code> beans.</p><ul><li>Converterï¼šè½¬æ¢å™¨ï¼›  public String hello(User user)ï¼šç±»å‹è½¬æ¢ä½¿ç”¨Converter</li><li><code>Formatter</code>  æ ¼å¼åŒ–å™¨ï¼›  2017.12.17===Dateï¼›</li></ul></li></ul><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><span class="hljs-meta">@ConditionalOnProperty</span>(prefix = <span class="hljs-string">"spring.mvc"</span>, name = <span class="hljs-string">"date-format"</span>)<span class="hljs-comment">//åœ¨æ–‡ä»¶ä¸­é…ç½®æ—¥æœŸæ ¼å¼åŒ–çš„è§„åˆ™</span><span class="hljs-function"><span class="hljs-keyword">public</span> Formatter&lt;Date&gt; <span class="hljs-title">dateFormatter</span><span class="hljs-params">()</span> </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DateFormatter(<span class="hljs-keyword">this</span>.mvcProperties.getDateFormat());<span class="hljs-comment">//æ—¥æœŸæ ¼å¼åŒ–ç»„ä»¶</span>&#125;</code></pre></div><p>â€‹    ==è‡ªå·±æ·»åŠ çš„æ ¼å¼åŒ–å™¨è½¬æ¢å™¨ï¼Œæˆ‘ä»¬åªéœ€è¦æ”¾åœ¨å®¹å™¨ä¸­å³å¯==</p><ul><li><p>Support for <code>HttpMessageConverters</code> (see below).</p><ul><li><p>HttpMessageConverterï¼šSpringMVCç”¨æ¥è½¬æ¢Httpè¯·æ±‚å’Œå“åº”çš„ï¼›Userâ€”Jsonï¼›</p></li><li><p><code>HttpMessageConverters</code> æ˜¯ä»å®¹å™¨ä¸­ç¡®å®šï¼›è·å–æ‰€æœ‰çš„HttpMessageConverterï¼›</p><p>==è‡ªå·±ç»™å®¹å™¨ä¸­æ·»åŠ HttpMessageConverterï¼Œåªéœ€è¦å°†è‡ªå·±çš„ç»„ä»¶æ³¨å†Œå®¹å™¨ä¸­ï¼ˆ@Bean,@Componentï¼‰==</p><p>â€‹</p></li></ul></li><li><p>Automatic registration of <code>MessageCodesResolver</code> (see below).å®šä¹‰é”™è¯¯ä»£ç ç”Ÿæˆè§„åˆ™</p></li><li><p>Automatic use of a <code>ConfigurableWebBindingInitializer</code> bean (see below).</p><p>==æˆ‘ä»¬å¯ä»¥é…ç½®ä¸€ä¸ªConfigurableWebBindingInitializeræ¥æ›¿æ¢é»˜è®¤çš„ï¼›ï¼ˆæ·»åŠ åˆ°å®¹å™¨ï¼‰==</p><div class="hljs"><pre><code class="hljs diff">åˆå§‹åŒ–WebDataBinderï¼›è¯·æ±‚æ•°æ®<span class="hljs-comment">=====JavaBeanï¼›</span></code></pre></div></li></ul><p><strong>org.springframework.boot.autoconfigure.webï¼šwebçš„æ‰€æœ‰è‡ªåŠ¨åœºæ™¯ï¼›</strong></p><p>If you want to keep Spring Boot MVC features, and you just want to add additional <a href="https://docs.spring.io/spring/docs/4.3.14.RELEASE/spring-framework-reference/htmlsingle#mvc" target="_blank" rel="noopener">MVC configuration</a> (interceptors, formatters, view controllers etc.) you can add your own <code>@Configuration</code> class of type <code>WebMvcConfigurerAdapter</code>, but <strong>without</strong> <code>@EnableWebMvc</code>. If you wish to provide custom instances of <code>RequestMappingHandlerMapping</code>, <code>RequestMappingHandlerAdapter</code> or <code>ExceptionHandlerExceptionResolver</code> you can declare a <code>WebMvcRegistrationsAdapter</code> instance providing such components.</p><p>If you want to take complete control of Spring MVC, you can add your own <code>@Configuration</code> annotated with <code>@EnableWebMvc</code>.</p><h3 id="2ã€æ‰©å±•SpringMVC"><a href="#2ã€æ‰©å±•SpringMVC" class="headerlink" title="2ã€æ‰©å±•SpringMVC"></a>2ã€æ‰©å±•SpringMVC</h3><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mvc:view-controller</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/hello"</span> <span class="hljs-attr">view-name</span>=<span class="hljs-string">"success"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptors</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptor</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">mvc:mapping</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/hello"</span>/&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">bean</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptor</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptors</span>&gt;</span></code></pre></div><p><strong>==ç¼–å†™ä¸€ä¸ªé…ç½®ç±»ï¼ˆ@Configurationï¼‰ï¼Œæ˜¯WebMvcConfigurerAdapterç±»å‹ï¼›ä¸èƒ½æ ‡æ³¨@EnableWebMvc==</strong>;</p><p>æ—¢ä¿ç•™äº†æ‰€æœ‰çš„è‡ªåŠ¨é…ç½®ï¼Œä¹Ÿèƒ½ç”¨æˆ‘ä»¬æ‰©å±•çš„é…ç½®ï¼›</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//ä½¿ç”¨WebMvcConfigurerAdapterå¯ä»¥æ¥æ‰©å±•SpringMVCçš„åŠŸèƒ½</span><span class="hljs-meta">@Configuration</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMvcConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebMvcConfigurerAdapter</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> </span>&#123;       <span class="hljs-comment">// super.addViewControllers(registry);</span>        <span class="hljs-comment">//æµè§ˆå™¨å‘é€ /atguigu è¯·æ±‚æ¥åˆ° success</span>        registry.addViewController(<span class="hljs-string">"/atguigu"</span>).setViewName(<span class="hljs-string">"success"</span>);    &#125;&#125;</code></pre></div><p>åŸç†ï¼š</p><p>â€‹    1ï¼‰ã€WebMvcAutoConfigurationæ˜¯SpringMVCçš„è‡ªåŠ¨é…ç½®ç±»</p><p>â€‹    2ï¼‰ã€åœ¨åšå…¶ä»–è‡ªåŠ¨é…ç½®æ—¶ä¼šå¯¼å…¥ï¼›@Import(<strong>EnableWebMvcConfiguration</strong>.class)</p><div class="hljs"><pre><code class="hljs java">   <span class="hljs-meta">@Configuration</span><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EnableWebMvcConfiguration</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DelegatingWebMvcConfiguration</span> </span>&#123;     <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> WebMvcConfigurerComposite configurers = <span class="hljs-keyword">new</span> WebMvcConfigurerComposite(); <span class="hljs-comment">//ä»å®¹å™¨ä¸­è·å–æ‰€æœ‰çš„WebMvcConfigurer</span>     <span class="hljs-meta">@Autowired</span>(required = <span class="hljs-keyword">false</span>)     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setConfigurers</span><span class="hljs-params">(List&lt;WebMvcConfigurer&gt; configurers)</span> </span>&#123;         <span class="hljs-keyword">if</span> (!CollectionUtils.isEmpty(configurers)) &#123;             <span class="hljs-keyword">this</span>.configurers.addWebMvcConfigurers(configurers);           <span class="hljs-comment">//ä¸€ä¸ªå‚è€ƒå®ç°ï¼›å°†æ‰€æœ‰çš„WebMvcConfigurerç›¸å…³é…ç½®éƒ½æ¥ä¸€èµ·è°ƒç”¨ï¼›  </span>           <span class="hljs-meta">@Override</span>            <span class="hljs-comment">// public void addViewControllers(ViewControllerRegistry registry) &#123;</span>             <span class="hljs-comment">//    for (WebMvcConfigurer delegate : this.delegates) &#123;</span>              <span class="hljs-comment">//       delegate.addViewControllers(registry);</span>              <span class="hljs-comment">//   &#125;</span>             &#125;         &#125;&#125;</code></pre></div><p>â€‹    3ï¼‰ã€å®¹å™¨ä¸­æ‰€æœ‰çš„WebMvcConfigureréƒ½ä¼šä¸€èµ·èµ·ä½œç”¨ï¼›</p><p>â€‹    4ï¼‰ã€æˆ‘ä»¬çš„é…ç½®ç±»ä¹Ÿä¼šè¢«è°ƒç”¨ï¼›</p><p>â€‹    æ•ˆæœï¼šSpringMVCçš„è‡ªåŠ¨é…ç½®å’Œæˆ‘ä»¬çš„æ‰©å±•é…ç½®éƒ½ä¼šèµ·ä½œç”¨ï¼›</p><h3 id="3ã€å…¨é¢æ¥ç®¡SpringMVCï¼›"><a href="#3ã€å…¨é¢æ¥ç®¡SpringMVCï¼›" class="headerlink" title="3ã€å…¨é¢æ¥ç®¡SpringMVCï¼›"></a>3ã€å…¨é¢æ¥ç®¡SpringMVCï¼›</h3><p>SpringBootå¯¹SpringMVCçš„è‡ªåŠ¨é…ç½®ä¸éœ€è¦äº†ï¼Œæ‰€æœ‰éƒ½æ˜¯æˆ‘ä»¬è‡ªå·±é…ç½®ï¼›æ‰€æœ‰çš„SpringMVCçš„è‡ªåŠ¨é…ç½®éƒ½å¤±æ•ˆäº†</p><p><strong>æˆ‘ä»¬éœ€è¦åœ¨é…ç½®ç±»ä¸­æ·»åŠ @EnableWebMvcå³å¯ï¼›</strong></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//ä½¿ç”¨WebMvcConfigurerAdapterå¯ä»¥æ¥æ‰©å±•SpringMVCçš„åŠŸèƒ½</span><span class="hljs-meta">@EnableWebMvc</span><span class="hljs-meta">@Configuration</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMvcConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebMvcConfigurerAdapter</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> </span>&#123;       <span class="hljs-comment">// super.addViewControllers(registry);</span>        <span class="hljs-comment">//æµè§ˆå™¨å‘é€ /atguigu è¯·æ±‚æ¥åˆ° success</span>        registry.addViewController(<span class="hljs-string">"/atguigu"</span>).setViewName(<span class="hljs-string">"success"</span>);    &#125;&#125;</code></pre></div><p>åŸç†ï¼š</p><p>ä¸ºä»€ä¹ˆ@EnableWebMvcè‡ªåŠ¨é…ç½®å°±å¤±æ•ˆäº†ï¼›</p><p>1ï¼‰@EnableWebMvcçš„æ ¸å¿ƒ</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Import</span>(DelegatingWebMvcConfiguration<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span><span class="hljs-class"><span class="hljs-title">public</span> @<span class="hljs-title">interface</span> <span class="hljs-title">EnableWebMvc</span> </span>&#123;</code></pre></div><p>2ï¼‰ã€</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DelegatingWebMvcConfiguration</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebMvcConfigurationSupport</span> </span>&#123;</code></pre></div><p>3ï¼‰ã€</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><span class="hljs-meta">@ConditionalOnWebApplication</span><span class="hljs-meta">@ConditionalOnClass</span>(&#123; Servlet<span class="hljs-class">.<span class="hljs-keyword">class</span>, <span class="hljs-title">DispatcherServlet</span>.<span class="hljs-title">class</span>,</span><span class="hljs-class"><span class="hljs-title">WebMvcConfigurerAdapter</span>.<span class="hljs-title">class</span> &#125;)</span><span class="hljs-class">//å®¹å™¨ä¸­æ²¡æœ‰è¿™ä¸ªç»„ä»¶çš„æ—¶å€™ï¼Œè¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»æ‰ç”Ÿæ•ˆ</span><span class="hljs-class">@<span class="hljs-title">ConditionalOnMissingBean</span>(<span class="hljs-title">WebMvcConfigurationSupport</span>.<span class="hljs-title">class</span>)</span><span class="hljs-class">@<span class="hljs-title">AutoConfigureOrder</span>(<span class="hljs-title">Ordered</span>.<span class="hljs-title">HIGHEST_PRECEDENCE</span> + 10)</span><span class="hljs-class">@<span class="hljs-title">AutoConfigureAfter</span>(</span>&#123; DispatcherServletAutoConfiguration<span class="hljs-class">.<span class="hljs-keyword">class</span>,</span><span class="hljs-class"><span class="hljs-title">ValidationAutoConfiguration</span>.<span class="hljs-title">class</span> &#125;)</span><span class="hljs-class"><span class="hljs-title">public</span> <span class="hljs-title">class</span> <span class="hljs-title">WebMvcAutoConfiguration</span> </span>&#123;</code></pre></div><p>4ï¼‰ã€@EnableWebMvcå°†WebMvcConfigurationSupportç»„ä»¶å¯¼å…¥è¿›æ¥ï¼›</p><p>5ï¼‰ã€å¯¼å…¥çš„WebMvcConfigurationSupportåªæ˜¯SpringMVCæœ€åŸºæœ¬çš„åŠŸèƒ½ï¼›</p><h3 id="4ã€å¦‚ä½•ä¿®æ”¹SpringBootçš„é»˜è®¤é…ç½®"><a href="#4ã€å¦‚ä½•ä¿®æ”¹SpringBootçš„é»˜è®¤é…ç½®" class="headerlink" title="4ã€å¦‚ä½•ä¿®æ”¹SpringBootçš„é»˜è®¤é…ç½®"></a>4ã€å¦‚ä½•ä¿®æ”¹SpringBootçš„é»˜è®¤é…ç½®</h3><p>æ¨¡å¼ï¼š</p><p>â€‹    1ï¼‰ã€SpringBootåœ¨è‡ªåŠ¨é…ç½®å¾ˆå¤šç»„ä»¶çš„æ—¶å€™ï¼Œå…ˆçœ‹å®¹å™¨ä¸­æœ‰æ²¡æœ‰ç”¨æˆ·è‡ªå·±é…ç½®çš„ï¼ˆ@Beanã€@Componentï¼‰å¦‚æœæœ‰å°±ç”¨ç”¨æˆ·é…ç½®çš„ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæ‰è‡ªåŠ¨é…ç½®ï¼›å¦‚æœæœ‰äº›ç»„ä»¶å¯ä»¥æœ‰å¤šä¸ªï¼ˆViewResolverï¼‰å°†ç”¨æˆ·é…ç½®çš„å’Œè‡ªå·±é»˜è®¤çš„ç»„åˆèµ·æ¥ï¼›</p><p>â€‹    2ï¼‰ã€åœ¨SpringBootä¸­ä¼šæœ‰éå¸¸å¤šçš„xxxConfigurerå¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ‰©å±•é…ç½®</p><p>â€‹    3ï¼‰ã€åœ¨SpringBootä¸­ä¼šæœ‰å¾ˆå¤šçš„xxxCustomizerå¸®åŠ©æˆ‘ä»¬è¿›è¡Œå®šåˆ¶é…ç½®</p>]]></content>
    
    
    <categories>
      
      <category>æºç åˆ†æ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
      <tag>SpringMVC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootæ—¥å¿—</title>
    <link href="/2020/06/23/SpringBoot%E6%97%A5%E5%BF%97/"/>
    <url>/2020/06/23/SpringBoot%E6%97%A5%E5%BF%97/</url>
    
    <content type="html"><![CDATA[<h1 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h1><h2 id="1ã€æ—¥å¿—æ¡†æ¶"><a href="#1ã€æ—¥å¿—æ¡†æ¶" class="headerlink" title="1ã€æ—¥å¿—æ¡†æ¶"></a>1ã€æ—¥å¿—æ¡†æ¶</h2><p> å°å¼ ï¼›å¼€å‘ä¸€ä¸ªå¤§å‹ç³»ç»Ÿï¼›</p><p>â€‹        1ã€System.out.println(â€œâ€)ï¼›å°†å…³é”®æ•°æ®æ‰“å°åœ¨æ§åˆ¶å°ï¼›å»æ‰ï¼Ÿå†™åœ¨ä¸€ä¸ªæ–‡ä»¶ï¼Ÿ</p><p>â€‹        2ã€æ¡†æ¶æ¥è®°å½•ç³»ç»Ÿçš„ä¸€äº›è¿è¡Œæ—¶ä¿¡æ¯ï¼›æ—¥å¿—æ¡†æ¶ ï¼›  zhanglogging.jarï¼›</p><p>â€‹        3ã€é«˜å¤§ä¸Šçš„å‡ ä¸ªåŠŸèƒ½ï¼Ÿå¼‚æ­¥æ¨¡å¼ï¼Ÿè‡ªåŠ¨å½’æ¡£ï¼Ÿxxxxï¼Ÿ  zhanglogging-good.jarï¼Ÿ</p><p>â€‹        4ã€å°†ä»¥å‰æ¡†æ¶å¸ä¸‹æ¥ï¼Ÿæ¢ä¸Šæ–°çš„æ¡†æ¶ï¼Œé‡æ–°ä¿®æ”¹ä¹‹å‰ç›¸å…³çš„APIï¼›zhanglogging-prefect.jarï¼›</p><p>â€‹        5ã€JDBCâ€”æ•°æ®åº“é©±åŠ¨ï¼›</p><p>â€‹            å†™äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£å±‚ï¼›æ—¥å¿—é—¨é¢ï¼ˆæ—¥å¿—çš„ä¸€ä¸ªæŠ½è±¡å±‚ï¼‰ï¼›logging-abstract.jarï¼›</p><p>â€‹            ç»™é¡¹ç›®ä¸­å¯¼å…¥å…·ä½“çš„æ—¥å¿—å®ç°å°±è¡Œäº†ï¼›æˆ‘ä»¬ä¹‹å‰çš„æ—¥å¿—æ¡†æ¶éƒ½æ˜¯å®ç°çš„æŠ½è±¡å±‚ï¼›</p><p><strong>å¸‚é¢ä¸Šçš„æ—¥å¿—æ¡†æ¶ï¼›</strong></p><p>JULã€JCLã€Jboss-loggingã€logbackã€log4jã€log4j2ã€slf4jâ€¦.</p><table><thead><tr><th>æ—¥å¿—é—¨é¢  ï¼ˆæ—¥å¿—çš„æŠ½è±¡å±‚ï¼‰</th><th>æ—¥å¿—å®ç°</th></tr></thead><tbody><tr><td><del>JCLï¼ˆJakarta  Commons Loggingï¼‰</del>    SLF4jï¼ˆSimple  Logging Facade for Javaï¼‰    <strong><del>jboss-logging</del></strong></td><td>Log4j  JULï¼ˆjava.util.loggingï¼‰  Log4j2  <strong>Logback</strong></td></tr></tbody></table><p>å·¦è¾¹é€‰ä¸€ä¸ªé—¨é¢ï¼ˆæŠ½è±¡å±‚ï¼‰ã€å³è¾¹æ¥é€‰ä¸€ä¸ªå®ç°ï¼›</p><p>æ—¥å¿—é—¨é¢ï¼š  SLF4Jï¼›</p><p>æ—¥å¿—å®ç°ï¼šLogbackï¼›</p><p>SpringBootï¼šåº•å±‚æ˜¯Springæ¡†æ¶ï¼ŒSpringæ¡†æ¶é»˜è®¤æ˜¯ç”¨JCLï¼›â€˜</p><p>â€‹    <strong>==SpringBooté€‰ç”¨ SLF4jå’Œlogbackï¼›==</strong></p><h2 id="2ã€SLF4jä½¿ç”¨"><a href="#2ã€SLF4jä½¿ç”¨" class="headerlink" title="2ã€SLF4jä½¿ç”¨"></a>2ã€SLF4jä½¿ç”¨</h2><h3 id="1ã€å¦‚ä½•åœ¨ç³»ç»Ÿä¸­ä½¿ç”¨SLF4j-https-www-slf4j-org"><a href="#1ã€å¦‚ä½•åœ¨ç³»ç»Ÿä¸­ä½¿ç”¨SLF4j-https-www-slf4j-org" class="headerlink" title="1ã€å¦‚ä½•åœ¨ç³»ç»Ÿä¸­ä½¿ç”¨SLF4j   https://www.slf4j.org"></a>1ã€å¦‚ä½•åœ¨ç³»ç»Ÿä¸­ä½¿ç”¨SLF4j   <a href="https://www.slf4j.org" target="_blank" rel="noopener">https://www.slf4j.org</a></h3><p>ä»¥åå¼€å‘çš„æ—¶å€™ï¼Œæ—¥å¿—è®°å½•æ–¹æ³•çš„è°ƒç”¨ï¼Œä¸åº”è¯¥æ¥ç›´æ¥è°ƒç”¨æ—¥å¿—çš„å®ç°ç±»ï¼Œè€Œæ˜¯è°ƒç”¨æ—¥å¿—æŠ½è±¡å±‚é‡Œé¢çš„æ–¹æ³•ï¼›</p><p>ç»™ç³»ç»Ÿé‡Œé¢å¯¼å…¥slf4jçš„jarå’Œ  logbackçš„å®ç°jar</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.slf4j.Logger;<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloWorld</span> </span>&#123;  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;    Logger logger = LoggerFactory.getLogger(HelloWorld<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;    logger.info(<span class="hljs-string">"Hello World"</span>);  &#125;&#125;</code></pre></div><p>å›¾ç¤ºï¼›</p><p><img src="/2020/06/23/SpringBoot%E6%97%A5%E5%BF%97/concrete-bindings.png" srcset="/img/loading.gif" alt="images/concrete-bindings.png"></p><p>æ¯ä¸€ä¸ªæ—¥å¿—çš„å®ç°æ¡†æ¶éƒ½æœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶ã€‚ä½¿ç”¨slf4jä»¥åï¼Œ<strong>é…ç½®æ–‡ä»¶è¿˜æ˜¯åšæˆæ—¥å¿—å®ç°æ¡†æ¶è‡ªå·±æœ¬èº«çš„é…ç½®æ–‡ä»¶ï¼›</strong></p><h3 id="2ã€é—ç•™é—®é¢˜"><a href="#2ã€é—ç•™é—®é¢˜" class="headerlink" title="2ã€é—ç•™é—®é¢˜"></a>2ã€é—ç•™é—®é¢˜</h3><p>aï¼ˆslf4j+logbackï¼‰: Springï¼ˆcommons-loggingï¼‰ã€Hibernateï¼ˆjboss-loggingï¼‰ã€MyBatisã€xxxx</p><p>ç»Ÿä¸€æ—¥å¿—è®°å½•ï¼Œå³ä½¿æ˜¯åˆ«çš„æ¡†æ¶å’Œæˆ‘ä¸€èµ·ç»Ÿä¸€ä½¿ç”¨slf4jè¿›è¡Œè¾“å‡ºï¼Ÿ</p><p><img src="/2020/06/23/SpringBoot%E6%97%A5%E5%BF%97/legacy.png" srcset="/img/loading.gif" alt></p><p><strong>å¦‚ä½•è®©ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ—¥å¿—éƒ½ç»Ÿä¸€åˆ°slf4jï¼›</strong></p><p>==1ã€å°†ç³»ç»Ÿä¸­å…¶ä»–æ—¥å¿—æ¡†æ¶å…ˆæ’é™¤å‡ºå»ï¼›==</p><p>==2ã€ç”¨ä¸­é—´åŒ…æ¥æ›¿æ¢åŸæœ‰çš„æ—¥å¿—æ¡†æ¶ï¼›==</p><p>==3ã€æˆ‘ä»¬å¯¼å…¥slf4jå…¶ä»–çš„å®ç°==</p><h2 id="3ã€SpringBootæ—¥å¿—å…³ç³»"><a href="#3ã€SpringBootæ—¥å¿—å…³ç³»" class="headerlink" title="3ã€SpringBootæ—¥å¿—å…³ç³»"></a>3ã€SpringBootæ—¥å¿—å…³ç³»</h2><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre></div><p>SpringBootä½¿ç”¨å®ƒæ¥åšæ—¥å¿—åŠŸèƒ½ï¼›</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre></div><p>åº•å±‚ä¾èµ–å…³ç³»</p><p><img src="/2020/06/23/SpringBoot%E6%97%A5%E5%BF%97/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180131220946.png" srcset="/img/loading.gif" alt></p><p>æ€»ç»“ï¼š</p><p>â€‹    1ï¼‰ã€SpringBootåº•å±‚ä¹Ÿæ˜¯ä½¿ç”¨slf4j+logbackçš„æ–¹å¼è¿›è¡Œæ—¥å¿—è®°å½•</p><p>â€‹    2ï¼‰ã€SpringBootä¹ŸæŠŠå…¶ä»–çš„æ—¥å¿—éƒ½æ›¿æ¢æˆäº†slf4jï¼›</p><p>â€‹    3ï¼‰ã€ä¸­é—´æ›¿æ¢åŒ…ï¼Ÿ</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@SuppressWarnings</span>(<span class="hljs-string">"rawtypes"</span>)<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogFactory</span> </span>&#123;    <span class="hljs-keyword">static</span> String UNSUPPORTED_OPERATION_IN_JCL_OVER_SLF4J = <span class="hljs-string">"http://www.slf4j.org/codes.html#unsupported_operation_in_jcl_over_slf4j"</span>;    <span class="hljs-keyword">static</span> LogFactory logFactory = <span class="hljs-keyword">new</span> SLF4JLogFactory();</code></pre></div><p><img src="/2020/06/23/SpringBoot%E6%97%A5%E5%BF%97/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180131221411.png" srcset="/img/loading.gif" alt></p><p>â€‹    4ï¼‰ã€å¦‚æœæˆ‘ä»¬è¦å¼•å…¥å…¶ä»–æ¡†æ¶ï¼Ÿä¸€å®šè¦æŠŠè¿™ä¸ªæ¡†æ¶çš„é»˜è®¤æ—¥å¿—ä¾èµ–ç§»é™¤æ‰ï¼Ÿ</p><p>â€‹            Springæ¡†æ¶ç”¨çš„æ˜¯commons-loggingï¼›</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-logging<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-logging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre></div><p><strong>==SpringBootèƒ½è‡ªåŠ¨é€‚é…æ‰€æœ‰çš„æ—¥å¿—ï¼Œè€Œä¸”åº•å±‚ä½¿ç”¨slf4j+logbackçš„æ–¹å¼è®°å½•æ—¥å¿—ï¼Œå¼•å…¥å…¶ä»–æ¡†æ¶çš„æ—¶å€™ï¼Œåªéœ€è¦æŠŠè¿™ä¸ªæ¡†æ¶ä¾èµ–çš„æ—¥å¿—æ¡†æ¶æ’é™¤æ‰å³å¯ï¼›==</strong></p><h2 id="4ã€æ—¥å¿—ä½¿ç”¨ï¼›"><a href="#4ã€æ—¥å¿—ä½¿ç”¨ï¼›" class="headerlink" title="4ã€æ—¥å¿—ä½¿ç”¨ï¼›"></a>4ã€æ—¥å¿—ä½¿ç”¨ï¼›</h2><h3 id="1ã€é»˜è®¤é…ç½®"><a href="#1ã€é»˜è®¤é…ç½®" class="headerlink" title="1ã€é»˜è®¤é…ç½®"></a>1ã€é»˜è®¤é…ç½®</h3><p>SpringBooté»˜è®¤å¸®æˆ‘ä»¬é…ç½®å¥½äº†æ—¥å¿—ï¼›</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-comment">//è®°å½•å™¨</span>Logger logger = LoggerFactory.getLogger(getClass());<span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> </span>&#123;<span class="hljs-comment">//System.out.println();</span><span class="hljs-comment">//æ—¥å¿—çš„çº§åˆ«ï¼›</span><span class="hljs-comment">//ç”±ä½åˆ°é«˜   trace&lt;debug&lt;info&lt;warn&lt;error</span><span class="hljs-comment">//å¯ä»¥è°ƒæ•´è¾“å‡ºçš„æ—¥å¿—çº§åˆ«ï¼›æ—¥å¿—å°±åªä¼šåœ¨è¿™ä¸ªçº§åˆ«ä»¥ä»¥åçš„é«˜çº§åˆ«ç”Ÿæ•ˆ</span>logger.trace(<span class="hljs-string">"è¿™æ˜¯traceæ—¥å¿—..."</span>);logger.debug(<span class="hljs-string">"è¿™æ˜¯debugæ—¥å¿—..."</span>);<span class="hljs-comment">//SpringBooté»˜è®¤ç»™æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯infoçº§åˆ«çš„ï¼Œæ²¡æœ‰æŒ‡å®šçº§åˆ«çš„å°±ç”¨SpringBooté»˜è®¤è§„å®šçš„çº§åˆ«ï¼›rootçº§åˆ«</span>logger.info(<span class="hljs-string">"è¿™æ˜¯infoæ—¥å¿—..."</span>);logger.warn(<span class="hljs-string">"è¿™æ˜¯warnæ—¥å¿—..."</span>);logger.error(<span class="hljs-string">"è¿™æ˜¯erroræ—¥å¿—..."</span>);&#125;</code></pre></div><div class="hljs"><pre><code class="hljs haml">  æ—¥å¿—è¾“å‡ºæ ¼å¼ï¼š<span class="hljs-tag">%<span class="hljs-selector-tag">d</span></span>è¡¨ç¤ºæ—¥æœŸæ—¶é—´ï¼Œ<span class="hljs-tag">%<span class="hljs-selector-tag">thread</span></span>è¡¨ç¤ºçº¿ç¨‹åï¼Œ<span class="hljs-tag">%</span>-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦<span class="hljs-tag">%<span class="hljs-selector-tag">logger</span>&#123;50&#125;</span> è¡¨ç¤ºloggeråå­—æœ€é•¿50ä¸ªå­—ç¬¦ï¼Œå¦åˆ™æŒ‰ç…§å¥ç‚¹åˆ†å‰²ã€‚ <span class="hljs-tag">%<span class="hljs-selector-tag">msg</span></span>ï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ<span class="hljs-tag">%<span class="hljs-selector-tag">n</span></span>æ˜¯æ¢è¡Œç¬¦  -<span class="ruby">-&gt;</span><span class="ruby">  %d&#123;yyyy-MM-dd <span class="hljs-symbol">HH:</span><span class="hljs-symbol">mm:</span>ss.SSS&#125; [%thread] <span class="hljs-string">%-5level %logger&#123;50&#125; -</span> %msg%n</span></code></pre></div><p>SpringBootä¿®æ”¹æ—¥å¿—çš„é»˜è®¤é…ç½®</p><div class="hljs"><pre><code class="hljs properties"><span class="hljs-meta">logging.level.com.atguigu</span>=<span class="hljs-string">trace</span><span class="hljs-comment">#logging.path=</span><span class="hljs-comment"># ä¸æŒ‡å®šè·¯å¾„åœ¨å½“å‰é¡¹ç›®ä¸‹ç”Ÿæˆspringboot.logæ—¥å¿—</span><span class="hljs-comment"># å¯ä»¥æŒ‡å®šå®Œæ•´çš„è·¯å¾„ï¼›</span><span class="hljs-comment">#logging.file=G:/springboot.log</span><span class="hljs-comment"># åœ¨å½“å‰ç£ç›˜çš„æ ¹è·¯å¾„ä¸‹åˆ›å»ºspringæ–‡ä»¶å¤¹å’Œé‡Œé¢çš„logæ–‡ä»¶å¤¹ï¼›ä½¿ç”¨Â spring.log ä½œä¸ºé»˜è®¤æ–‡ä»¶</span><span class="hljs-meta">logging.path</span>=<span class="hljs-string">/spring/log</span><span class="hljs-comment">#  åœ¨æ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—çš„æ ¼å¼</span><span class="hljs-meta">logging.pattern.console</span>=<span class="hljs-string">%d&#123;yyyy-MM-dd&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n</span><span class="hljs-comment"># æŒ‡å®šæ–‡ä»¶ä¸­æ—¥å¿—è¾“å‡ºçš„æ ¼å¼</span><span class="hljs-meta">logging.pattern.file</span>=<span class="hljs-string">%d&#123;yyyy-MM-dd&#125; === [%thread] === %-5level === %logger&#123;50&#125; ==== %msg%n</span></code></pre></div><table><thead><tr><th>logging.file</th><th>logging.path</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>(none)</td><td>(none)</td><td></td><td>åªåœ¨æ§åˆ¶å°è¾“å‡º</td></tr><tr><td>æŒ‡å®šæ–‡ä»¶å</td><td>(none)</td><td>my.log</td><td>è¾“å‡ºæ—¥å¿—åˆ°my.logæ–‡ä»¶</td></tr><tr><td>(none)</td><td>æŒ‡å®šç›®å½•</td><td>/var/log</td><td>è¾“å‡ºåˆ°æŒ‡å®šç›®å½•çš„ spring.log æ–‡ä»¶ä¸­</td></tr></tbody></table><h3 id="2ã€æŒ‡å®šé…ç½®"><a href="#2ã€æŒ‡å®šé…ç½®" class="headerlink" title="2ã€æŒ‡å®šé…ç½®"></a>2ã€æŒ‡å®šé…ç½®</h3><p>ç»™ç±»è·¯å¾„ä¸‹æ”¾ä¸Šæ¯ä¸ªæ—¥å¿—æ¡†æ¶è‡ªå·±çš„é…ç½®æ–‡ä»¶å³å¯ï¼›SpringBootå°±ä¸ä½¿ç”¨ä»–é»˜è®¤é…ç½®çš„äº†</p><table><thead><tr><th>Logging System</th><th>Customization</th></tr></thead><tbody><tr><td>Logback</td><td><code>logback-spring.xml</code>, <code>logback-spring.groovy</code>, <code>logback.xml</code> or <code>logback.groovy</code></td></tr><tr><td>Log4j2</td><td><code>log4j2-spring.xml</code> or <code>log4j2.xml</code></td></tr><tr><td>JDK (Java Util Logging)</td><td><code>logging.properties</code></td></tr></tbody></table><p>logback.xmlï¼šç›´æ¥å°±è¢«æ—¥å¿—æ¡†æ¶è¯†åˆ«äº†ï¼›</p><p><strong>logback-spring.xml</strong>ï¼šæ—¥å¿—æ¡†æ¶å°±ä¸ç›´æ¥åŠ è½½æ—¥å¿—çš„é…ç½®é¡¹ï¼Œç”±SpringBootè§£ææ—¥å¿—é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨SpringBootçš„é«˜çº§ProfileåŠŸèƒ½</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">springProfile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"staging"</span>&gt;</span>    <span class="hljs-comment">&lt;!-- configuration to be enabled when the "staging" profile is active --&gt;</span>  å¯ä»¥æŒ‡å®šæŸæ®µé…ç½®åªåœ¨æŸä¸ªç¯å¢ƒä¸‹ç”Ÿæ•ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">springProfile</span>&gt;</span></code></pre></div><p>å¦‚ï¼š</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"stdout"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;</span>        <span class="hljs-comment">&lt;!--</span><span class="hljs-comment">        æ—¥å¿—è¾“å‡ºæ ¼å¼ï¼š</span><span class="hljs-comment">%dè¡¨ç¤ºæ—¥æœŸæ—¶é—´ï¼Œ</span><span class="hljs-comment">%threadè¡¨ç¤ºçº¿ç¨‹åï¼Œ</span><span class="hljs-comment">%-5levelï¼šçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦</span><span class="hljs-comment">%logger&#123;50&#125; è¡¨ç¤ºloggeråå­—æœ€é•¿50ä¸ªå­—ç¬¦ï¼Œå¦åˆ™æŒ‰ç…§å¥ç‚¹åˆ†å‰²ã€‚ </span><span class="hljs-comment">%msgï¼šæ—¥å¿—æ¶ˆæ¯ï¼Œ</span><span class="hljs-comment">%næ˜¯æ¢è¡Œç¬¦</span><span class="hljs-comment">        --&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">layout</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.classic.PatternLayout"</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">springProfile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"dev"</span>&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; ----&gt; [%thread] ---&gt; %-5level %logger&#123;50&#125; - %msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">pattern</span>&gt;</span>            <span class="hljs-tag">&lt;/<span class="hljs-name">springProfile</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">springProfile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"!dev"</span>&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; ==== [%thread] ==== %-5level %logger&#123;50&#125; - %msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">pattern</span>&gt;</span>            <span class="hljs-tag">&lt;/<span class="hljs-name">springProfile</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">layout</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span></code></pre></div><p>å¦‚æœä½¿ç”¨logback.xmlä½œä¸ºæ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œè¿˜è¦ä½¿ç”¨profileåŠŸèƒ½ï¼Œä¼šæœ‰ä»¥ä¸‹é”™è¯¯</p><p> <code>no applicable action for [springProfile]</code></p><h2 id="5ã€åˆ‡æ¢æ—¥å¿—æ¡†æ¶"><a href="#5ã€åˆ‡æ¢æ—¥å¿—æ¡†æ¶" class="headerlink" title="5ã€åˆ‡æ¢æ—¥å¿—æ¡†æ¶"></a>5ã€åˆ‡æ¢æ—¥å¿—æ¡†æ¶</h2><p>å¯ä»¥æŒ‰ç…§slf4jçš„æ—¥å¿—é€‚é…å›¾ï¼Œè¿›è¡Œç›¸å…³çš„åˆ‡æ¢ï¼›</p><p>slf4j+log4jçš„æ–¹å¼ï¼›</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>logback-classic<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>ch.qos.logback<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-over-slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-log4j12<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre></div><p>åˆ‡æ¢ä¸ºlog4j2</p><div class="hljs"><pre><code class="hljs xml">   <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span>                    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>                    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>                <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span>            <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre></div><hr><h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
    
    
    <categories>
      
      <category>æ—¥å¿—</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootè‡ªåŠ¨é…ç½®åŸç†</title>
    <link href="/2020/06/23/SpringBoot%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86/"/>
    <url>/2020/06/23/SpringBoot%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h2 id="SpringBootè‡ªåŠ¨é…ç½®åŸç†"><a href="#SpringBootè‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="SpringBootè‡ªåŠ¨é…ç½®åŸç†"></a>SpringBootè‡ªåŠ¨é…ç½®åŸç†</h2><p>é…ç½®æ–‡ä»¶åˆ°åº•èƒ½å†™ä»€ä¹ˆï¼Ÿæ€ä¹ˆå†™ï¼Ÿè‡ªåŠ¨é…ç½®åŸç†ï¼›</p><p><a href="https://docs.spring.io/spring-boot/docs/1.5.9.RELEASE/reference/htmlsingle/#common-application-properties" target="_blank" rel="noopener">é…ç½®æ–‡ä»¶èƒ½é…ç½®çš„å±æ€§å‚ç…§</a></p><h3 id="1ã€è‡ªåŠ¨é…ç½®åŸç†ï¼š"><a href="#1ã€è‡ªåŠ¨é…ç½®åŸç†ï¼š" class="headerlink" title="1ã€è‡ªåŠ¨é…ç½®åŸç†ï¼š"></a>1ã€<strong>è‡ªåŠ¨é…ç½®åŸç†ï¼š</strong></h3><p><strong>1ï¼‰ã€SpringBootå¯åŠ¨çš„æ—¶å€™åŠ è½½ä¸»é…ç½®ç±»ï¼Œå¼€å¯äº†è‡ªåŠ¨é…ç½®åŠŸèƒ½ ==@EnableAutoConfiguration==</strong></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span> é‡Œé¢æœ‰ <span class="hljs-meta">@EnableAutoConfiguration</span></code></pre></div><p><strong>2ï¼‰ã€@EnableAutoConfiguration ä½œç”¨ï¼š</strong></p><ul><li><p>åˆ©ç”¨AutoConfigurationImportSelectorç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€äº›ç»„ä»¶</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@EnableAutoConfiguration</span> é‡Œé¢æœ‰ <span class="hljs-meta">@Import</span>(&#123;AutoConfigurationImportSelector<span class="hljs-class">.<span class="hljs-keyword">class</span>&#125;)</span></code></pre></div><p>â€‹</p></li><li><p>å¯ä»¥æŸ¥çœ‹selectImports()æ–¹æ³•çš„å†…å®¹ï¼›</p><div class="hljs"><pre><code class="hljs java">ç±»ä¸­æœ‰selectImportsæ–¹æ³•å…³é”®ä»£ç ï¼šList&lt;String&gt; configurations = getCandidateConfigurations(annotationMetadata,      attributes);è·å–å€™é€‰çš„é…ç½®</code></pre></div></li><li><p>SpringFactoriesLoader.loadFactoryNames()</p><div class="hljs"><pre><code class="hljs java">è¿›å…¥getCandidateConfigurationsæ–¹æ³•<span class="hljs-function"><span class="hljs-keyword">protected</span> List&lt;String&gt; <span class="hljs-title">getCandidateConfigurations</span><span class="hljs-params">(AnnotationMetadata metadata, AnnotationAttributes attributes)</span> </span>&#123;        List&lt;String&gt; configurations = SpringFactoriesLoader.loadFactoryNames(<span class="hljs-keyword">this</span>.getSpringFactoriesLoaderFactoryClass(), <span class="hljs-keyword">this</span>.getBeanClassLoader());        Assert.notEmpty(configurations, <span class="hljs-string">"No auto configuration classes found in META-INF/spring.factories. If you are using a custom packaging, make sure that file is correct."</span>);        <span class="hljs-keyword">return</span> configurations;    &#125;    å†è¿›å…¥loadFactoryNamesæ–¹æ³•<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;String&gt; <span class="hljs-title">loadFactoryNames</span><span class="hljs-params">(Class&lt;?&gt; factoryClass, @Nullable ClassLoader classLoader)</span> </span>&#123;        String factoryClassName = factoryClass.getName();        <span class="hljs-keyword">return</span> (List)loadSpringFactories(classLoader).getOrDefault(factoryClassName, Collections.emptyList());    &#125;   å†è¿›å…¥loadSpringFactoriesæ–¹æ³•å¯ä»¥çœ‹åˆ°æœ‰å…³é”®æ€§ä»£ç Enumeration&lt;URL&gt; urls = classLoader != <span class="hljs-keyword">null</span> ? classLoader.getResources(<span class="hljs-string">"META-INF/spring.factories"</span>) : ClassLoader.getSystemResources(<span class="hljs-string">"META-INF/spring.factories"</span>);<span class="hljs-keyword">while</span>(urls.hasMoreElements()) &#123;        URL url = (URL)urls.nextElement();        UrlResource resource = <span class="hljs-keyword">new</span> UrlResource(url);        Properties properties = PropertiesLoaderUtils.loadProperties(resource);       ï¼ˆè¿™å¤„ä»£ç æœ‰åˆ å‡ï¼Œæºç ç¯‡å¹…è¿‡é•¿ï¼‰    &#125;</code></pre></div><p>æ‰«ææ‰€æœ‰jaråŒ…ç±»è·¯å¾„ä¸‹  META-INF/spring.factories<br>æŠŠæ‰«æåˆ°çš„è¿™äº›æ–‡ä»¶çš„å†…å®¹åŒ…è£…æˆpropertieså¯¹è±¡</p><p>ä»propertiesä¸­è·å–åˆ°EnableAutoConfiguration.classç±»ï¼ˆç±»åï¼‰å¯¹åº”çš„å€¼ï¼Œç„¶åæŠŠä»–ä»¬æ·»åŠ åœ¨å®¹å™¨ä¸­</p><p>â€‹</p></li></ul><p><strong>==å°† ç±»è·¯å¾„ä¸‹  META-INF/spring.factories é‡Œé¢é…ç½®çš„æ‰€æœ‰EnableAutoConfigurationçš„å€¼åŠ å…¥åˆ°äº†å®¹å™¨ä¸­ï¼›==</strong></p><div class="hljs"><pre><code class="hljs properties"><span class="hljs-comment"># Auto Configure</span><span class="hljs-meta">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class="hljs-string">\</span>org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration,\org.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration,\org.springframework.boot.autoconfigure.cloud.CloudAutoConfiguration,\org.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration,\org.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration,\org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration,\org.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration,\org.springframework.boot.autoconfigure.dao.PersistenceExceptionTranslationAutoConfiguration,\org.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration,\org.springframework.boot.autoconfigure.data.cassandra.CassandraRepositoriesAutoConfiguration,\org.springframework.boot.autoconfigure.data.couchbase.CouchbaseDataAutoConfiguration,\org.springframework.boot.autoconfigure.data.couchbase.CouchbaseRepositoriesAutoConfiguration,\org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchAutoConfiguration,\org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchDataAutoConfiguration,\org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchRepositoriesAutoConfiguration,\org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration,\org.springframework.boot.autoconfigure.data.ldap.LdapDataAutoConfiguration,\org.springframework.boot.autoconfigure.data.ldap.LdapRepositoriesAutoConfiguration,\org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,\org.springframework.boot.autoconfigure.data.mongo.MongoRepositoriesAutoConfiguration,\org.springframework.boot.autoconfigure.data.neo4j.Neo4jDataAutoConfiguration,\org.springframework.boot.autoconfigure.data.neo4j.Neo4jRepositoriesAutoConfiguration,\org.springframework.boot.autoconfigure.data.solr.SolrRepositoriesAutoConfiguration,\org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration,\org.springframework.boot.autoconfigure.data.rest.RepositoryRestMvcAutoConfiguration,\org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration,\org.springframework.boot.autoconfigure.elasticsearch.jest.JestAutoConfiguration,\org.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration,\org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration,\org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration,\org.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration,\org.springframework.boot.autoconfigure.hazelcast.HazelcastAutoConfiguration,\org.springframework.boot.autoconfigure.hazelcast.HazelcastJpaDependencyAutoConfiguration,\org.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration,\org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration,\org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration,\org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration,\org.springframework.boot.autoconfigure.jdbc.JndiDataSourceAutoConfiguration,\org.springframework.boot.autoconfigure.jdbc.XADataSourceAutoConfiguration,\org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration,\org.springframework.boot.autoconfigure.jms.JmsAutoConfiguration,\org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration,\org.springframework.boot.autoconfigure.jms.JndiConnectionFactoryAutoConfiguration,\org.springframework.boot.autoconfigure.jms.activemq.ActiveMQAutoConfiguration,\org.springframework.boot.autoconfigure.jms.artemis.ArtemisAutoConfiguration,\org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration,\org.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration,\org.springframework.boot.autoconfigure.jersey.JerseyAutoConfiguration,\org.springframework.boot.autoconfigure.jooq.JooqAutoConfiguration,\org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration,\org.springframework.boot.autoconfigure.ldap.embedded.EmbeddedLdapAutoConfiguration,\org.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration,\org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration,\org.springframework.boot.autoconfigure.mail.MailSenderAutoConfiguration,\org.springframework.boot.autoconfigure.mail.MailSenderValidatorAutoConfiguration,\org.springframework.boot.autoconfigure.mobile.DeviceResolverAutoConfiguration,\org.springframework.boot.autoconfigure.mobile.DeviceDelegatingViewResolverAutoConfiguration,\org.springframework.boot.autoconfigure.mobile.SitePreferenceAutoConfiguration,\org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration,\org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,\org.springframework.boot.autoconfigure.mustache.MustacheAutoConfiguration,\org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\org.springframework.boot.autoconfigure.reactor.ReactorAutoConfiguration,\org.springframework.boot.autoconfigure.security.SecurityAutoConfiguration,\org.springframework.boot.autoconfigure.security.SecurityFilterAutoConfiguration,\org.springframework.boot.autoconfigure.security.FallbackWebSecurityAutoConfiguration,\org.springframework.boot.autoconfigure.security.oauth2.OAuth2AutoConfiguration,\org.springframework.boot.autoconfigure.sendgrid.SendGridAutoConfiguration,\org.springframework.boot.autoconfigure.session.SessionAutoConfiguration,\org.springframework.boot.autoconfigure.social.SocialWebAutoConfiguration,\org.springframework.boot.autoconfigure.social.FacebookAutoConfiguration,\org.springframework.boot.autoconfigure.social.LinkedInAutoConfiguration,\org.springframework.boot.autoconfigure.social.TwitterAutoConfiguration,\org.springframework.boot.autoconfigure.solr.SolrAutoConfiguration,\org.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration,\org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration,\org.springframework.boot.autoconfigure.transaction.jta.JtaAutoConfiguration,\org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration,\org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration,\org.springframework.boot.autoconfigure.web.EmbeddedServletContainerAutoConfiguration,\org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration,\org.springframework.boot.autoconfigure.web.HttpEncodingAutoConfiguration,\org.springframework.boot.autoconfigure.web.HttpMessageConvertersAutoConfiguration,\org.springframework.boot.autoconfigure.web.MultipartAutoConfiguration,\org.springframework.boot.autoconfigure.web.ServerPropertiesAutoConfiguration,\org.springframework.boot.autoconfigure.web.WebClientAutoConfiguration,\org.springframework.boot.autoconfigure.web.WebMvcAutoConfiguration,\org.springframework.boot.autoconfigure.websocket.WebSocketAutoConfiguration,\org.springframework.boot.autoconfigure.websocket.WebSocketMessagingAutoConfiguration,\<span class="hljs-attr">org.springframework.boot.autoconfigure.webservices.WebServicesAutoConfiguration</span></code></pre></div><p>æ¯ä¸€ä¸ªè¿™æ ·çš„  xxxAutoConfigurationç±»éƒ½æ˜¯å®¹å™¨ä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œéƒ½åŠ å…¥åˆ°å®¹å™¨ä¸­ï¼›ç”¨ä»–ä»¬æ¥åšè‡ªåŠ¨é…ç½®ï¼›</p><p><strong>3ï¼‰ã€æ¯ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»è¿›è¡Œè‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼›</strong></p><p><strong>4ï¼‰ã€ä»¥</strong>HttpEncodingAutoConfigurationï¼ˆHttpç¼–ç è‡ªåŠ¨é…ç½®ï¼‰<strong>ä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†ï¼›</strong></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span>   <span class="hljs-comment">//è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œä»¥å‰ç¼–å†™çš„é…ç½®æ–‡ä»¶ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶</span><span class="hljs-meta">@EnableConfigurationProperties</span>(HttpEncodingProperties<span class="hljs-class">.<span class="hljs-keyword">class</span>)  //å¯åŠ¨æŒ‡å®šç±»çš„<span class="hljs-title">ConfigurationProperties</span>åŠŸèƒ½ï¼›å°†é…ç½®æ–‡ä»¶ä¸­å¯¹åº”çš„å€¼å’Œ<span class="hljs-title">HttpEncodingProperties</span>ç»‘å®šèµ·æ¥ï¼›å¹¶æŠŠ<span class="hljs-title">HttpEncodingProperties</span>åŠ å…¥åˆ°<span class="hljs-title">ioc</span>å®¹å™¨ä¸­</span><span class="hljs-class"></span><span class="hljs-class">@<span class="hljs-title">ConditionalOnWebApplication</span> //<span class="hljs-title">Spring</span>åº•å±‚@<span class="hljs-title">Conditional</span>æ³¨è§£ï¼ˆ<span class="hljs-title">Spring</span>æ³¨è§£ç‰ˆï¼‰ï¼Œæ ¹æ®ä¸åŒçš„æ¡ä»¶ï¼Œå¦‚æœæ»¡è¶³æŒ‡å®šçš„æ¡ä»¶ï¼Œæ•´ä¸ªé…ç½®ç±»é‡Œé¢çš„é…ç½®å°±ä¼šç”Ÿæ•ˆï¼›    åˆ¤æ–­å½“å‰åº”ç”¨æ˜¯å¦æ˜¯<span class="hljs-title">web</span>åº”ç”¨ï¼Œå¦‚æœæ˜¯ï¼Œå½“å‰é…ç½®ç±»ç”Ÿæ•ˆ</span><span class="hljs-class"></span><span class="hljs-class">@<span class="hljs-title">ConditionalOnClass</span>(<span class="hljs-title">CharacterEncodingFilter</span>.<span class="hljs-title">class</span>)  //åˆ¤æ–­å½“å‰é¡¹ç›®æœ‰æ²¡æœ‰è¿™ä¸ªç±»<span class="hljs-title">CharacterEncodingFilter</span>ï¼›<span class="hljs-title">SpringMVC</span>ä¸­è¿›è¡Œä¹±ç è§£å†³çš„è¿‡æ»¤å™¨ï¼›</span><span class="hljs-class"></span><span class="hljs-class">@<span class="hljs-title">ConditionalOnProperty</span>(<span class="hljs-title">prefix</span> </span>= <span class="hljs-string">"spring.http.encoding"</span>, value = <span class="hljs-string">"enabled"</span>, matchIfMissing = <span class="hljs-keyword">true</span>)  <span class="hljs-comment">//åˆ¤æ–­é…ç½®æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªé…ç½®  spring.http.encoding.enabledï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ¤æ–­ä¹Ÿæ˜¯æˆç«‹çš„</span><span class="hljs-comment">//å³ä½¿æˆ‘ä»¬é…ç½®æ–‡ä»¶ä¸­ä¸é…ç½®pring.http.encoding.enabled=trueï¼Œä¹Ÿæ˜¯é»˜è®¤ç”Ÿæ•ˆçš„ï¼›</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpEncodingAutoConfiguration</span> </span>&#123;    <span class="hljs-comment">//ä»–å·²ç»å’ŒSpringBootçš„é…ç½®æ–‡ä»¶æ˜ å°„äº†</span>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> HttpEncodingProperties properties;     <span class="hljs-comment">//åªæœ‰ä¸€ä¸ªæœ‰å‚æ„é€ å™¨çš„æƒ…å†µä¸‹ï¼Œå‚æ•°çš„å€¼å°±ä¼šä»å®¹å™¨ä¸­æ‹¿</span>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HttpEncodingAutoConfiguration</span><span class="hljs-params">(HttpEncodingProperties properties)</span> </span>&#123;<span class="hljs-keyword">this</span>.properties = properties;&#125;      <span class="hljs-meta">@Bean</span>   <span class="hljs-comment">//ç»™å®¹å™¨ä¸­æ·»åŠ ä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶çš„æŸäº›å€¼éœ€è¦ä»propertiesä¸­è·å–</span><span class="hljs-meta">@ConditionalOnMissingBean</span>(CharacterEncodingFilter<span class="hljs-class">.<span class="hljs-keyword">class</span>) //åˆ¤æ–­å®¹å™¨æ²¡æœ‰è¿™ä¸ªç»„ä»¶ï¼Ÿ</span><span class="hljs-class"><span class="hljs-title">public</span> <span class="hljs-title">CharacterEncodingFilter</span> <span class="hljs-title">characterEncodingFilter</span>() </span>&#123;CharacterEncodingFilter filter = <span class="hljs-keyword">new</span> OrderedCharacterEncodingFilter();filter.setEncoding(<span class="hljs-keyword">this</span>.properties.getCharset().name());filter.setForceRequestEncoding(<span class="hljs-keyword">this</span>.properties.shouldForce(Type.REQUEST));filter.setForceResponseEncoding(<span class="hljs-keyword">this</span>.properties.shouldForce(Type.RESPONSE));<span class="hljs-keyword">return</span> filter;&#125;</code></pre></div><p>æ ¹æ®å½“å‰ä¸åŒçš„æ¡ä»¶åˆ¤æ–­ï¼Œå†³å®šè¿™ä¸ªé…ç½®ç±»æ˜¯å¦ç”Ÿæ•ˆï¼Ÿ</p><p>ä¸€ä½†è¿™ä¸ªé…ç½®ç±»ç”Ÿæ•ˆï¼›è¿™ä¸ªé…ç½®ç±»å°±ä¼šç»™å®¹å™¨ä¸­æ·»åŠ å„ç§ç»„ä»¶ï¼›è¿™äº›ç»„ä»¶çš„å±æ€§æ˜¯ä»å¯¹åº”çš„propertiesç±»ä¸­è·å–çš„ï¼Œè¿™äº›ç±»é‡Œé¢çš„æ¯ä¸€ä¸ªå±æ€§åˆæ˜¯å’Œé…ç½®æ–‡ä»¶ç»‘å®šçš„ï¼›</p><p><strong>5ï¼‰ã€æ‰€æœ‰åœ¨é…ç½®æ–‡ä»¶ä¸­èƒ½é…ç½®çš„å±æ€§éƒ½æ˜¯åœ¨xxxxPropertiesç±»ä¸­å°è£…ç€ï¼›é…ç½®æ–‡ä»¶èƒ½é…ç½®ä»€ä¹ˆå°±å¯ä»¥å‚ç…§æŸä¸ªåŠŸèƒ½å¯¹åº”çš„è¿™ä¸ªå±æ€§ç±»</strong></p><div class="hljs"><pre><code class="hljs java"><span class="hljs-meta">@ConfigurationProperties</span>(prefix = <span class="hljs-string">"spring.http.encoding"</span>)  <span class="hljs-comment">//ä»é…ç½®æ–‡ä»¶ä¸­è·å–æŒ‡å®šçš„å€¼å’Œbeançš„å±æ€§è¿›è¡Œç»‘å®š</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpEncodingProperties</span> </span>&#123;   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Charset DEFAULT_CHARSET = Charset.forName(<span class="hljs-string">"UTF-8"</span>);</code></pre></div><p><strong>ç²¾é«“ï¼š</strong></p><p>â€‹    <strong>1ï¼‰ã€SpringBootå¯åŠ¨ä¼šåŠ è½½å¤§é‡çš„è‡ªåŠ¨é…ç½®ç±»</strong></p><p>â€‹    <strong>2ï¼‰ã€æˆ‘ä»¬çœ‹æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½æœ‰æ²¡æœ‰SpringBooté»˜è®¤å†™å¥½çš„è‡ªåŠ¨é…ç½®ç±»ï¼›</strong></p><p>â€‹    <strong>3ï¼‰ã€æˆ‘ä»¬å†æ¥çœ‹è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»ä¸­åˆ°åº•é…ç½®äº†å“ªäº›ç»„ä»¶ï¼›ï¼ˆåªè¦æˆ‘ä»¬è¦ç”¨çš„ç»„ä»¶æœ‰ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦å†æ¥é…ç½®äº†ï¼‰</strong></p><p>â€‹    <strong>4ï¼‰ã€ç»™å®¹å™¨ä¸­è‡ªåŠ¨é…ç½®ç±»æ·»åŠ ç»„ä»¶çš„æ—¶å€™ï¼Œä¼šä»propertiesç±»ä¸­è·å–æŸäº›å±æ€§ã€‚æˆ‘ä»¬å°±å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šè¿™äº›å±æ€§çš„å€¼ï¼›</strong></p><p>xxxxAutoConfigurartionï¼šè‡ªåŠ¨é…ç½®ç±»ï¼›</p><p>ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶</p><p>xxxxProperties:å°è£…é…ç½®æ–‡ä»¶ä¸­ç›¸å…³å±æ€§ï¼›</p><h3 id="2ã€ç»†èŠ‚"><a href="#2ã€ç»†èŠ‚" class="headerlink" title="2ã€ç»†èŠ‚"></a>2ã€ç»†èŠ‚</h3><p><strong>1ã€@Conditionalæ´¾ç”Ÿæ³¨è§£ï¼ˆSpringæ³¨è§£ç‰ˆåŸç”Ÿçš„@Conditionalä½œç”¨ï¼‰</strong></p><p>ä½œç”¨ï¼šå¿…é¡»æ˜¯@ConditionalæŒ‡å®šçš„æ¡ä»¶æˆç«‹ï¼Œæ‰ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ï¼Œé…ç½®é…é‡Œé¢çš„æ‰€æœ‰å†…å®¹æ‰ç”Ÿæ•ˆï¼›</p><table><thead><tr><th>@Conditionalæ‰©å±•æ³¨è§£</th><th>ä½œç”¨ï¼ˆåˆ¤æ–­æ˜¯å¦æ»¡è¶³å½“å‰æŒ‡å®šæ¡ä»¶ï¼‰</th></tr></thead><tbody><tr><td>@ConditionalOnJava</td><td>ç³»ç»Ÿçš„javaç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚</td></tr><tr><td>@ConditionalOnBean</td><td>å®¹å™¨ä¸­å­˜åœ¨æŒ‡å®šBeanï¼›</td></tr><tr><td>@ConditionalOnMissingBean</td><td>å®¹å™¨ä¸­ä¸å­˜åœ¨æŒ‡å®šBeanï¼›</td></tr><tr><td>@ConditionalOnExpression</td><td>æ»¡è¶³SpELè¡¨è¾¾å¼æŒ‡å®š</td></tr><tr><td>@ConditionalOnClass</td><td>ç³»ç»Ÿä¸­æœ‰æŒ‡å®šçš„ç±»</td></tr><tr><td>@ConditionalOnMissingClass</td><td>ç³»ç»Ÿä¸­æ²¡æœ‰æŒ‡å®šçš„ç±»</td></tr><tr><td>@ConditionalOnSingleCandidate</td><td>å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªæŒ‡å®šçš„Beanï¼Œæˆ–è€…è¿™ä¸ªBeanæ˜¯é¦–é€‰Bean</td></tr><tr><td>@ConditionalOnProperty</td><td>ç³»ç»Ÿä¸­æŒ‡å®šçš„å±æ€§æ˜¯å¦æœ‰æŒ‡å®šçš„å€¼</td></tr><tr><td>@ConditionalOnResource</td><td>ç±»è·¯å¾„ä¸‹æ˜¯å¦å­˜åœ¨æŒ‡å®šèµ„æºæ–‡ä»¶</td></tr><tr><td>@ConditionalOnWebApplication</td><td>å½“å‰æ˜¯webç¯å¢ƒ</td></tr><tr><td>@ConditionalOnNotWebApplication</td><td>å½“å‰ä¸æ˜¯webç¯å¢ƒ</td></tr><tr><td>@ConditionalOnJndi</td><td>JNDIå­˜åœ¨æŒ‡å®šé¡¹</td></tr></tbody></table><p><strong>è‡ªåŠ¨é…ç½®ç±»å¿…é¡»åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹æ‰èƒ½ç”Ÿæ•ˆï¼›</strong></p><p>æˆ‘ä»¬æ€ä¹ˆçŸ¥é“å“ªäº›è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆï¼›</p><p><strong>==æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯ç”¨  debug=trueå±æ€§ï¼›æ¥è®©æ§åˆ¶å°æ‰“å°è‡ªåŠ¨é…ç½®æŠ¥å‘Š==</strong>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„çŸ¥é“å“ªäº›è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆï¼›</p><div class="hljs"><pre><code class="hljs java">=========================AUTO-CONFIGURATION REPORT=========================Positive matches:ï¼ˆè‡ªåŠ¨é…ç½®ç±»å¯ç”¨çš„ï¼‰-----------------   DispatcherServletAutoConfiguration matched:      - <span class="hljs-meta">@ConditionalOnClass</span> found required <span class="hljs-class"><span class="hljs-keyword">class</span> '<span class="hljs-title">org</span>.<span class="hljs-title">springframework</span>.<span class="hljs-title">web</span>.<span class="hljs-title">servlet</span>.<span class="hljs-title">DispatcherServlet</span>'</span>; <span class="hljs-meta">@ConditionalOnMissingClass</span> <span class="hljs-function">did not find unwanted <span class="hljs-title">class</span> <span class="hljs-params">(OnClassCondition)</span></span><span class="hljs-function">      - @<span class="hljs-title">ConditionalOnWebApplication</span> <span class="hljs-params">(required)</span> found <span class="hljs-title">StandardServletEnvironment</span> <span class="hljs-params">(OnWebApplicationCondition)</span></span><span class="hljs-function">        </span><span class="hljs-function">    </span><span class="hljs-function">Negative matches:ï¼ˆæ²¡æœ‰å¯åŠ¨ï¼Œæ²¡æœ‰åŒ¹é…æˆåŠŸçš„è‡ªåŠ¨é…ç½®ç±»ï¼‰</span><span class="hljs-function">-----------------</span><span class="hljs-function"></span><span class="hljs-function">   ActiveMQAutoConfiguration:</span><span class="hljs-function">      Did not match:</span><span class="hljs-function">         - @ConditionalOnClass did not find required classes 'javax.jms.ConnectionFactory', 'org.apache.activemq.ActiveMQConnectionFactory' <span class="hljs-params">(OnClassCondition)</span></span><span class="hljs-function"></span><span class="hljs-function">   AopAutoConfiguration:</span><span class="hljs-function">      Did not match:</span><span class="hljs-function">         - @ConditionalOnClass did not find required classes 'org.aspectj.lang.annotation.Aspect', 'org.aspectj.lang.reflect.Advice' <span class="hljs-params">(OnClassCondition)</span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>æºç åˆ†æ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç±»ä¸å®ä¾‹åˆå§‹åŒ–é¢è¯•é¢˜</title>
    <link href="/2020/06/22/%E7%B1%BB%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%88%9D%E5%A7%8B%E5%8C%96%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/2020/06/22/%E7%B1%BB%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%88%9D%E5%A7%8B%E5%8C%96%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="é¢è¯•é¢˜"><a href="#é¢è¯•é¢˜" class="headerlink" title="é¢è¯•é¢˜"></a>é¢è¯•é¢˜</h1><h2 id="ä»£ç å¦‚ä¸‹ï¼š"><a href="#ä»£ç å¦‚ä¸‹ï¼š" class="headerlink" title="ä»£ç å¦‚ä¸‹ï¼š"></a>ä»£ç å¦‚ä¸‹ï¼š</h2><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jk.test;<span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.JK</span><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-06-15  21:41</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Father</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> i = test();    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> j = method();    <span class="hljs-keyword">static</span> &#123;        System.out.print(<span class="hljs-string">"(1)"</span>);    &#125;    Father()&#123;        System.out.print(<span class="hljs-string">"(2)"</span>);    &#125;    &#123;        System.out.print(<span class="hljs-string">"(3)"</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;        System.out.print(<span class="hljs-string">"(4)"</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">method</span><span class="hljs-params">()</span> </span>&#123;        System.out.print(<span class="hljs-string">"(5)"</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    &#125;&#125;<span class="hljs-keyword">package</span> com.jk.test;<span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Mr.JK</span><span class="hljs-comment"> * <span class="hljs-doctag">@create</span> 2020-06-15  21:41</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Son</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Father</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> i = test();    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> j = method();    <span class="hljs-keyword">static</span> &#123;        System.out.print(<span class="hljs-string">"(6)"</span>);    &#125;    Son()&#123;        System.out.print(<span class="hljs-string">"(7)"</span>);    &#125;    &#123;        System.out.print(<span class="hljs-string">"(8)"</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;        System.out.print(<span class="hljs-string">"(9)"</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">method</span><span class="hljs-params">()</span></span>&#123;        System.out.print(<span class="hljs-string">"(10)"</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        Son son1 = <span class="hljs-keyword">new</span> Son();        System.out.println();        Son son2 = <span class="hljs-keyword">new</span> Son();    &#125;&#125;</code></pre></div><p>mainå‡½æ•°æ‰§è¡Œåï¼Œå¤§å®¶å¯ä»¥è¯•è¯•çœ‹è¾“å‡ºçš„é¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿ</p><h2 id="ç±»åˆå§‹åŒ–è¿‡ç¨‹"><a href="#ç±»åˆå§‹åŒ–è¿‡ç¨‹" class="headerlink" title="ç±»åˆå§‹åŒ–è¿‡ç¨‹"></a>ç±»åˆå§‹åŒ–è¿‡ç¨‹</h2><p>1ã€ä¸€ä¸ªç±»çš„åˆ›å»ºå®ä¾‹éœ€è¦å…ˆåŠ è½½å¹¶åˆå§‹åŒ–è¯¥ç±»<br>    - mainæ–¹æ³•æ‰€åœ¨çš„ç±»éœ€è¦å…ˆåŠ è½½å’Œåˆå§‹åŒ–<br>2ã€ä¸€ä¸ªå­ç±»è¦åˆå§‹åŒ–éœ€è¦å…ˆåˆå§‹åŒ–çˆ¶ç±»<br>3ã€ä¸€ä¸ªç±»åˆå§‹åŒ–å°±æ˜¯æ‰§è¡Œ&lt;clinit&gt;()æ–¹æ³•<br>    - &lt;clinit&gt;()æ–¹æ³•ç”±é™æ€ç±»å˜é‡æ˜¾ç¤ºèµ‹å€¼ä»£ç å’Œé™æ€ä»£ç å—ç»„æˆ</p><hr><p>å°±æ˜¯è¯´åœ¨mainæ–¹æ³•å¯åŠ¨çš„æ—¶å€™ï¼Œå°±ä¼šå»åˆå§‹åŒ–ç±»<br>å› ä¸ºåœ¨çˆ¶ç±»å’Œå­ç±»ä¸­éƒ½æœ‰é™æ€å˜é‡å’Œé™æ€ä»£ç å—ï¼Œé™æ€å˜é‡å’Œé™æ€ä»£ç å—é¡ºåºæ˜¯æ ¹æ®ä»£ç ä¹¦å†™çš„é¡ºåºæ‰§è¡Œçš„æ‰€ä»¥ï¼š<br>æ‰§è¡Œé¡ºåºä¸º ï¼ˆ5ï¼‰ï¼ˆ1ï¼‰ï¼ˆ10ï¼‰ï¼ˆ6ï¼‰</p><h2 id="å®ä¾‹çš„åˆå§‹åŒ–è¿‡ç¨‹"><a href="#å®ä¾‹çš„åˆå§‹åŒ–è¿‡ç¨‹" class="headerlink" title="å®ä¾‹çš„åˆå§‹åŒ–è¿‡ç¨‹"></a>å®ä¾‹çš„åˆå§‹åŒ–è¿‡ç¨‹</h2><p>å®ä¾‹åˆå§‹åŒ–å°±æ˜¯æ‰§è¡Œ&lt;init&gt;()æ–¹æ³•<br>    - &lt;init&gt;()æ–¹æ³•å¯èƒ½é‡è½½æœ‰å¤šä¸ªï¼Œæœ‰å‡ ä¸ªæ„é€ å™¨å°±æœ‰å‡ ä¸ª&lt;init&gt;()æ–¹æ³•<br>    - &lt;init&gt;()æ–¹æ³•ç”±éé™æ€å®ä¾‹å˜é‡æ˜¾ç¤ºèµ‹å€¼ä»£ç å’Œéé™æ€ä»£ç å—ã€å¯¹åº”æ„é€ å™¨ä»£ç ç»„æˆ<br>    - éé™æ€å®ä¾‹å˜é‡æ˜¾ç¤ºå¤åˆ¶ä»£ç å’Œéé™æ€ä»£ç å—ä»£ç ä»ä¸Šåˆ°ä¸‹é¡ºåºæ‰§è¡Œï¼Œè€Œå¯¹åº”æ„é€ å™¨çš„ä»£ç æœ€åæ‰§è¡Œ<br>    - æ¯æ¬¡åˆ›å»ºå®ä¾‹å¯¹è±¡ï¼Œè°ƒç”¨å¯¹åº”æ„é€ å™¨ï¼Œæ‰§è¡Œçš„å°±æ˜¯å¯¹åº”çš„&lt;init&gt;()æ–¹æ³•<br>    - &lt;init&gt;()æ–¹æ³•çš„é¦–è¡Œæ˜¯super()æˆ–super(å®å‚åˆ—è¡¨)ï¼Œå³å¯¹åº”çˆ¶ç±»çš„&lt;init&gt;()æ–¹æ³•</p><hr><p>å°±æ˜¯è¯´åœ¨è°ƒç”¨æ„é€ å‡½æ•°è¿›è¡Œå®ä¾‹çš„åˆå§‹åŒ–æ—¶ï¼Œä¸ç®¡æœ‰æ²¡æœ‰superå…³é”®å­—ï¼Œéƒ½ä¼šè°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨å…ˆè¿›è¡Œåˆå§‹åŒ–ï¼Œç„¶ååœ¨åˆå§‹åŒ–çˆ¶ç±»æ„é€ å™¨åï¼Œå†æ‰§è¡Œç±»ä¸­æ˜¾ç¤ºèµ‹å€¼ä»£ç å’Œéé™æ€ä»£ç å— æ¯”å¦‚Sonå­ç±»çš„ï¼š</p><div class="hljs"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> i = test();&#123;        System.out.print(<span class="hljs-string">"(8)"</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">method</span><span class="hljs-params">()</span></span>&#123;        System.out.print(<span class="hljs-string">"(10)"</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;&#125;</code></pre></div><p>æœ€åæ‰æ˜¯Sonå­ç±»çš„æ„é€ å™¨</p><div class="hljs"><pre><code class="hljs java">Son()&#123;        System.out.print(<span class="hljs-string">"(7)"</span>);&#125;</code></pre></div><p>æ‰€æœ‰æ ¹æ®ä»¥ä¸Šçš„é¡ºåºå¾—å‡ºçš„å…¨éƒ¨é¡ºåºä¸º<br>ï¼ˆ5ï¼‰ï¼ˆ1ï¼‰ï¼ˆ10ï¼‰ï¼ˆ6ï¼‰ï¼ˆ4ï¼‰ï¼ˆ3ï¼‰ï¼ˆ2ï¼‰ï¼ˆ9ï¼‰ï¼ˆ8ï¼‰ï¼ˆ7ï¼‰<br>ï¼ˆ4ï¼‰ï¼ˆ3ï¼‰ï¼ˆ2ï¼‰ï¼ˆ9ï¼‰ï¼ˆ8ï¼‰ï¼ˆ7ï¼‰</p><p>ä»¥ä¸ºåˆ°è¿™é‡Œç»“æŸäº†å˜›ï¼Œå…¶å®è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå‘ï¼Œå°±æ˜¯å¤šæ€æ€§ï¼Œæ–¹æ³•çš„é‡å†™ï¼</p><h2 id="æ–¹æ³•çš„é‡å†™Override"><a href="#æ–¹æ³•çš„é‡å†™Override" class="headerlink" title="æ–¹æ³•çš„é‡å†™Override"></a>æ–¹æ³•çš„é‡å†™Override</h2><p>1ã€å“ªäº›æ–¹æ³•ä¸å¯ä»¥è¢«é‡å†™<br>    - finalæ–¹æ³•<br>    - é™æ€æ–¹æ³•<br>    - privateç­‰å­ç±»ä¸­ä¸å¯è§æ–¹æ³•<br>2ã€å¯¹è±¡çš„å¤šæ€æ€§<br>    - å­ç±»å¦‚æœé‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œé€šè¿‡å­ç±»å¯¹è±¡è°ƒç”¨çš„ä¸€å®šæ˜¯å­ç±»é‡å†™è¿‡çš„ä»£ç <br>    - éé™æ€æ–¹æ³•é»˜è®¤çš„è°ƒç”¨å¯¹è±¡æ˜¯this<br>    - thiså¯¹è±¡åœ¨æ„é€ å™¨æˆ–è€…è¯´<init>æ–¹æ³•ä¸­å°±æ˜¯æ­£åœ¨åˆ›å»ºçš„å¯¹è±¡</init></p><hr><p>ä¹Ÿå°±æ˜¯è¯´åœ¨åˆå§‹åŒ–çˆ¶ç±»å®ä¾‹æ—¶ï¼Œåˆå§‹åŒ–å˜é‡æ—¶å€™è°ƒç”¨testï¼ˆï¼‰æ–¹æ³•ï¼Œå› ä¸ºæ˜¯éé™æ€æ–¹æ³•ï¼Œæ‰€æœ‰é»˜è®¤è°ƒç”¨å¯¹è±¡thisï¼Œæ˜¯å½“å‰å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯Sonå¯¹è±¡ æ‰€ä»¥å®é™…æ‰§è¡Œçš„æ˜¯å­ç±»é‡å†™çš„æ–¹æ³•</p><p>æœ€ç»ˆçš„ç»“æœé¡ºåºä¸º<br><img src="https://img-blog.csdnimg.cn/2020061522493926.png" srcset="/img/loading.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸€å¶çŸ¥ç§‹ï¼Œç©¿æ’äº†ç±»ä¸å®ä¾‹çš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚<br>æ­¤æ–‡ç« æ ¹æ®å°šç¡…è°·è§†é¢‘åŠ ä¸Šä¸ªäººç†è§£ä¸å®è·µã€‚</p>]]></content>
    
    
    <categories>
      
      <category>é¢è¯•é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç±»ä¸å®ä¾‹åˆå§‹åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
